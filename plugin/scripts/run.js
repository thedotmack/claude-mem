#!/usr/bin/env node
import{execSync as c,spawn as u}from"child_process";import{existsSync as a,readFileSync as f}from"fs";import{join as m}from"path";import{homedir as l}from"os";function s(){try{return c("bun --version",{stdio:"ignore"}),!0}catch{return!1}}function p(){let e=process.env.CLAUDE_MEM_RUNTIME;if(e==="bun"||e==="node")return e;let r=m(l(),".claude-mem","settings.json");if(a(r))try{let n=JSON.parse(f(r,"utf-8")).env?.CLAUDE_MEM_RUNTIME;if(n==="bun"||n==="node")return n}catch{}return null}function d(){let e=p();return e==="bun"&&s()?"bun":e==="node"?"node":s()?"bun":"node"}var t=process.argv.slice(2);t.length===0&&(console.error("Usage: node run.js <script-path> [args...]"),process.exit(1));var o=d(),g=t[0],h=t.slice(1),i=u(o,[g,...h],{stdio:"inherit",env:process.env});i.on("error",e=>{console.error(`Failed to start ${o}: ${e.message}`),process.exit(1)});i.on("close",e=>{process.exit(e??0)});
