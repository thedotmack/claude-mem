#!/usr/bin/env node
import{spawn as g}from"child_process";import{existsSync as u,readFileSync as c}from"fs";import{join as m}from"path";import{homedir as p}from"os";import{execSync as a}from"child_process";function f(){try{return a("bun --version",{stdio:"ignore",windowsHide:!0}),!0}catch{return!1}}function d(){let e=process.env.CLAUDE_MEM_RUNTIME;if(e==="bun"||e==="node")return e;let t=m(p(),".claude-mem","settings.json");if(u(t))try{let n=JSON.parse(c(t,"utf-8")).env?.CLAUDE_MEM_RUNTIME;if(n==="bun"||n==="node")return n}catch{}}function r(){return d()==="bun"&&f()?"bun":"node"}var o=process.argv.slice(2);o.length===0&&(console.error("Usage: node run.js <script-path> [args...]"),process.exit(1));var i=r(),[l,...b]=o,s=g(i,[l,...b],{stdio:"inherit",env:process.env});s.on("error",e=>{console.error(`Failed to start ${i}: ${e.message}`),process.exit(1)});s.on("close",e=>{process.exit(e??0)});
