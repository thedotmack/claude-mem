#!/usr/bin/env node
var Ul=Object.create;var Hs=Object.defineProperty;var Vl=Object.getOwnPropertyDescriptor;var Hl=Object.getOwnPropertyNames;var zl=Object.getPrototypeOf,Bl=Object.prototype.hasOwnProperty;var St=(s=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(s,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):s)(function(s){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+s+'" is not supported')});var H=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),Zl=(s,e)=>{for(var r in e)Hs(s,r,{get:e[r],enumerable:!0})},Gl=(s,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of Hl(e))!Bl.call(s,t)&&t!==r&&Hs(s,t,{get:()=>e[t],enumerable:!(a=Vl(e,t))||a.enumerable});return s};var zs=(s,e,r)=>(r=s!=null?Ul(zl(s)):{},Gl(e||!s||!s.__esModule?Hs(r,"default",{value:s,enumerable:!0}):r,s));var Zn=H((rs,Bn)=>{(function(s,e){typeof rs=="object"&&typeof Bn<"u"?e(rs):typeof define=="function"&&define.amd?define(["exports"],e):e(s.URI=s.URI||{})})(rs,function(s){"use strict";function e(){for(var y=arguments.length,p=Array(y),E=0;E<y;E++)p[E]=arguments[E];if(p.length>1){p[0]=p[0].slice(0,-1);for(var S=p.length-1,x=1;x<S;++x)p[x]=p[x].slice(1,-1);return p[S]=p[S].slice(1),p.join("")}else return p[0]}function r(y){return"(?:"+y+")"}function a(y){return y===void 0?"undefined":y===null?"null":Object.prototype.toString.call(y).split(" ").pop().split("]").shift().toLowerCase()}function t(y){return y.toUpperCase()}function n(y){return y!=null?y instanceof Array?y:typeof y.length!="number"||y.split||y.setInterval||y.call?[y]:Array.prototype.slice.call(y):[]}function i(y,p){var E=y;if(p)for(var S in p)E[S]=p[S];return E}function o(y){var p="[A-Za-z]",E="[\\x0D]",S="[0-9]",x="[\\x22]",L=e(S,"[A-Fa-f]"),W="[\\x0A]",se="[\\x20]",oe=r(r("%[EFef]"+L+"%"+L+L+"%"+L+L)+"|"+r("%[89A-Fa-f]"+L+"%"+L+L)+"|"+r("%"+L+L)),Ee="[\\:\\/\\?\\#\\[\\]\\@]",re="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",pe=e(Ee,re),be=y?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",de=y?"[\\uE000-\\uF8FF]":"[]",ne=e(p,S,"[\\-\\.\\_\\~]",be),he=r(p+e(p,S,"[\\+\\-\\.]")+"*"),le=r(r(oe+"|"+e(ne,re,"[\\:]"))+"*"),Dt=r(r("25[0-5]")+"|"+r("2[0-4]"+S)+"|"+r("1"+S+S)+"|"+r("[1-9]"+S)+"|"+S),Me=r(r("25[0-5]")+"|"+r("2[0-4]"+S)+"|"+r("1"+S+S)+"|"+r("0?[1-9]"+S)+"|0?0?"+S),Ve=r(Me+"\\."+Me+"\\."+Me+"\\."+Me),ue=r(L+"{1,4}"),qe=r(r(ue+"\\:"+ue)+"|"+Ve),He=r(r(ue+"\\:")+"{6}"+qe),at=r("\\:\\:"+r(ue+"\\:")+"{5}"+qe),$t=r(r(ue)+"?\\:\\:"+r(ue+"\\:")+"{4}"+qe),ft=r(r(r(ue+"\\:")+"{0,1}"+ue)+"?\\:\\:"+r(ue+"\\:")+"{3}"+qe),Sr=r(r(r(ue+"\\:")+"{0,2}"+ue)+"?\\:\\:"+r(ue+"\\:")+"{2}"+qe),Fr=r(r(r(ue+"\\:")+"{0,3}"+ue)+"?\\:\\:"+ue+"\\:"+qe),Mr=r(r(r(ue+"\\:")+"{0,4}"+ue)+"?\\:\\:"+qe),tr=r(r(r(ue+"\\:")+"{0,5}"+ue)+"?\\:\\:"+ue),rr=r(r(r(ue+"\\:")+"{0,6}"+ue)+"?\\:\\:"),pt=r([He,at,$t,ft,Sr,Fr,Mr,tr,rr].join("|")),sr=r(r(ne+"|"+oe)+"+"),Us=r(pt+"\\%25"+sr),kt=r(pt+r("\\%25|\\%(?!"+L+"{2})")+sr),$l=r("[vV]"+L+"+\\."+e(ne,re,"[\\:]")+"+"),kl=r("\\["+r(kt+"|"+pt+"|"+$l)+"\\]"),hn=r(r(oe+"|"+e(ne,re))+"*"),xr=r(kl+"|"+Ve+"(?!"+hn+")|"+hn),Rr=r(S+"*"),mn=r(r(le+"@")+"?"+xr+r("\\:"+Rr)+"?"),Tr=r(oe+"|"+e(ne,re,"[\\:\\@]")),Ll=r(Tr+"*"),vn=r(Tr+"+"),jl=r(r(oe+"|"+e(ne,re,"[\\@]"))+"+"),ht=r(r("\\/"+Ll)+"*"),ar=r("\\/"+r(vn+ht)+"?"),Vs=r(jl+ht),qr=r(vn+ht),nr="(?!"+Tr+")",Eh=r(ht+"|"+ar+"|"+Vs+"|"+qr+"|"+nr),ir=r(r(Tr+"|"+e("[\\/\\?]",de))+"*"),Pr=r(r(Tr+"|[\\/\\?]")+"*"),gn=r(r("\\/\\/"+mn+ht)+"|"+ar+"|"+qr+"|"+nr),Fl=r(he+"\\:"+gn+r("\\?"+ir)+"?"+r("\\#"+Pr)+"?"),Ml=r(r("\\/\\/"+mn+ht)+"|"+ar+"|"+Vs+"|"+nr),ql=r(Ml+r("\\?"+ir)+"?"+r("\\#"+Pr)+"?"),bh=r(Fl+"|"+ql),Sh=r(he+"\\:"+gn+r("\\?"+ir)+"?"),xh="^("+he+")\\:"+r(r("\\/\\/("+r("("+le+")@")+"?("+xr+")"+r("\\:("+Rr+")")+"?)")+"?("+ht+"|"+ar+"|"+qr+"|"+nr+")")+r("\\?("+ir+")")+"?"+r("\\#("+Pr+")")+"?$",Rh="^(){0}"+r(r("\\/\\/("+r("("+le+")@")+"?("+xr+")"+r("\\:("+Rr+")")+"?)")+"?("+ht+"|"+ar+"|"+Vs+"|"+nr+")")+r("\\?("+ir+")")+"?"+r("\\#("+Pr+")")+"?$",Th="^("+he+")\\:"+r(r("\\/\\/("+r("("+le+")@")+"?("+xr+")"+r("\\:("+Rr+")")+"?)")+"?("+ht+"|"+ar+"|"+qr+"|"+nr+")")+r("\\?("+ir+")")+"?$",Ph="^"+r("\\#("+Pr+")")+"?$",wh="^"+r("("+le+")@")+"?("+xr+")"+r("\\:("+Rr+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",p,S,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",ne,re),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",ne,re),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",ne,re),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",ne,re),"g"),NOT_QUERY:new RegExp(e("[^\\%]",ne,re,"[\\:\\@\\/\\?]",de),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",ne,re,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",ne,re),"g"),UNRESERVED:new RegExp(ne,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",ne,pe),"g"),PCT_ENCODED:new RegExp(oe,"g"),IPV4ADDRESS:new RegExp("^("+Ve+")$"),IPV6ADDRESS:new RegExp("^\\[?("+pt+")"+r(r("\\%25|\\%(?!"+L+"{2})")+"("+sr+")")+"?\\]?$")}}var l=o(!1),u=o(!0),f=function(){function y(p,E){var S=[],x=!0,L=!1,W=void 0;try{for(var se=p[Symbol.iterator](),oe;!(x=(oe=se.next()).done)&&(S.push(oe.value),!(E&&S.length===E));x=!0);}catch(Ee){L=!0,W=Ee}finally{try{!x&&se.return&&se.return()}finally{if(L)throw W}}return S}return function(p,E){if(Array.isArray(p))return p;if(Symbol.iterator in Object(p))return y(p,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(y){if(Array.isArray(y)){for(var p=0,E=Array(y.length);p<y.length;p++)E[p]=y[p];return E}else return Array.from(y)},g=2147483647,d=36,m=1,_=26,v=38,b=700,T=72,R=128,P="-",N=/^xn--/,A=/[^\0-\x7E]/,z=/[\x2E\u3002\uFF0E\uFF61]/g,q={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=d-m,U=Math.floor,M=String.fromCharCode;function j(y){throw new RangeError(q[y])}function I(y,p){for(var E=[],S=y.length;S--;)E[S]=p(y[S]);return E}function D(y,p){var E=y.split("@"),S="";E.length>1&&(S=E[0]+"@",y=E[1]),y=y.replace(z,".");var x=y.split("."),L=I(x,p).join(".");return S+L}function F(y){for(var p=[],E=0,S=y.length;E<S;){var x=y.charCodeAt(E++);if(x>=55296&&x<=56319&&E<S){var L=y.charCodeAt(E++);(L&64512)==56320?p.push(((x&1023)<<10)+(L&1023)+65536):(p.push(x),E--)}else p.push(x)}return p}var ce=function(p){return String.fromCodePoint.apply(String,h(p))},J=function(p){return p-48<10?p-22:p-65<26?p-65:p-97<26?p-97:d},te=function(p,E){return p+22+75*(p<26)-((E!=0)<<5)},K=function(p,E,S){var x=0;for(p=S?U(p/b):p>>1,p+=U(p/E);p>C*_>>1;x+=d)p=U(p/C);return U(x+(C+1)*p/(p+v))},B=function(p){var E=[],S=p.length,x=0,L=R,W=T,se=p.lastIndexOf(P);se<0&&(se=0);for(var oe=0;oe<se;++oe)p.charCodeAt(oe)>=128&&j("not-basic"),E.push(p.charCodeAt(oe));for(var Ee=se>0?se+1:0;Ee<S;){for(var re=x,pe=1,be=d;;be+=d){Ee>=S&&j("invalid-input");var de=J(p.charCodeAt(Ee++));(de>=d||de>U((g-x)/pe))&&j("overflow"),x+=de*pe;var ne=be<=W?m:be>=W+_?_:be-W;if(de<ne)break;var he=d-ne;pe>U(g/he)&&j("overflow"),pe*=he}var le=E.length+1;W=K(x-re,le,re==0),U(x/le)>g-L&&j("overflow"),L+=U(x/le),x%=le,E.splice(x++,0,L)}return String.fromCodePoint.apply(String,E)},me=function(p){var E=[];p=F(p);var S=p.length,x=R,L=0,W=T,se=!0,oe=!1,Ee=void 0;try{for(var re=p[Symbol.iterator](),pe;!(se=(pe=re.next()).done);se=!0){var be=pe.value;be<128&&E.push(M(be))}}catch(kt){oe=!0,Ee=kt}finally{try{!se&&re.return&&re.return()}finally{if(oe)throw Ee}}var de=E.length,ne=de;for(de&&E.push(P);ne<S;){var he=g,le=!0,Dt=!1,Me=void 0;try{for(var Ve=p[Symbol.iterator](),ue;!(le=(ue=Ve.next()).done);le=!0){var qe=ue.value;qe>=x&&qe<he&&(he=qe)}}catch(kt){Dt=!0,Me=kt}finally{try{!le&&Ve.return&&Ve.return()}finally{if(Dt)throw Me}}var He=ne+1;he-x>U((g-L)/He)&&j("overflow"),L+=(he-x)*He,x=he;var at=!0,$t=!1,ft=void 0;try{for(var Sr=p[Symbol.iterator](),Fr;!(at=(Fr=Sr.next()).done);at=!0){var Mr=Fr.value;if(Mr<x&&++L>g&&j("overflow"),Mr==x){for(var tr=L,rr=d;;rr+=d){var pt=rr<=W?m:rr>=W+_?_:rr-W;if(tr<pt)break;var sr=tr-pt,Us=d-pt;E.push(M(te(pt+sr%Us,0))),tr=U(sr/Us)}E.push(M(te(tr,0))),W=K(L,He,ne==de),L=0,++ne}}}catch(kt){$t=!0,ft=kt}finally{try{!at&&Sr.return&&Sr.return()}finally{if($t)throw ft}}++L,++x}return E.join("")},Te=function(p){return D(p,function(E){return N.test(E)?B(E.slice(4).toLowerCase()):E})},Ie=function(p){return D(p,function(E){return A.test(E)?"xn--"+me(E):E})},ae={version:"2.1.0",ucs2:{decode:F,encode:ce},decode:B,encode:me,toASCII:Ie,toUnicode:Te},_e={};function Se(y){var p=y.charCodeAt(0),E=void 0;return p<16?E="%0"+p.toString(16).toUpperCase():p<128?E="%"+p.toString(16).toUpperCase():p<2048?E="%"+(p>>6|192).toString(16).toUpperCase()+"%"+(p&63|128).toString(16).toUpperCase():E="%"+(p>>12|224).toString(16).toUpperCase()+"%"+(p>>6&63|128).toString(16).toUpperCase()+"%"+(p&63|128).toString(16).toUpperCase(),E}function Ne(y){for(var p="",E=0,S=y.length;E<S;){var x=parseInt(y.substr(E+1,2),16);if(x<128)p+=String.fromCharCode(x),E+=3;else if(x>=194&&x<224){if(S-E>=6){var L=parseInt(y.substr(E+4,2),16);p+=String.fromCharCode((x&31)<<6|L&63)}else p+=y.substr(E,6);E+=6}else if(x>=224){if(S-E>=9){var W=parseInt(y.substr(E+4,2),16),se=parseInt(y.substr(E+7,2),16);p+=String.fromCharCode((x&15)<<12|(W&63)<<6|se&63)}else p+=y.substr(E,9);E+=9}else p+=y.substr(E,3),E+=3}return p}function Et(y,p){function E(S){var x=Ne(S);return x.match(p.UNRESERVED)?x:S}return y.scheme&&(y.scheme=String(y.scheme).replace(p.PCT_ENCODED,E).toLowerCase().replace(p.NOT_SCHEME,"")),y.userinfo!==void 0&&(y.userinfo=String(y.userinfo).replace(p.PCT_ENCODED,E).replace(p.NOT_USERINFO,Se).replace(p.PCT_ENCODED,t)),y.host!==void 0&&(y.host=String(y.host).replace(p.PCT_ENCODED,E).toLowerCase().replace(p.NOT_HOST,Se).replace(p.PCT_ENCODED,t)),y.path!==void 0&&(y.path=String(y.path).replace(p.PCT_ENCODED,E).replace(y.scheme?p.NOT_PATH:p.NOT_PATH_NOSCHEME,Se).replace(p.PCT_ENCODED,t)),y.query!==void 0&&(y.query=String(y.query).replace(p.PCT_ENCODED,E).replace(p.NOT_QUERY,Se).replace(p.PCT_ENCODED,t)),y.fragment!==void 0&&(y.fragment=String(y.fragment).replace(p.PCT_ENCODED,E).replace(p.NOT_FRAGMENT,Se).replace(p.PCT_ENCODED,t)),y}function ut(y){return y.replace(/^0*(.*)/,"$1")||"0"}function ye(y,p){var E=y.match(p.IPV4ADDRESS)||[],S=f(E,2),x=S[1];return x?x.split(".").map(ut).join("."):y}function ve(y,p){var E=y.match(p.IPV6ADDRESS)||[],S=f(E,3),x=S[1],L=S[2];if(x){for(var W=x.toLowerCase().split("::").reverse(),se=f(W,2),oe=se[0],Ee=se[1],re=Ee?Ee.split(":").map(ut):[],pe=oe.split(":").map(ut),be=p.IPV4ADDRESS.test(pe[pe.length-1]),de=be?7:8,ne=pe.length-de,he=Array(de),le=0;le<de;++le)he[le]=re[le]||pe[ne+le]||"";be&&(he[de-1]=ye(he[de-1],p));var Dt=he.reduce(function(He,at,$t){if(!at||at==="0"){var ft=He[He.length-1];ft&&ft.index+ft.length===$t?ft.length++:He.push({index:$t,length:1})}return He},[]),Me=Dt.sort(function(He,at){return at.length-He.length})[0],Ve=void 0;if(Me&&Me.length>1){var ue=he.slice(0,Me.index),qe=he.slice(Me.index+Me.length);Ve=ue.join(":")+"::"+qe.join(":")}else Ve=he.join(":");return L&&(Ve+="%"+L),Ve}else return y}var Nt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Pe="".match(/(){0}/)[1]===void 0;function ie(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={},S=p.iri!==!1?u:l;p.reference==="suffix"&&(y=(p.scheme?p.scheme+":":"")+"//"+y);var x=y.match(Nt);if(x){Pe?(E.scheme=x[1],E.userinfo=x[3],E.host=x[4],E.port=parseInt(x[5],10),E.path=x[6]||"",E.query=x[7],E.fragment=x[8],isNaN(E.port)&&(E.port=x[5])):(E.scheme=x[1]||void 0,E.userinfo=y.indexOf("@")!==-1?x[3]:void 0,E.host=y.indexOf("//")!==-1?x[4]:void 0,E.port=parseInt(x[5],10),E.path=x[6]||"",E.query=y.indexOf("?")!==-1?x[7]:void 0,E.fragment=y.indexOf("#")!==-1?x[8]:void 0,isNaN(E.port)&&(E.port=y.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?x[4]:void 0)),E.host&&(E.host=ve(ye(E.host,S),S)),E.scheme===void 0&&E.userinfo===void 0&&E.host===void 0&&E.port===void 0&&!E.path&&E.query===void 0?E.reference="same-document":E.scheme===void 0?E.reference="relative":E.fragment===void 0?E.reference="absolute":E.reference="uri",p.reference&&p.reference!=="suffix"&&p.reference!==E.reference&&(E.error=E.error||"URI is not a "+p.reference+" reference.");var L=_e[(p.scheme||E.scheme||"").toLowerCase()];if(!p.unicodeSupport&&(!L||!L.unicodeSupport)){if(E.host&&(p.domainHost||L&&L.domainHost))try{E.host=ae.toASCII(E.host.replace(S.PCT_ENCODED,Ne).toLowerCase())}catch(W){E.error=E.error||"Host's domain name can not be converted to ASCII via punycode: "+W}Et(E,l)}else Et(E,S);L&&L.parse&&L.parse(E,p)}else E.error=E.error||"URI can not be parsed.";return E}function bt(y,p){var E=p.iri!==!1?u:l,S=[];return y.userinfo!==void 0&&(S.push(y.userinfo),S.push("@")),y.host!==void 0&&S.push(ve(ye(String(y.host),E),E).replace(E.IPV6ADDRESS,function(x,L,W){return"["+L+(W?"%25"+W:"")+"]"})),(typeof y.port=="number"||typeof y.port=="string")&&(S.push(":"),S.push(String(y.port))),S.length?S.join(""):void 0}var dt=/^\.\.?\//,At=/^\/\.(\/|$)/,Ct=/^\/\.\.(\/|$)/,xe=/^\/?(?:.|\n)*?(?=\/|$)/;function Ue(y){for(var p=[];y.length;)if(y.match(dt))y=y.replace(dt,"");else if(y.match(At))y=y.replace(At,"/");else if(y.match(Ct))y=y.replace(Ct,"/"),p.pop();else if(y==="."||y==="..")y="";else{var E=y.match(xe);if(E){var S=E[0];y=y.slice(S.length),p.push(S)}else throw new Error("Unexpected dot segment condition")}return p.join("")}function $e(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=p.iri?u:l,S=[],x=_e[(p.scheme||y.scheme||"").toLowerCase()];if(x&&x.serialize&&x.serialize(y,p),y.host&&!E.IPV6ADDRESS.test(y.host)){if(p.domainHost||x&&x.domainHost)try{y.host=p.iri?ae.toUnicode(y.host):ae.toASCII(y.host.replace(E.PCT_ENCODED,Ne).toLowerCase())}catch(se){y.error=y.error||"Host's domain name can not be converted to "+(p.iri?"Unicode":"ASCII")+" via punycode: "+se}}Et(y,E),p.reference!=="suffix"&&y.scheme&&(S.push(y.scheme),S.push(":"));var L=bt(y,p);if(L!==void 0&&(p.reference!=="suffix"&&S.push("//"),S.push(L),y.path&&y.path.charAt(0)!=="/"&&S.push("/")),y.path!==void 0){var W=y.path;!p.absolutePath&&(!x||!x.absolutePath)&&(W=Ue(W)),L===void 0&&(W=W.replace(/^\/\//,"/%2F")),S.push(W)}return y.query!==void 0&&(S.push("?"),S.push(y.query)),y.fragment!==void 0&&(S.push("#"),S.push(y.fragment)),S.join("")}function Ae(y,p){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},S=arguments[3],x={};return S||(y=ie($e(y,E),E),p=ie($e(p,E),E)),E=E||{},!E.tolerant&&p.scheme?(x.scheme=p.scheme,x.userinfo=p.userinfo,x.host=p.host,x.port=p.port,x.path=Ue(p.path||""),x.query=p.query):(p.userinfo!==void 0||p.host!==void 0||p.port!==void 0?(x.userinfo=p.userinfo,x.host=p.host,x.port=p.port,x.path=Ue(p.path||""),x.query=p.query):(p.path?(p.path.charAt(0)==="/"?x.path=Ue(p.path):((y.userinfo!==void 0||y.host!==void 0||y.port!==void 0)&&!y.path?x.path="/"+p.path:y.path?x.path=y.path.slice(0,y.path.lastIndexOf("/")+1)+p.path:x.path=p.path,x.path=Ue(x.path)),x.query=p.query):(x.path=y.path,p.query!==void 0?x.query=p.query:x.query=y.query),x.userinfo=y.userinfo,x.host=y.host,x.port=y.port),x.scheme=y.scheme),x.fragment=p.fragment,x}function rt(y,p,E){var S=i({scheme:"null"},E);return $e(Ae(ie(y,S),ie(p,S),S,!0),S)}function Fe(y,p){return typeof y=="string"?y=$e(ie(y,p),p):a(y)==="object"&&(y=ie($e(y,p),p)),y}function jr(y,p,E){return typeof y=="string"?y=$e(ie(y,E),E):a(y)==="object"&&(y=$e(y,E)),typeof p=="string"?p=$e(ie(p,E),E):a(p)==="object"&&(p=$e(p,E)),y===p}function Ms(y,p){return y&&y.toString().replace(!p||!p.iri?l.ESCAPE:u.ESCAPE,Se)}function Ke(y,p){return y&&y.toString().replace(!p||!p.iri?l.PCT_ENCODED:u.PCT_ENCODED,Ne)}var Er={scheme:"http",domainHost:!0,parse:function(p,E){return p.host||(p.error=p.error||"HTTP URIs must have a host."),p},serialize:function(p,E){var S=String(p.scheme).toLowerCase()==="https";return(p.port===(S?443:80)||p.port==="")&&(p.port=void 0),p.path||(p.path="/"),p}},nn={scheme:"https",domainHost:Er.domainHost,parse:Er.parse,serialize:Er.serialize};function on(y){return typeof y.secure=="boolean"?y.secure:String(y.scheme).toLowerCase()==="wss"}var br={scheme:"ws",domainHost:!0,parse:function(p,E){var S=p;return S.secure=on(S),S.resourceName=(S.path||"/")+(S.query?"?"+S.query:""),S.path=void 0,S.query=void 0,S},serialize:function(p,E){if((p.port===(on(p)?443:80)||p.port==="")&&(p.port=void 0),typeof p.secure=="boolean"&&(p.scheme=p.secure?"wss":"ws",p.secure=void 0),p.resourceName){var S=p.resourceName.split("?"),x=f(S,2),L=x[0],W=x[1];p.path=L&&L!=="/"?L:void 0,p.query=W,p.resourceName=void 0}return p.fragment=void 0,p}},cn={scheme:"wss",domainHost:br.domainHost,parse:br.parse,serialize:br.serialize},Sl={},xl=!0,ln="[A-Za-z0-9\\-\\.\\_\\~"+(xl?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",st="[0-9A-Fa-f]",Rl=r(r("%[EFef]"+st+"%"+st+st+"%"+st+st)+"|"+r("%[89A-Fa-f]"+st+"%"+st+st)+"|"+r("%"+st+st)),Tl="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Pl="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",wl=e(Pl,'[\\"\\\\]'),Ol="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Il=new RegExp(ln,"g"),er=new RegExp(Rl,"g"),Nl=new RegExp(e("[^]",Tl,"[\\.]",'[\\"]',wl),"g"),un=new RegExp(e("[^]",ln,Ol),"g"),Al=un;function qs(y){var p=Ne(y);return p.match(Il)?p:y}var dn={scheme:"mailto",parse:function(p,E){var S=p,x=S.to=S.path?S.path.split(","):[];if(S.path=void 0,S.query){for(var L=!1,W={},se=S.query.split("&"),oe=0,Ee=se.length;oe<Ee;++oe){var re=se[oe].split("=");switch(re[0]){case"to":for(var pe=re[1].split(","),be=0,de=pe.length;be<de;++be)x.push(pe[be]);break;case"subject":S.subject=Ke(re[1],E);break;case"body":S.body=Ke(re[1],E);break;default:L=!0,W[Ke(re[0],E)]=Ke(re[1],E);break}}L&&(S.headers=W)}S.query=void 0;for(var ne=0,he=x.length;ne<he;++ne){var le=x[ne].split("@");if(le[0]=Ke(le[0]),E.unicodeSupport)le[1]=Ke(le[1],E).toLowerCase();else try{le[1]=ae.toASCII(Ke(le[1],E).toLowerCase())}catch(Dt){S.error=S.error||"Email address's domain name can not be converted to ASCII via punycode: "+Dt}x[ne]=le.join("@")}return S},serialize:function(p,E){var S=p,x=n(p.to);if(x){for(var L=0,W=x.length;L<W;++L){var se=String(x[L]),oe=se.lastIndexOf("@"),Ee=se.slice(0,oe).replace(er,qs).replace(er,t).replace(Nl,Se),re=se.slice(oe+1);try{re=E.iri?ae.toUnicode(re):ae.toASCII(Ke(re,E).toLowerCase())}catch(ne){S.error=S.error||"Email address's domain name can not be converted to "+(E.iri?"Unicode":"ASCII")+" via punycode: "+ne}x[L]=Ee+"@"+re}S.path=x.join(",")}var pe=p.headers=p.headers||{};p.subject&&(pe.subject=p.subject),p.body&&(pe.body=p.body);var be=[];for(var de in pe)pe[de]!==Sl[de]&&be.push(de.replace(er,qs).replace(er,t).replace(un,Se)+"="+pe[de].replace(er,qs).replace(er,t).replace(Al,Se));return be.length&&(S.query=be.join("&")),S}},Cl=/^([^\:]+)\:(.*)/,fn={scheme:"urn",parse:function(p,E){var S=p.path&&p.path.match(Cl),x=p;if(S){var L=E.scheme||x.scheme||"urn",W=S[1].toLowerCase(),se=S[2],oe=L+":"+(E.nid||W),Ee=_e[oe];x.nid=W,x.nss=se,x.path=void 0,Ee&&(x=Ee.parse(x,E))}else x.error=x.error||"URN can not be parsed.";return x},serialize:function(p,E){var S=E.scheme||p.scheme||"urn",x=p.nid,L=S+":"+(E.nid||x),W=_e[L];W&&(p=W.serialize(p,E));var se=p,oe=p.nss;return se.path=(x||E.nid)+":"+oe,se}},Dl=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,pn={scheme:"urn:uuid",parse:function(p,E){var S=p;return S.uuid=S.nss,S.nss=void 0,!E.tolerant&&(!S.uuid||!S.uuid.match(Dl))&&(S.error=S.error||"UUID is not valid."),S},serialize:function(p,E){var S=p;return S.nss=(p.uuid||"").toLowerCase(),S}};_e[Er.scheme]=Er,_e[nn.scheme]=nn,_e[br.scheme]=br,_e[cn.scheme]=cn,_e[dn.scheme]=dn,_e[fn.scheme]=fn,_e[pn.scheme]=pn,s.SCHEMES=_e,s.pctEncChar=Se,s.pctDecChars=Ne,s.parse=ie,s.removeDotSegments=Ue,s.serialize=$e,s.resolveComponents=Ae,s.resolve=rt,s.normalize=Fe,s.equal=jr,s.escapeComponent=Ms,s.unescapeComponent=Ke,Object.defineProperty(s,"__esModule",{value:!0})})});var ss=H((fm,Gn)=>{"use strict";Gn.exports=function s(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var a,t,n;if(Array.isArray(e)){if(a=e.length,a!=r.length)return!1;for(t=a;t--!==0;)if(!s(e[t],r[t]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(n=Object.keys(e),a=n.length,a!==Object.keys(r).length)return!1;for(t=a;t--!==0;)if(!Object.prototype.hasOwnProperty.call(r,n[t]))return!1;for(t=a;t--!==0;){var i=n[t];if(!s(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var Wn=H((pm,Xn)=>{"use strict";Xn.exports=function(e){for(var r=0,a=e.length,t=0,n;t<a;)r++,n=e.charCodeAt(t++),n>=55296&&n<=56319&&t<a&&(n=e.charCodeAt(t),(n&64512)==56320&&t++);return r}});var Jt=H((hm,Jn)=>{"use strict";Jn.exports={copy:Zd,checkDataType:ma,checkDataTypes:Gd,coerceToTypes:Xd,toHash:ga,getProperty:_a,escapeQuotes:ya,equal:ss(),ucs2length:Wn(),varOccurences:Kd,varReplace:Jd,schemaHasRules:Yd,schemaHasRulesExcept:ef,schemaUnknownRules:tf,toQuotedString:va,getPathExpr:rf,getPath:sf,getData:of,unescapeFragment:cf,unescapeJsonPointer:ba,escapeFragment:lf,escapeJsonPointer:Ea};function Zd(s,e){e=e||{};for(var r in s)e[r]=s[r];return e}function ma(s,e,r,a){var t=a?" !== ":" === ",n=a?" || ":" && ",i=a?"!":"",o=a?"":"!";switch(s){case"null":return e+t+"null";case"array":return i+"Array.isArray("+e+")";case"object":return"("+i+e+n+"typeof "+e+t+'"object"'+n+o+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+t+'"number"'+n+o+"("+e+" % 1)"+n+e+t+e+(r?n+i+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+t+'"'+s+'"'+(r?n+i+"isFinite("+e+")":"")+")";default:return"typeof "+e+t+'"'+s+'"'}}function Gd(s,e,r){switch(s.length){case 1:return ma(s[0],e,r,!0);default:var a="",t=ga(s);t.array&&t.object&&(a=t.null?"(":"(!"+e+" || ",a+="typeof "+e+' !== "object")',delete t.null,delete t.array,delete t.object),t.number&&delete t.integer;for(var n in t)a+=(a?" && ":"")+ma(n,e,r,!0);return a}}var Qn=ga(["string","number","integer","boolean","null"]);function Xd(s,e){if(Array.isArray(e)){for(var r=[],a=0;a<e.length;a++){var t=e[a];(Qn[t]||s==="array"&&t==="array")&&(r[r.length]=t)}if(r.length)return r}else{if(Qn[e])return[e];if(s==="array"&&e==="array")return["array"]}}function ga(s){for(var e={},r=0;r<s.length;r++)e[s[r]]=!0;return e}var Wd=/^[a-z$_][a-z$_0-9]*$/i,Qd=/'|\\/g;function _a(s){return typeof s=="number"?"["+s+"]":Wd.test(s)?"."+s:"['"+ya(s)+"']"}function ya(s){return s.replace(Qd,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function Kd(s,e){e+="[^0-9]";var r=s.match(new RegExp(e,"g"));return r?r.length:0}function Jd(s,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),s.replace(new RegExp(e,"g"),r+"$1")}function Yd(s,e){if(typeof s=="boolean")return!s;for(var r in s)if(e[r])return!0}function ef(s,e,r){if(typeof s=="boolean")return!s&&r!="not";for(var a in s)if(a!=r&&e[a])return!0}function tf(s,e){if(typeof s!="boolean"){for(var r in s)if(!e[r])return r}}function va(s){return"'"+ya(s)+"'"}function rf(s,e,r,a){var t=r?"'/' + "+e+(a?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):a?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return Kn(s,t)}function sf(s,e,r){var a=va(r?"/"+Ea(e):_a(e));return Kn(s,a)}var af=/^\/(?:[^~]|~0|~1)*$/,nf=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function of(s,e,r){var a,t,n,i;if(s==="")return"rootData";if(s[0]=="/"){if(!af.test(s))throw new Error("Invalid JSON-pointer: "+s);t=s,n="rootData"}else{if(i=s.match(nf),!i)throw new Error("Invalid JSON-pointer: "+s);if(a=+i[1],t=i[2],t=="#"){if(a>=e)throw new Error("Cannot access property/index "+a+" levels up, current level is "+e);return r[e-a]}if(a>e)throw new Error("Cannot access data "+a+" levels up, current level is "+e);if(n="data"+(e-a||""),!t)return n}for(var o=n,l=t.split("/"),u=0;u<l.length;u++){var f=l[u];f&&(n+=_a(ba(f)),o+=" && "+n)}return o}function Kn(s,e){return s=='""'?e:(s+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function cf(s){return ba(decodeURIComponent(s))}function lf(s){return encodeURIComponent(Ea(s))}function Ea(s){return s.replace(/~/g,"~0").replace(/\//g,"~1")}function ba(s){return s.replace(/~1/g,"/").replace(/~0/g,"~")}});var Sa=H((mm,Yn)=>{"use strict";var uf=Jt();Yn.exports=df;function df(s){uf.copy(s,this)}});var ti=H((vm,ei)=>{"use strict";var wt=ei.exports=function(s,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var a=typeof r=="function"?r:r.pre||function(){},t=r.post||function(){};as(e,a,t,s,"",s)};wt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};wt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};wt.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};wt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function as(s,e,r,a,t,n,i,o,l,u){if(a&&typeof a=="object"&&!Array.isArray(a)){e(a,t,n,i,o,l,u);for(var f in a){var h=a[f];if(Array.isArray(h)){if(f in wt.arrayKeywords)for(var g=0;g<h.length;g++)as(s,e,r,h[g],t+"/"+f+"/"+g,n,t,f,a,g)}else if(f in wt.propsKeywords){if(h&&typeof h=="object")for(var d in h)as(s,e,r,h[d],t+"/"+f+"/"+ff(d),n,t,f,a,d)}else(f in wt.keywords||s.allKeys&&!(f in wt.skipKeywords))&&as(s,e,r,h,t+"/"+f,n,t,f,a)}r(a,t,n,i,o,l,u)}}function ff(s){return s.replace(/~/g,"~0").replace(/\//g,"~1")}});var us=H((gm,ni)=>{"use strict";var kr=Zn(),ri=ss(),cs=Jt(),ns=Sa(),pf=ti();ni.exports=It;It.normalizeId=Ot;It.fullPath=is;It.url=os;It.ids=_f;It.inlineRef=xa;It.schema=ls;function It(s,e,r){var a=this._refs[r];if(typeof a=="string")if(this._refs[a])a=this._refs[a];else return It.call(this,s,e,a);if(a=a||this._schemas[r],a instanceof ns)return xa(a.schema,this._opts.inlineRefs)?a.schema:a.validate||this._compile(a);var t=ls.call(this,e,r),n,i,o;return t&&(n=t.schema,e=t.root,o=t.baseId),n instanceof ns?i=n.validate||s.call(this,n.schema,e,void 0,o):n!==void 0&&(i=xa(n,this._opts.inlineRefs)?n:s.call(this,n,e,void 0,o)),i}function ls(s,e){var r=kr.parse(e),a=ai(r),t=is(this._getId(s.schema));if(Object.keys(s.schema).length===0||a!==t){var n=Ot(a),i=this._refs[n];if(typeof i=="string")return hf.call(this,s,i,r);if(i instanceof ns)i.validate||this._compile(i),s=i;else if(i=this._schemas[n],i instanceof ns){if(i.validate||this._compile(i),n==Ot(e))return{schema:i,root:s,baseId:t};s=i}else return;if(!s.schema)return;t=is(this._getId(s.schema))}return si.call(this,r,t,s.schema,s)}function hf(s,e,r){var a=ls.call(this,s,e);if(a){var t=a.schema,n=a.baseId;s=a.root;var i=this._getId(t);return i&&(n=os(n,i)),si.call(this,r,n,t,s)}}var mf=cs.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function si(s,e,r,a){if(s.fragment=s.fragment||"",s.fragment.slice(0,1)=="/"){for(var t=s.fragment.split("/"),n=1;n<t.length;n++){var i=t[n];if(i){if(i=cs.unescapeFragment(i),r=r[i],r===void 0)break;var o;if(!mf[i]&&(o=this._getId(r),o&&(e=os(e,o)),r.$ref)){var l=os(e,r.$ref),u=ls.call(this,a,l);u&&(r=u.schema,a=u.root,e=u.baseId)}}}if(r!==void 0&&r!==a.schema)return{schema:r,root:a,baseId:e}}}var vf=cs.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function xa(s,e){if(e===!1)return!1;if(e===void 0||e===!0)return Ra(s);if(e)return Ta(s)<=e}function Ra(s){var e;if(Array.isArray(s)){for(var r=0;r<s.length;r++)if(e=s[r],typeof e=="object"&&!Ra(e))return!1}else for(var a in s)if(a=="$ref"||(e=s[a],typeof e=="object"&&!Ra(e)))return!1;return!0}function Ta(s){var e=0,r;if(Array.isArray(s)){for(var a=0;a<s.length;a++)if(r=s[a],typeof r=="object"&&(e+=Ta(r)),e==1/0)return 1/0}else for(var t in s){if(t=="$ref")return 1/0;if(vf[t])e++;else if(r=s[t],typeof r=="object"&&(e+=Ta(r)+1),e==1/0)return 1/0}return e}function is(s,e){e!==!1&&(s=Ot(s));var r=kr.parse(s);return ai(r)}function ai(s){return kr.serialize(s).split("#")[0]+"#"}var gf=/#\/?$/;function Ot(s){return s?s.replace(gf,""):""}function os(s,e){return e=Ot(e),kr.resolve(s,e)}function _f(s){var e=Ot(this._getId(s)),r={"":e},a={"":is(e,!1)},t={},n=this;return pf(s,{allKeys:!0},function(i,o,l,u,f,h,g){if(o!==""){var d=n._getId(i),m=r[u],_=a[u]+"/"+f;if(g!==void 0&&(_+="/"+(typeof g=="number"?g:cs.escapeFragment(g))),typeof d=="string"){d=m=Ot(m?kr.resolve(m,d):d);var v=n._refs[d];if(typeof v=="string"&&(v=n._refs[v]),v&&v.schema){if(!ri(i,v.schema))throw new Error('id "'+d+'" resolves to more than one schema')}else if(d!=Ot(_))if(d[0]=="#"){if(t[d]&&!ri(i,t[d]))throw new Error('id "'+d+'" resolves to more than one schema');t[d]=i}else n._refs[d]=_}r[o]=m,a[o]=_}}),t}});var ds=H((_m,oi)=>{"use strict";var Pa=us();oi.exports={Validation:ii(yf),MissingRef:ii(wa)};function yf(s){this.message="validation failed",this.errors=s,this.ajv=this.validation=!0}wa.message=function(s,e){return"can't resolve reference "+e+" from id "+s};function wa(s,e,r){this.message=r||wa.message(s,e),this.missingRef=Pa.url(s,e),this.missingSchema=Pa.normalizeId(Pa.fullPath(this.missingRef))}function ii(s){return s.prototype=Object.create(Error.prototype),s.prototype.constructor=s,s}});var Oa=H((ym,ci)=>{"use strict";ci.exports=function(s,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,a=e.cmp&&function(n){return function(i){return function(o,l){var u={key:o,value:i[o]},f={key:l,value:i[l]};return n(u,f)}}}(e.cmp),t=[];return function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i!==void 0){if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);var o,l;if(Array.isArray(i)){for(l="[",o=0;o<i.length;o++)o&&(l+=","),l+=n(i[o])||"null";return l+"]"}if(i===null)return"null";if(t.indexOf(i)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=t.push(i)-1,f=Object.keys(i).sort(a&&a(i));for(l="",o=0;o<f.length;o++){var h=f[o],g=n(i[h]);g&&(l&&(l+=","),l+=JSON.stringify(h)+":"+g)}return t.splice(u,1),"{"+l+"}"}}(s)}});var Ia=H((Em,li)=>{"use strict";li.exports=function(e,r,a){var t="",n=e.schema.$async===!0,i=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var l=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(l){var u="unknown keyword: "+l;if(e.opts.strictKeywords==="log")e.logger.warn(u);else throw new Error(u)}}if(e.isTop&&(t+=" var validate = ",n&&(e.async=!0,t+="async "),t+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(t+=" "+("/*# sourceURL="+o+" */")+" ")),typeof e.schema=="boolean"||!(i||e.schema.$ref)){var r="false schema",f=e.level,h=e.dataLevel,g=e.schema[r],d=e.schemaPath+e.util.getProperty(r),m=e.errSchemaPath+"/"+r,N=!e.opts.allErrors,q,_="data"+(h||""),P="valid"+f;if(e.schema===!1){e.isTop?N=!0:t+=" var "+P+" = false; ";var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(q||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'boolean schema is false' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var b=t;t=v.pop(),!e.compositeRule&&N?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n?t+=" return data; ":t+=" validate.errors = null; return true; ":t+=" var "+P+" = true; ";return e.isTop&&(t+=" }; return validate; "),t}if(e.isTop){var T=e.isTop,f=e.level=0,h=e.dataLevel=0,_="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var R="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(R);else throw new Error(R)}t+=" var vErrors = null; ",t+=" var errors = 0;     ",t+=" if (rootData === undefined) rootData = data; "}else{var f=e.level,h=e.dataLevel,_="data"+(h||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),n&&!e.async)throw new Error("async schema in sync schema");t+=" var errs_"+f+" = errors;"}var P="valid"+f,N=!e.opts.allErrors,A="",z="",q,C=e.schema.type,U=Array.isArray(C);if(C&&e.opts.nullable&&e.schema.nullable===!0&&(U?C.indexOf("null")==-1&&(C=C.concat("null")):C!="null"&&(C=[C,"null"],U=!0)),U&&C.length==1&&(C=C[0],U=!1),e.schema.$ref&&i){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(i=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(t+=" "+e.RULES.all.$comment.code(e,"$comment")),C){if(e.opts.coerceTypes)var M=e.util.coerceToTypes(e.opts.coerceTypes,C);var j=e.RULES.types[C];if(M||U||j===!0||j&&!xe(j)){var d=e.schemaPath+".type",m=e.errSchemaPath+"/type",d=e.schemaPath+".type",m=e.errSchemaPath+"/type",I=U?"checkDataTypes":"checkDataType";if(t+=" if ("+e.util[I](C,_,e.opts.strictNumbers,!0)+") { ",M){var D="dataType"+f,F="coerced"+f;t+=" var "+D+" = typeof "+_+"; var "+F+" = undefined; ",e.opts.coerceTypes=="array"&&(t+=" if ("+D+" == 'object' && Array.isArray("+_+") && "+_+".length == 1) { "+_+" = "+_+"[0]; "+D+" = typeof "+_+"; if ("+e.util.checkDataType(e.schema.type,_,e.opts.strictNumbers)+") "+F+" = "+_+"; } "),t+=" if ("+F+" !== undefined) ; ";var ce=M;if(ce)for(var J,te=-1,K=ce.length-1;te<K;)J=ce[te+=1],J=="string"?t+=" else if ("+D+" == 'number' || "+D+" == 'boolean') "+F+" = '' + "+_+"; else if ("+_+" === null) "+F+" = ''; ":J=="number"||J=="integer"?(t+=" else if ("+D+" == 'boolean' || "+_+" === null || ("+D+" == 'string' && "+_+" && "+_+" == +"+_+" ",J=="integer"&&(t+=" && !("+_+" % 1)"),t+=")) "+F+" = +"+_+"; "):J=="boolean"?t+=" else if ("+_+" === 'false' || "+_+" === 0 || "+_+" === null) "+F+" = false; else if ("+_+" === 'true' || "+_+" === 1) "+F+" = true; ":J=="null"?t+=" else if ("+_+" === '' || "+_+" === 0 || "+_+" === false) "+F+" = null; ":e.opts.coerceTypes=="array"&&J=="array"&&(t+=" else if ("+D+" == 'string' || "+D+" == 'number' || "+D+" == 'boolean' || "+_+" == null) "+F+" = ["+_+"]; ");t+=" else {   ";var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(q||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",U?t+=""+C.join(","):t+=""+C,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",U?t+=""+C.join(","):t+=""+C,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var b=t;t=v.pop(),!e.compositeRule&&N?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } if ("+F+" !== undefined) {  ";var B=h?"data"+(h-1||""):"parentData",me=h?e.dataPathArr[h]:"parentDataProperty";t+=" "+_+" = "+F+"; ",h||(t+="if ("+B+" !== undefined)"),t+=" "+B+"["+me+"] = "+F+"; } "}else{var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(q||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",U?t+=""+C.join(","):t+=""+C,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",U?t+=""+C.join(","):t+=""+C,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var b=t;t=v.pop(),!e.compositeRule&&N?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}t+=" } "}}if(e.schema.$ref&&!i)t+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",N&&(t+=" } if (errors === ",T?t+="0":t+="errs_"+f,t+=") { ",z+="}");else{var Te=e.RULES;if(Te){for(var j,Ie=-1,ae=Te.length-1;Ie<ae;)if(j=Te[Ie+=1],xe(j)){if(j.type&&(t+=" if ("+e.util.checkDataType(j.type,_,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(j.type=="object"&&e.schema.properties){var g=e.schema.properties,_e=Object.keys(g),Se=_e;if(Se)for(var Ne,Et=-1,ut=Se.length-1;Et<ut;){Ne=Se[Et+=1];var ye=g[Ne];if(ye.default!==void 0){var ve=_+e.util.getProperty(Ne);if(e.compositeRule){if(e.opts.strictDefaults){var R="default is ignored for: "+ve;if(e.opts.strictDefaults==="log")e.logger.warn(R);else throw new Error(R)}}else t+=" if ("+ve+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+ve+" === null || "+ve+" === '' "),t+=" ) "+ve+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(ye.default)+" ":t+=" "+JSON.stringify(ye.default)+" ",t+="; "}}}else if(j.type=="array"&&Array.isArray(e.schema.items)){var Nt=e.schema.items;if(Nt){for(var ye,te=-1,Pe=Nt.length-1;te<Pe;)if(ye=Nt[te+=1],ye.default!==void 0){var ve=_+"["+te+"]";if(e.compositeRule){if(e.opts.strictDefaults){var R="default is ignored for: "+ve;if(e.opts.strictDefaults==="log")e.logger.warn(R);else throw new Error(R)}}else t+=" if ("+ve+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+ve+" === null || "+ve+" === '' "),t+=" ) "+ve+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(ye.default)+" ":t+=" "+JSON.stringify(ye.default)+" ",t+="; "}}}}var ie=j.rules;if(ie){for(var bt,dt=-1,At=ie.length-1;dt<At;)if(bt=ie[dt+=1],Ue(bt)){var Ct=bt.code(e,bt.keyword,j.type);Ct&&(t+=" "+Ct+" ",N&&(A+="}"))}}if(N&&(t+=" "+A+" ",A=""),j.type&&(t+=" } ",C&&C===j.type&&!M)){t+=" else { ";var d=e.schemaPath+".type",m=e.errSchemaPath+"/type",v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(q||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",U?t+=""+C.join(","):t+=""+C,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",U?t+=""+C.join(","):t+=""+C,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var b=t;t=v.pop(),!e.compositeRule&&N?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } "}N&&(t+=" if (errors === ",T?t+="0":t+="errs_"+f,t+=") { ",z+="}")}}}N&&(t+=" "+z+" "),T?(n?(t+=" if (errors === 0) return data;           ",t+=" else throw new ValidationError(vErrors); "):(t+=" validate.errors = vErrors; ",t+=" return errors === 0;       "),t+=" }; return validate;"):t+=" var "+P+" = errors === errs_"+f+";";function xe(Ae){for(var rt=Ae.rules,Fe=0;Fe<rt.length;Fe++)if(Ue(rt[Fe]))return!0}function Ue(Ae){return e.schema[Ae.keyword]!==void 0||Ae.implements&&$e(Ae)}function $e(Ae){for(var rt=Ae.implements,Fe=0;Fe<rt.length;Fe++)if(e.schema[rt[Fe]]!==void 0)return!0}return t}});var hi=H((bm,pi)=>{"use strict";var fs=us(),hs=Jt(),di=ds(),Ef=Oa(),ui=Ia(),bf=hs.ucs2length,Sf=ss(),xf=di.Validation;pi.exports=Na;function Na(s,e,r,a){var t=this,n=this._opts,i=[void 0],o={},l=[],u={},f=[],h={},g=[];e=e||{schema:s,refVal:i,refs:o};var d=Rf.call(this,s,e,a),m=this._compilations[d.index];if(d.compiling)return m.callValidate=R;var _=this._formats,v=this.RULES;try{var b=P(s,e,r,a);m.validate=b;var T=m.callValidate;return T&&(T.schema=b.schema,T.errors=null,T.refs=b.refs,T.refVal=b.refVal,T.root=b.root,T.$async=b.$async,n.sourceCode&&(T.source=b.source)),b}finally{Tf.call(this,s,e,a)}function R(){var I=m.validate,D=I.apply(this,arguments);return R.errors=I.errors,D}function P(I,D,F,ce){var J=!D||D&&D.schema==I;if(D.schema!=e.schema)return Na.call(t,I,D,F,ce);var te=I.$async===!0,K=ui({isTop:!0,schema:I,isRoot:J,baseId:ce,root:D,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:di.MissingRef,RULES:v,validate:ui,util:hs,resolve:fs,resolveRef:N,usePattern:U,useDefault:M,useCustomRule:j,opts:n,formats:_,logger:t.logger,self:t});K=ps(i,Of)+ps(l,Pf)+ps(f,wf)+ps(g,If)+K,n.processCode&&(K=n.processCode(K,I));var B;try{var me=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",K);B=me(t,v,_,e,i,f,g,Sf,bf,xf),i[0]=B}catch(Te){throw t.logger.error("Error compiling schema, function code:",K),Te}return B.schema=I,B.errors=null,B.refs=o,B.refVal=i,B.root=J?B:D,te&&(B.$async=!0),n.sourceCode===!0&&(B.source={code:K,patterns:l,defaults:f}),B}function N(I,D,F){D=fs.url(I,D);var ce=o[D],J,te;if(ce!==void 0)return J=i[ce],te="refVal["+ce+"]",C(J,te);if(!F&&e.refs){var K=e.refs[D];if(K!==void 0)return J=e.refVal[K],te=A(D,J),C(J,te)}te=A(D);var B=fs.call(t,P,e,D);if(B===void 0){var me=r&&r[D];me&&(B=fs.inlineRef(me,n.inlineRefs)?me:Na.call(t,me,e,r,I))}if(B===void 0)z(D);else return q(D,B),C(B,te)}function A(I,D){var F=i.length;return i[F]=D,o[I]=F,"refVal"+F}function z(I){delete o[I]}function q(I,D){var F=o[I];i[F]=D}function C(I,D){return typeof I=="object"||typeof I=="boolean"?{code:D,schema:I,inline:!0}:{code:D,$async:I&&!!I.$async}}function U(I){var D=u[I];return D===void 0&&(D=u[I]=l.length,l[D]=I),"pattern"+D}function M(I){switch(typeof I){case"boolean":case"number":return""+I;case"string":return hs.toQuotedString(I);case"object":if(I===null)return"null";var D=Ef(I),F=h[D];return F===void 0&&(F=h[D]=f.length,f[F]=I),"default"+F}}function j(I,D,F,ce){if(t._opts.validateSchema!==!1){var J=I.definition.dependencies;if(J&&!J.every(function(Se){return Object.prototype.hasOwnProperty.call(F,Se)}))throw new Error("parent schema must have all required keywords: "+J.join(","));var te=I.definition.validateSchema;if(te){var K=te(D);if(!K){var B="keyword schema is invalid: "+t.errorsText(te.errors);if(t._opts.validateSchema=="log")t.logger.error(B);else throw new Error(B)}}}var me=I.definition.compile,Te=I.definition.inline,Ie=I.definition.macro,ae;if(me)ae=me.call(t,D,F,ce);else if(Ie)ae=Ie.call(t,D,F,ce),n.validateSchema!==!1&&t.validateSchema(ae,!0);else if(Te)ae=Te.call(t,ce,I.keyword,D,F);else if(ae=I.definition.validate,!ae)return;if(ae===void 0)throw new Error('custom keyword "'+I.keyword+'"failed to compile');var _e=g.length;return g[_e]=ae,{code:"customRule"+_e,validate:ae}}}function Rf(s,e,r){var a=fi.call(this,s,e,r);return a>=0?{index:a,compiling:!0}:(a=this._compilations.length,this._compilations[a]={schema:s,root:e,baseId:r},{index:a,compiling:!1})}function Tf(s,e,r){var a=fi.call(this,s,e,r);a>=0&&this._compilations.splice(a,1)}function fi(s,e,r){for(var a=0;a<this._compilations.length;a++){var t=this._compilations[a];if(t.schema==s&&t.root==e&&t.baseId==r)return a}return-1}function Pf(s,e){return"var pattern"+s+" = new RegExp("+hs.toQuotedString(e[s])+");"}function wf(s){return"var default"+s+" = defaults["+s+"];"}function Of(s,e){return e[s]===void 0?"":"var refVal"+s+" = refVal["+s+"];"}function If(s){return"var customRule"+s+" = customRules["+s+"];"}function ps(s,e){if(!s.length)return"";for(var r="",a=0;a<s.length;a++)r+=e(a,s);return r}});var vi=H((Sm,mi)=>{"use strict";var ms=mi.exports=function(){this._cache={}};ms.prototype.put=function(e,r){this._cache[e]=r};ms.prototype.get=function(e){return this._cache[e]};ms.prototype.del=function(e){delete this._cache[e]};ms.prototype.clear=function(){this._cache={}}});var Oi=H((xm,wi)=>{"use strict";var Nf=Jt(),Af=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Cf=[0,31,28,31,30,31,30,31,31,30,31,30,31],Df=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,gi=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,$f=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,kf=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,_i=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,yi=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,Ei=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,bi=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Si=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,xi=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;wi.exports=vs;function vs(s){return s=s=="full"?"full":"fast",Nf.copy(vs[s])}vs.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":_i,url:yi,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:gi,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Pi,uuid:Ei,"json-pointer":bi,"json-pointer-uri-fragment":Si,"relative-json-pointer":xi};vs.full={date:Ri,time:Ti,"date-time":Ff,uri:qf,"uri-reference":kf,"uri-template":_i,url:yi,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:gi,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Pi,uuid:Ei,"json-pointer":bi,"json-pointer-uri-fragment":Si,"relative-json-pointer":xi};function Lf(s){return s%4===0&&(s%100!==0||s%400===0)}function Ri(s){var e=s.match(Af);if(!e)return!1;var r=+e[1],a=+e[2],t=+e[3];return a>=1&&a<=12&&t>=1&&t<=(a==2&&Lf(r)?29:Cf[a])}function Ti(s,e){var r=s.match(Df);if(!r)return!1;var a=r[1],t=r[2],n=r[3],i=r[5];return(a<=23&&t<=59&&n<=59||a==23&&t==59&&n==60)&&(!e||i)}var jf=/t|\s/i;function Ff(s){var e=s.split(jf);return e.length==2&&Ri(e[0])&&Ti(e[1],!0)}var Mf=/\/|:/;function qf(s){return Mf.test(s)&&$f.test(s)}var Uf=/[^\\]\\Z/;function Pi(s){if(Uf.test(s))return!1;try{return new RegExp(s),!0}catch{return!1}}});var Ni=H((Rm,Ii)=>{"use strict";Ii.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,f="data"+(i||""),h="valid"+n,g,d;if(o=="#"||o=="#/")e.isRoot?(g=e.async,d="validate"):(g=e.root.schema.$async===!0,d="root.refVal[0]");else{var m=e.resolveRef(e.baseId,o,e.isRoot);if(m===void 0){var _=e.MissingRefError.message(e.baseId,o);if(e.opts.missingRefs=="fail"){e.logger.error(_);var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(o)+"' } ",e.opts.messages!==!1&&(t+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(o)+"' "),e.opts.verbose&&(t+=" , schema: "+e.util.toQuotedString(o)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var b=t;t=v.pop(),!e.compositeRule&&u?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(t+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(_),u&&(t+=" if (true) { ");else throw new e.MissingRefError(e.baseId,o,_)}else if(m.inline){var T=e.util.copy(e);T.level++;var R="valid"+T.level;T.schema=m.schema,T.schemaPath="",T.errSchemaPath=o;var P=e.validate(T).replace(/validate\.schema/g,m.code);t+=" "+P+" ",u&&(t+=" if ("+R+") { ")}else g=m.$async===!0||e.async&&m.$async!==!1,d=m.code}if(d){var v=v||[];v.push(t),t="",e.opts.passContext?t+=" "+d+".call(this, ":t+=" "+d+"( ",t+=" "+f+", (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var N=i?"data"+(i-1||""):"parentData",A=i?e.dataPathArr[i]:"parentDataProperty";t+=" , "+N+" , "+A+", rootData)  ";var z=t;if(t=v.pop(),g){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(t+=" var "+h+"; "),t+=" try { await "+z+"; ",u&&(t+=" "+h+" = true; "),t+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(t+=" "+h+" = false; "),t+=" } ",u&&(t+=" if ("+h+") { ")}else t+=" if (!"+z+") { if (vErrors === null) vErrors = "+d+".errors; else vErrors = vErrors.concat("+d+".errors); errors = vErrors.length; } ",u&&(t+=" else { ")}return t}});var Ci=H((Tm,Ai)=>{"use strict";Ai.exports=function(e,r,a){var t=" ",n=e.schema[r],i=e.schemaPath+e.util.getProperty(r),o=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u=e.util.copy(e),f="";u.level++;var h="valid"+u.level,g=u.baseId,d=!0,m=n;if(m)for(var _,v=-1,b=m.length-1;v<b;)_=m[v+=1],(e.opts.strictKeywords?typeof _=="object"&&Object.keys(_).length>0||_===!1:e.util.schemaHasRules(_,e.RULES.all))&&(d=!1,u.schema=_,u.schemaPath=i+"["+v+"]",u.errSchemaPath=o+"/"+v,t+="  "+e.validate(u)+" ",u.baseId=g,l&&(t+=" if ("+h+") { ",f+="}"));return l&&(d?t+=" if (true) { ":t+=" "+f.slice(0,-1)+" "),t}});var $i=H((Pm,Di)=>{"use strict";Di.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d="errs__"+n,m=e.util.copy(e),_="";m.level++;var v="valid"+m.level,b=o.every(function(q){return e.opts.strictKeywords?typeof q=="object"&&Object.keys(q).length>0||q===!1:e.util.schemaHasRules(q,e.RULES.all)});if(b){var T=m.baseId;t+=" var "+d+" = errors; var "+g+" = false;  ";var R=e.compositeRule;e.compositeRule=m.compositeRule=!0;var P=o;if(P)for(var N,A=-1,z=P.length-1;A<z;)N=P[A+=1],m.schema=N,m.schemaPath=l+"["+A+"]",m.errSchemaPath=u+"/"+A,t+="  "+e.validate(m)+" ",m.baseId=T,t+=" "+g+" = "+g+" || "+v+"; if (!"+g+") { ",_+="}";e.compositeRule=m.compositeRule=R,t+=" "+_+" if (!"+g+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else f&&(t+=" if (true) { ");return t}});var Li=H((wm,ki)=>{"use strict";ki.exports=function(e,r,a){var t=" ",n=e.schema[r],i=e.errSchemaPath+"/"+r,o=!e.opts.allErrors,l=e.util.toQuotedString(n);return e.opts.$comment===!0?t+=" console.log("+l+");":typeof e.opts.$comment=="function"&&(t+=" self._opts.$comment("+l+", "+e.util.toQuotedString(i)+", validate.root.schema);"),t}});var Fi=H((Om,ji)=>{"use strict";ji.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d=e.opts.$data&&o&&o.$data,m;d?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",m="schema"+n):m=o,d||(t+=" var schema"+n+" = validate.schema"+l+";"),t+="var "+g+" = equal("+h+", schema"+n+"); if (!"+g+") {   ";var _=_||[];_.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to constant' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var v=t;return t=_.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+v+"]); ":t+=" validate.errors = ["+v+"]; return false; ":t+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",f&&(t+=" else { "),t}});var qi=H((Im,Mi)=>{"use strict";Mi.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d="errs__"+n,m=e.util.copy(e),_="";m.level++;var v="valid"+m.level,b="i"+n,T=m.dataLevel=e.dataLevel+1,R="data"+T,P=e.baseId,N=e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all);if(t+="var "+d+" = errors;var "+g+";",N){var A=e.compositeRule;e.compositeRule=m.compositeRule=!0,m.schema=o,m.schemaPath=l,m.errSchemaPath=u,t+=" var "+v+" = false; for (var "+b+" = 0; "+b+" < "+h+".length; "+b+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,b,e.opts.jsonPointers,!0);var z=h+"["+b+"]";m.dataPathArr[T]=b;var q=e.validate(m);m.baseId=P,e.util.varOccurences(q,R)<2?t+=" "+e.util.varReplace(q,R,z)+" ":t+=" var "+R+" = "+z+"; "+q+" ",t+=" if ("+v+") break; }  ",e.compositeRule=m.compositeRule=A,t+=" "+_+" if (!"+v+") {"}else t+=" if ("+h+".length == 0) {";var C=C||[];C.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should contain a valid item' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var U=t;return t=C.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+U+"]); ":t+=" validate.errors = ["+U+"]; return false; ":t+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { ",N&&(t+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(t+=" } "),t}});var Vi=H((Nm,Ui)=>{"use strict";Ui.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="errs__"+n,d=e.util.copy(e),m="";d.level++;var _="valid"+d.level,v={},b={},T=e.opts.ownProperties;for(A in o)if(A!="__proto__"){var R=o[A],P=Array.isArray(R)?b:v;P[A]=R}t+="var "+g+" = errors;";var N=e.errorPath;t+="var missing"+n+";";for(var A in b)if(P=b[A],P.length){if(t+=" if ( "+h+e.util.getProperty(A)+" !== undefined ",T&&(t+=" && Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(A)+"') "),f){t+=" && ( ";var z=P;if(z)for(var q,C=-1,U=z.length-1;C<U;){q=z[C+=1],C&&(t+=" || ");var M=e.util.getProperty(q),j=h+M;t+=" ( ( "+j+" === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(q)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?q:M)+") ) "}t+=")) {  ";var I="missing"+n,D="' + "+I+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(N,I,!0):N+" + "+I);var F=F||[];F.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(A)+"', missingProperty: '"+D+"', depsCount: "+P.length+", deps: '"+e.util.escapeQuotes(P.length==1?P[0]:P.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",P.length==1?t+="property "+e.util.escapeQuotes(P[0]):t+="properties "+e.util.escapeQuotes(P.join(", ")),t+=" when property "+e.util.escapeQuotes(A)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var ce=t;t=F.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+ce+"]); ":t+=" validate.errors = ["+ce+"]; return false; ":t+=" var err = "+ce+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{t+=" ) { ";var J=P;if(J)for(var q,te=-1,K=J.length-1;te<K;){q=J[te+=1];var M=e.util.getProperty(q),D=e.util.escapeQuotes(q),j=h+M;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(N,q,e.opts.jsonPointers)),t+=" if ( "+j+" === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(q)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(A)+"', missingProperty: '"+D+"', depsCount: "+P.length+", deps: '"+e.util.escapeQuotes(P.length==1?P[0]:P.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",P.length==1?t+="property "+e.util.escapeQuotes(P[0]):t+="properties "+e.util.escapeQuotes(P.join(", ")),t+=" when property "+e.util.escapeQuotes(A)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t+=" }   ",f&&(m+="}",t+=" else { ")}e.errorPath=N;var B=d.baseId;for(var A in v){var R=v[A];(e.opts.strictKeywords?typeof R=="object"&&Object.keys(R).length>0||R===!1:e.util.schemaHasRules(R,e.RULES.all))&&(t+=" "+_+" = true; if ( "+h+e.util.getProperty(A)+" !== undefined ",T&&(t+=" && Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(A)+"') "),t+=") { ",d.schema=R,d.schemaPath=l+e.util.getProperty(A),d.errSchemaPath=u+"/"+e.util.escapeFragment(A),t+="  "+e.validate(d)+" ",d.baseId=B,t+=" }  ",f&&(t+=" if ("+_+") { ",m+="}"))}return f&&(t+="   "+m+" if ("+g+" == errors) {"),t}});var zi=H((Am,Hi)=>{"use strict";Hi.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d=e.opts.$data&&o&&o.$data,m;d?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",m="schema"+n):m=o;var _="i"+n,v="schema"+n;d||(t+=" var "+v+" = validate.schema"+l+";"),t+="var "+g+";",d&&(t+=" if (schema"+n+" === undefined) "+g+" = true; else if (!Array.isArray(schema"+n+")) "+g+" = false; else {"),t+=""+g+" = false;for (var "+_+"=0; "+_+"<"+v+".length; "+_+"++) if (equal("+h+", "+v+"["+_+"])) { "+g+" = true; break; }",d&&(t+="  }  "),t+=" if (!"+g+") {   ";var b=b||[];b.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var T=t;return t=b.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+T+"]); ":t+=" validate.errors = ["+T+"]; return false; ":t+=" var err = "+T+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",f&&(t+=" else { "),t}});var Zi=H((Cm,Bi)=>{"use strict";Bi.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||"");if(e.opts.format===!1)return f&&(t+=" if (true) { "),t;var g=e.opts.$data&&o&&o.$data,d;g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o;var m=e.opts.unknownFormats,_=Array.isArray(m);if(g){var v="format"+n,b="isObject"+n,T="formatType"+n;t+=" var "+v+" = formats["+d+"]; var "+b+" = typeof "+v+" == 'object' && !("+v+" instanceof RegExp) && "+v+".validate; var "+T+" = "+b+" && "+v+".type || 'string'; if ("+b+") { ",e.async&&(t+=" var async"+n+" = "+v+".async; "),t+=" "+v+" = "+v+".validate; } if (  ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),t+=" (",m!="ignore"&&(t+=" ("+d+" && !"+v+" ",_&&(t+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),t+=") || "),t+=" ("+v+" && "+T+" == '"+a+"' && !(typeof "+v+" == 'function' ? ",e.async?t+=" (async"+n+" ? await "+v+"("+h+") : "+v+"("+h+")) ":t+=" "+v+"("+h+") ",t+=" : "+v+".test("+h+"))))) {"}else{var v=e.formats[o];if(!v){if(m=="ignore")return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),f&&(t+=" if (true) { "),t;if(_&&m.indexOf(o)>=0)return f&&(t+=" if (true) { "),t;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var b=typeof v=="object"&&!(v instanceof RegExp)&&v.validate,T=b&&v.type||"string";if(b){var R=v.async===!0;v=v.validate}if(T!=a)return f&&(t+=" if (true) { "),t;if(R){if(!e.async)throw new Error("async format in sync schema");var P="formats"+e.util.getProperty(o)+".validate";t+=" if (!(await "+P+"("+h+"))) { "}else{t+=" if (! ";var P="formats"+e.util.getProperty(o);b&&(P+=".validate"),typeof v=="function"?t+=" "+P+"("+h+") ":t+=" "+P+".test("+h+") ",t+=") { "}}var N=N||[];N.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { format:  ",g?t+=""+d:t+=""+e.util.toQuotedString(o),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match format "`,g?t+="' + "+d+" + '":t+=""+e.util.escapeQuotes(o),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",g?t+="validate.schema"+l:t+=""+e.util.toQuotedString(o),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var A=t;return t=N.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+A+"]); ":t+=" validate.errors = ["+A+"]; return false; ":t+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",f&&(t+=" else { "),t}});var Xi=H((Dm,Gi)=>{"use strict";Gi.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d="errs__"+n,m=e.util.copy(e);m.level++;var _="valid"+m.level,v=e.schema.then,b=e.schema.else,T=v!==void 0&&(e.opts.strictKeywords?typeof v=="object"&&Object.keys(v).length>0||v===!1:e.util.schemaHasRules(v,e.RULES.all)),R=b!==void 0&&(e.opts.strictKeywords?typeof b=="object"&&Object.keys(b).length>0||b===!1:e.util.schemaHasRules(b,e.RULES.all)),P=m.baseId;if(T||R){var N;m.createErrors=!1,m.schema=o,m.schemaPath=l,m.errSchemaPath=u,t+=" var "+d+" = errors; var "+g+" = true;  ";var A=e.compositeRule;e.compositeRule=m.compositeRule=!0,t+="  "+e.validate(m)+" ",m.baseId=P,m.createErrors=!0,t+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=m.compositeRule=A,T?(t+=" if ("+_+") {  ",m.schema=e.schema.then,m.schemaPath=e.schemaPath+".then",m.errSchemaPath=e.errSchemaPath+"/then",t+="  "+e.validate(m)+" ",m.baseId=P,t+=" "+g+" = "+_+"; ",T&&R?(N="ifClause"+n,t+=" var "+N+" = 'then'; "):N="'then'",t+=" } ",R&&(t+=" else { ")):t+=" if (!"+_+") { ",R&&(m.schema=e.schema.else,m.schemaPath=e.schemaPath+".else",m.errSchemaPath=e.errSchemaPath+"/else",t+="  "+e.validate(m)+" ",m.baseId=P,t+=" "+g+" = "+_+"; ",T&&R?(N="ifClause"+n,t+=" var "+N+" = 'else'; "):N="'else'",t+=" } "),t+=" if (!"+g+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { failingKeyword: "+N+" } ",e.opts.messages!==!1&&(t+=` , message: 'should match "' + `+N+` + '" schema' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" }   ",f&&(t+=" else { ")}else f&&(t+=" if (true) { ");return t}});var Qi=H(($m,Wi)=>{"use strict";Wi.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d="errs__"+n,m=e.util.copy(e),_="";m.level++;var v="valid"+m.level,b="i"+n,T=m.dataLevel=e.dataLevel+1,R="data"+T,P=e.baseId;if(t+="var "+d+" = errors;var "+g+";",Array.isArray(o)){var N=e.schema.additionalItems;if(N===!1){t+=" "+g+" = "+h+".length <= "+o.length+"; ";var A=u;u=e.errSchemaPath+"/additionalItems",t+="  if (!"+g+") {   ";var z=z||[];z.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+o.length+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var q=t;t=z.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+q+"]); ":t+=" validate.errors = ["+q+"]; return false; ":t+=" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",u=A,f&&(_+="}",t+=" else { ")}var C=o;if(C){for(var U,M=-1,j=C.length-1;M<j;)if(U=C[M+=1],e.opts.strictKeywords?typeof U=="object"&&Object.keys(U).length>0||U===!1:e.util.schemaHasRules(U,e.RULES.all)){t+=" "+v+" = true; if ("+h+".length > "+M+") { ";var I=h+"["+M+"]";m.schema=U,m.schemaPath=l+"["+M+"]",m.errSchemaPath=u+"/"+M,m.errorPath=e.util.getPathExpr(e.errorPath,M,e.opts.jsonPointers,!0),m.dataPathArr[T]=M;var D=e.validate(m);m.baseId=P,e.util.varOccurences(D,R)<2?t+=" "+e.util.varReplace(D,R,I)+" ":t+=" var "+R+" = "+I+"; "+D+" ",t+=" }  ",f&&(t+=" if ("+v+") { ",_+="}")}}if(typeof N=="object"&&(e.opts.strictKeywords?typeof N=="object"&&Object.keys(N).length>0||N===!1:e.util.schemaHasRules(N,e.RULES.all))){m.schema=N,m.schemaPath=e.schemaPath+".additionalItems",m.errSchemaPath=e.errSchemaPath+"/additionalItems",t+=" "+v+" = true; if ("+h+".length > "+o.length+") {  for (var "+b+" = "+o.length+"; "+b+" < "+h+".length; "+b+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,b,e.opts.jsonPointers,!0);var I=h+"["+b+"]";m.dataPathArr[T]=b;var D=e.validate(m);m.baseId=P,e.util.varOccurences(D,R)<2?t+=" "+e.util.varReplace(D,R,I)+" ":t+=" var "+R+" = "+I+"; "+D+" ",f&&(t+=" if (!"+v+") break; "),t+=" } }  ",f&&(t+=" if ("+v+") { ",_+="}")}}else if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){m.schema=o,m.schemaPath=l,m.errSchemaPath=u,t+="  for (var "+b+" = 0; "+b+" < "+h+".length; "+b+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,b,e.opts.jsonPointers,!0);var I=h+"["+b+"]";m.dataPathArr[T]=b;var D=e.validate(m);m.baseId=P,e.util.varOccurences(D,R)<2?t+=" "+e.util.varReplace(D,R,I)+" ":t+=" var "+R+" = "+I+"; "+D+" ",f&&(t+=" if (!"+v+") break; "),t+=" }"}return f&&(t+=" "+_+" if ("+d+" == errors) {"),t}});var Aa=H((km,Ki)=>{"use strict";Ki.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,P,h="data"+(i||""),g=e.opts.$data&&o&&o.$data,d;g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o;var m=r=="maximum",_=m?"exclusiveMaximum":"exclusiveMinimum",v=e.schema[_],b=e.opts.$data&&v&&v.$data,T=m?"<":">",R=m?">":"<",P=void 0;if(!(g||typeof o=="number"||o===void 0))throw new Error(r+" must be number");if(!(b||v===void 0||typeof v=="number"||typeof v=="boolean"))throw new Error(_+" must be number or boolean");if(b){var N=e.util.getData(v.$data,i,e.dataPathArr),A="exclusive"+n,z="exclType"+n,q="exclIsNumber"+n,C="op"+n,U="' + "+C+" + '";t+=" var schemaExcl"+n+" = "+N+"; ",N="schemaExcl"+n,t+=" var "+A+"; var "+z+" = typeof "+N+"; if ("+z+" != 'boolean' && "+z+" != 'undefined' && "+z+" != 'number') { ";var P=_,M=M||[];M.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(P||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: '"+_+" should be boolean' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var j=t;t=M.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+j+"]); ":t+=" validate.errors = ["+j+"]; return false; ":t+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else if ( ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" "+z+" == 'number' ? ( ("+A+" = "+d+" === undefined || "+N+" "+T+"= "+d+") ? "+h+" "+R+"= "+N+" : "+h+" "+R+" "+d+" ) : ( ("+A+" = "+N+" === true) ? "+h+" "+R+"= "+d+" : "+h+" "+R+" "+d+" ) || "+h+" !== "+h+") { var op"+n+" = "+A+" ? '"+T+"' : '"+T+"='; ",o===void 0&&(P=_,u=e.errSchemaPath+"/"+_,d=N,g=b)}else{var q=typeof v=="number",U=T;if(q&&g){var C="'"+U+"'";t+=" if ( ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" ( "+d+" === undefined || "+v+" "+T+"= "+d+" ? "+h+" "+R+"= "+v+" : "+h+" "+R+" "+d+" ) || "+h+" !== "+h+") { "}else{q&&o===void 0?(A=!0,P=_,u=e.errSchemaPath+"/"+_,d=v,R+="="):(q&&(d=Math[m?"min":"max"](v,o)),v===(q?d:!0)?(A=!0,P=_,u=e.errSchemaPath+"/"+_,R+="="):(A=!1,U+="="));var C="'"+U+"'";t+=" if ( ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" "+h+" "+R+" "+d+" || "+h+" !== "+h+") { "}}P=P||r;var M=M||[];M.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(P||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+C+", limit: "+d+", exclusive: "+A+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be "+U+" ",g?t+="' + "+d:t+=""+d+"'"),e.opts.verbose&&(t+=" , schema:  ",g?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var j=t;return t=M.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+j+"]); ":t+=" validate.errors = ["+j+"]; return false; ":t+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",f&&(t+=" else { "),t}});var Ca=H((Lm,Ji)=>{"use strict";Ji.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,_,h="data"+(i||""),g=e.opts.$data&&o&&o.$data,d;if(g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(g||typeof o=="number"))throw new Error(r+" must be number");var m=r=="maxItems"?">":"<";t+="if ( ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" "+h+".length "+m+" "+d+") { ";var _=r,v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(_||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxItems"?t+="more":t+="fewer",t+=" than ",g?t+="' + "+d+" + '":t+=""+o,t+=" items' "),e.opts.verbose&&(t+=" , schema:  ",g?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var b=t;return t=v.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",f&&(t+=" else { "),t}});var Da=H((jm,Yi)=>{"use strict";Yi.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,_,h="data"+(i||""),g=e.opts.$data&&o&&o.$data,d;if(g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(g||typeof o=="number"))throw new Error(r+" must be number");var m=r=="maxLength"?">":"<";t+="if ( ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),e.opts.unicode===!1?t+=" "+h+".length ":t+=" ucs2length("+h+") ",t+=" "+m+" "+d+") { ";var _=r,v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(_||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be ",r=="maxLength"?t+="longer":t+="shorter",t+=" than ",g?t+="' + "+d+" + '":t+=""+o,t+=" characters' "),e.opts.verbose&&(t+=" , schema:  ",g?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var b=t;return t=v.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",f&&(t+=" else { "),t}});var $a=H((Fm,eo)=>{"use strict";eo.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,_,h="data"+(i||""),g=e.opts.$data&&o&&o.$data,d;if(g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(g||typeof o=="number"))throw new Error(r+" must be number");var m=r=="maxProperties"?">":"<";t+="if ( ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" Object.keys("+h+").length "+m+" "+d+") { ";var _=r,v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(_||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxProperties"?t+="more":t+="fewer",t+=" than ",g?t+="' + "+d+" + '":t+=""+o,t+=" properties' "),e.opts.verbose&&(t+=" , schema:  ",g?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var b=t;return t=v.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+b+"]); ":t+=" validate.errors = ["+b+"]; return false; ":t+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",f&&(t+=" else { "),t}});var ro=H((Mm,to)=>{"use strict";to.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g=e.opts.$data&&o&&o.$data,d;if(g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o,!(g||typeof o=="number"))throw new Error(r+" must be number");t+="var division"+n+";if (",g&&(t+=" "+d+" !== undefined && ( typeof "+d+" != 'number' || "),t+=" (division"+n+" = "+h+" / "+d+", ",e.opts.multipleOfPrecision?t+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":t+=" division"+n+" !== parseInt(division"+n+") ",t+=" ) ",g&&(t+="  )  "),t+=" ) {   ";var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be multiple of ",g?t+="' + "+d:t+=""+d+"'"),e.opts.verbose&&(t+=" , schema:  ",g?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var _=t;return t=m.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+_+"]); ":t+=" validate.errors = ["+_+"]; return false; ":t+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",f&&(t+=" else { "),t}});var ao=H((qm,so)=>{"use strict";so.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="errs__"+n,d=e.util.copy(e);d.level++;var m="valid"+d.level;if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=l,d.errSchemaPath=u,t+=" var "+g+" = errors;  ";var _=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1;var v;d.opts.allErrors&&(v=d.opts.allErrors,d.opts.allErrors=!1),t+=" "+e.validate(d)+" ",d.createErrors=!0,v&&(d.opts.allErrors=v),e.compositeRule=d.compositeRule=_,t+=" if ("+m+") {   ";var b=b||[];b.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var T=t;t=b.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+T+"]); ":t+=" validate.errors = ["+T+"]; return false; ":t+=" var err = "+T+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else {  errors = "+g+"; if (vErrors !== null) { if ("+g+") vErrors.length = "+g+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else t+="  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",f&&(t+=" if (false) { ");return t}});var io=H((Um,no)=>{"use strict";no.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d="errs__"+n,m=e.util.copy(e),_="";m.level++;var v="valid"+m.level,b=m.baseId,T="prevValid"+n,R="passingSchemas"+n;t+="var "+d+" = errors , "+T+" = false , "+g+" = false , "+R+" = null; ";var P=e.compositeRule;e.compositeRule=m.compositeRule=!0;var N=o;if(N)for(var A,z=-1,q=N.length-1;z<q;)A=N[z+=1],(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))?(m.schema=A,m.schemaPath=l+"["+z+"]",m.errSchemaPath=u+"/"+z,t+="  "+e.validate(m)+" ",m.baseId=b):t+=" var "+v+" = true; ",z&&(t+=" if ("+v+" && "+T+") { "+g+" = false; "+R+" = ["+R+", "+z+"]; } else { ",_+="}"),t+=" if ("+v+") { "+g+" = "+T+" = true; "+R+" = "+z+"; }";return e.compositeRule=m.compositeRule=P,t+=""+_+"if (!"+g+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { passingSchemas: "+R+" } ",e.opts.messages!==!1&&(t+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(t+=" } "),t}});var co=H((Vm,oo)=>{"use strict";oo.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g=e.opts.$data&&o&&o.$data,d;g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",d="schema"+n):d=o;var m=g?"(new RegExp("+d+"))":e.usePattern(o);t+="if ( ",g&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),t+=" !"+m+".test("+h+") ) {   ";var _=_||[];_.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",g?t+=""+d:t+=""+e.util.toQuotedString(o),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match pattern "`,g?t+="' + "+d+" + '":t+=""+e.util.escapeQuotes(o),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",g?t+="validate.schema"+l:t+=""+e.util.toQuotedString(o),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var v=t;return t=_.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+v+"]); ":t+=" validate.errors = ["+v+"]; return false; ":t+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",f&&(t+=" else { "),t}});var uo=H((Hm,lo)=>{"use strict";lo.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="errs__"+n,d=e.util.copy(e),m="";d.level++;var _="valid"+d.level,v="key"+n,b="idx"+n,T=d.dataLevel=e.dataLevel+1,R="data"+T,P="dataProperties"+n,N=Object.keys(o||{}).filter(te),A=e.schema.patternProperties||{},z=Object.keys(A).filter(te),q=e.schema.additionalProperties,C=N.length||z.length,U=q===!1,M=typeof q=="object"&&Object.keys(q).length,j=e.opts.removeAdditional,I=U||M||j,D=e.opts.ownProperties,F=e.baseId,ce=e.schema.required;if(ce&&!(e.opts.$data&&ce.$data)&&ce.length<e.opts.loopRequired)var J=e.util.toHash(ce);function te(Ke){return Ke!=="__proto__"}if(t+="var "+g+" = errors;var "+_+" = true;",D&&(t+=" var "+P+" = undefined;"),I){if(D?t+=" "+P+" = "+P+" || Object.keys("+h+"); for (var "+b+"=0; "+b+"<"+P+".length; "+b+"++) { var "+v+" = "+P+"["+b+"]; ":t+=" for (var "+v+" in "+h+") { ",C){if(t+=" var isAdditional"+n+" = !(false ",N.length)if(N.length>8)t+=" || validate.schema"+l+".hasOwnProperty("+v+") ";else{var K=N;if(K)for(var B,me=-1,Te=K.length-1;me<Te;)B=K[me+=1],t+=" || "+v+" == "+e.util.toQuotedString(B)+" "}if(z.length){var Ie=z;if(Ie)for(var ae,_e=-1,Se=Ie.length-1;_e<Se;)ae=Ie[_e+=1],t+=" || "+e.usePattern(ae)+".test("+v+") "}t+=" ); if (isAdditional"+n+") { "}if(j=="all")t+=" delete "+h+"["+v+"]; ";else{var Ne=e.errorPath,Et="' + "+v+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers)),U)if(j)t+=" delete "+h+"["+v+"]; ";else{t+=" "+_+" = false; ";var ut=u;u=e.errSchemaPath+"/additionalProperties";var ye=ye||[];ye.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { additionalProperty: '"+Et+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is an invalid additional property":t+="should NOT have additional properties",t+="' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var ve=t;t=ye.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+ve+"]); ":t+=" validate.errors = ["+ve+"]; return false; ":t+=" var err = "+ve+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=ut,f&&(t+=" break; ")}else if(M)if(j=="failing"){t+=" var "+g+" = errors;  ";var Nt=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=q,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Pe=h+"["+v+"]";d.dataPathArr[T]=v;var ie=e.validate(d);d.baseId=F,e.util.varOccurences(ie,R)<2?t+=" "+e.util.varReplace(ie,R,Pe)+" ":t+=" var "+R+" = "+Pe+"; "+ie+" ",t+=" if (!"+_+") { errors = "+g+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+h+"["+v+"]; }  ",e.compositeRule=d.compositeRule=Nt}else{d.schema=q,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Pe=h+"["+v+"]";d.dataPathArr[T]=v;var ie=e.validate(d);d.baseId=F,e.util.varOccurences(ie,R)<2?t+=" "+e.util.varReplace(ie,R,Pe)+" ":t+=" var "+R+" = "+Pe+"; "+ie+" ",f&&(t+=" if (!"+_+") break; ")}e.errorPath=Ne}C&&(t+=" } "),t+=" }  ",f&&(t+=" if ("+_+") { ",m+="}")}var bt=e.opts.useDefaults&&!e.compositeRule;if(N.length){var dt=N;if(dt)for(var B,At=-1,Ct=dt.length-1;At<Ct;){B=dt[At+=1];var xe=o[B];if(e.opts.strictKeywords?typeof xe=="object"&&Object.keys(xe).length>0||xe===!1:e.util.schemaHasRules(xe,e.RULES.all)){var Ue=e.util.getProperty(B),Pe=h+Ue,$e=bt&&xe.default!==void 0;d.schema=xe,d.schemaPath=l+Ue,d.errSchemaPath=u+"/"+e.util.escapeFragment(B),d.errorPath=e.util.getPath(e.errorPath,B,e.opts.jsonPointers),d.dataPathArr[T]=e.util.toQuotedString(B);var ie=e.validate(d);if(d.baseId=F,e.util.varOccurences(ie,R)<2){ie=e.util.varReplace(ie,R,Pe);var Ae=Pe}else{var Ae=R;t+=" var "+R+" = "+Pe+"; "}if($e)t+=" "+ie+" ";else{if(J&&J[B]){t+=" if ( "+Ae+" === undefined ",D&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(B)+"') "),t+=") { "+_+" = false; ";var Ne=e.errorPath,ut=u,rt=e.util.escapeQuotes(B);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(Ne,B,e.opts.jsonPointers)),u=e.errSchemaPath+"/required";var ye=ye||[];ye.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+rt+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+rt+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var ve=t;t=ye.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+ve+"]); ":t+=" validate.errors = ["+ve+"]; return false; ":t+=" var err = "+ve+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=ut,e.errorPath=Ne,t+=" } else { "}else f?(t+=" if ( "+Ae+" === undefined ",D&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(B)+"') "),t+=") { "+_+" = true; } else { "):(t+=" if ("+Ae+" !== undefined ",D&&(t+=" &&   Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(B)+"') "),t+=" ) { ");t+=" "+ie+" } "}}f&&(t+=" if ("+_+") { ",m+="}")}}if(z.length){var Fe=z;if(Fe)for(var ae,jr=-1,Ms=Fe.length-1;jr<Ms;){ae=Fe[jr+=1];var xe=A[ae];if(e.opts.strictKeywords?typeof xe=="object"&&Object.keys(xe).length>0||xe===!1:e.util.schemaHasRules(xe,e.RULES.all)){d.schema=xe,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ae),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ae),D?t+=" "+P+" = "+P+" || Object.keys("+h+"); for (var "+b+"=0; "+b+"<"+P+".length; "+b+"++) { var "+v+" = "+P+"["+b+"]; ":t+=" for (var "+v+" in "+h+") { ",t+=" if ("+e.usePattern(ae)+".test("+v+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Pe=h+"["+v+"]";d.dataPathArr[T]=v;var ie=e.validate(d);d.baseId=F,e.util.varOccurences(ie,R)<2?t+=" "+e.util.varReplace(ie,R,Pe)+" ":t+=" var "+R+" = "+Pe+"; "+ie+" ",f&&(t+=" if (!"+_+") break; "),t+=" } ",f&&(t+=" else "+_+" = true; "),t+=" }  ",f&&(t+=" if ("+_+") { ",m+="}")}}}return f&&(t+=" "+m+" if ("+g+" == errors) {"),t}});var po=H((zm,fo)=>{"use strict";fo.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="errs__"+n,d=e.util.copy(e),m="";d.level++;var _="valid"+d.level;if(t+="var "+g+" = errors;",e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=l,d.errSchemaPath=u;var v="key"+n,b="idx"+n,T="i"+n,R="' + "+v+" + '",P=d.dataLevel=e.dataLevel+1,N="data"+P,A="dataProperties"+n,z=e.opts.ownProperties,q=e.baseId;z&&(t+=" var "+A+" = undefined; "),z?t+=" "+A+" = "+A+" || Object.keys("+h+"); for (var "+b+"=0; "+b+"<"+A+".length; "+b+"++) { var "+v+" = "+A+"["+b+"]; ":t+=" for (var "+v+" in "+h+") { ",t+=" var startErrs"+n+" = errors; ";var C=v,U=e.compositeRule;e.compositeRule=d.compositeRule=!0;var M=e.validate(d);d.baseId=q,e.util.varOccurences(M,N)<2?t+=" "+e.util.varReplace(M,N,C)+" ":t+=" var "+N+" = "+C+"; "+M+" ",e.compositeRule=d.compositeRule=U,t+=" if (!"+_+") { for (var "+T+"=startErrs"+n+"; "+T+"<errors; "+T+"++) { vErrors["+T+"].propertyName = "+v+"; }   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { propertyName: '"+R+"' } ",e.opts.messages!==!1&&(t+=" , message: 'property name \\'"+R+"\\' is invalid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),f&&(t+=" break; "),t+=" } }"}return f&&(t+=" "+m+" if ("+g+" == errors) {"),t}});var mo=H((Bm,ho)=>{"use strict";ho.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d=e.opts.$data&&o&&o.$data,m;d?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",m="schema"+n):m=o;var _="schema"+n;if(!d)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var v=[],b=o;if(b)for(var T,R=-1,P=b.length-1;R<P;){T=b[R+=1];var N=e.schema.properties[T];N&&(e.opts.strictKeywords?typeof N=="object"&&Object.keys(N).length>0||N===!1:e.util.schemaHasRules(N,e.RULES.all))||(v[v.length]=T)}}else var v=o;if(d||v.length){var A=e.errorPath,z=d||v.length>=e.opts.loopRequired,q=e.opts.ownProperties;if(f)if(t+=" var missing"+n+"; ",z){d||(t+=" var "+_+" = validate.schema"+l+"; ");var C="i"+n,U="schema"+n+"["+C+"]",M="' + "+U+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(A,U,e.opts.jsonPointers)),t+=" var "+g+" = true; ",d&&(t+=" if (schema"+n+" === undefined) "+g+" = true; else if (!Array.isArray(schema"+n+")) "+g+" = false; else {"),t+=" for (var "+C+" = 0; "+C+" < "+_+".length; "+C+"++) { "+g+" = "+h+"["+_+"["+C+"]] !== undefined ",q&&(t+=" &&   Object.prototype.hasOwnProperty.call("+h+", "+_+"["+C+"]) "),t+="; if (!"+g+") break; } ",d&&(t+="  }  "),t+="  if (!"+g+") {   ";var j=j||[];j.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+M+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var I=t;t=j.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+I+"]); ":t+=" validate.errors = ["+I+"]; return false; ":t+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else{t+=" if ( ";var D=v;if(D)for(var F,C=-1,ce=D.length-1;C<ce;){F=D[C+=1],C&&(t+=" || ");var J=e.util.getProperty(F),te=h+J;t+=" ( ( "+te+" === undefined ",q&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(F)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?F:J)+") ) "}t+=") {  ";var U="missing"+n,M="' + "+U+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(A,U,!0):A+" + "+U);var j=j||[];j.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+M+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var I=t;t=j.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+I+"]); ":t+=" validate.errors = ["+I+"]; return false; ":t+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else if(z){d||(t+=" var "+_+" = validate.schema"+l+"; ");var C="i"+n,U="schema"+n+"["+C+"]",M="' + "+U+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(A,U,e.opts.jsonPointers)),d&&(t+=" if ("+_+" && !Array.isArray("+_+")) {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+M+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+_+" !== undefined) { "),t+=" for (var "+C+" = 0; "+C+" < "+_+".length; "+C+"++) { if ("+h+"["+_+"["+C+"]] === undefined ",q&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", "+_+"["+C+"]) "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+M+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(t+="  }  ")}else{var K=v;if(K)for(var F,B=-1,me=K.length-1;B<me;){F=K[B+=1];var J=e.util.getProperty(F),M=e.util.escapeQuotes(F),te=h+J;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(A,F,e.opts.jsonPointers)),t+=" if ( "+te+" === undefined ",q&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(F)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+M+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=A}else f&&(t+=" if (true) {");return t}});var go=H((Zm,vo)=>{"use strict";vo.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h="data"+(i||""),g="valid"+n,d=e.opts.$data&&o&&o.$data,m;if(d?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",m="schema"+n):m=o,(o||d)&&e.opts.uniqueItems!==!1){d&&(t+=" var "+g+"; if ("+m+" === false || "+m+" === undefined) "+g+" = true; else if (typeof "+m+" != 'boolean') "+g+" = false; else { "),t+=" var i = "+h+".length , "+g+" = true , j; if (i > 1) { ";var _=e.schema.items&&e.schema.items.type,v=Array.isArray(_);if(!_||_=="object"||_=="array"||v&&(_.indexOf("object")>=0||_.indexOf("array")>=0))t+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+h+"[i], "+h+"[j])) { "+g+" = false; break outer; } } } ";else{t+=" var itemIndices = {}, item; for (;i--;) { var item = "+h+"[i]; ";var b="checkDataType"+(v?"s":"");t+=" if ("+e.util[b](_,"item",e.opts.strictNumbers,!0)+") continue; ",v&&(t+=` if (typeof item == 'string') item = '"' + item; `),t+=" if (typeof itemIndices[item] == 'number') { "+g+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}t+=" } ",d&&(t+="  }  "),t+=" if (!"+g+") {   ";var T=T||[];T.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(t+=" , schema:  ",d?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var R=t;t=T.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+R+"]); ":t+=" validate.errors = ["+R+"]; return false; ":t+=" var err = "+R+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",f&&(t+=" else { ")}else f&&(t+=" if (true) { ");return t}});var yo=H((Gm,_o)=>{"use strict";_o.exports={$ref:Ni(),allOf:Ci(),anyOf:$i(),$comment:Li(),const:Fi(),contains:qi(),dependencies:Vi(),enum:zi(),format:Zi(),if:Xi(),items:Qi(),maximum:Aa(),minimum:Aa(),maxItems:Ca(),minItems:Ca(),maxLength:Da(),minLength:Da(),maxProperties:$a(),minProperties:$a(),multipleOf:ro(),not:ao(),oneOf:io(),pattern:co(),properties:uo(),propertyNames:po(),required:mo(),uniqueItems:go(),validate:Ia()}});var So=H((Xm,bo)=>{"use strict";var Eo=yo(),ka=Jt().toHash;bo.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],r=["type","$comment"],a=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],t=["number","integer","string","array","object","boolean","null"];return e.all=ka(r),e.types=ka(t),e.forEach(function(n){n.rules=n.rules.map(function(i){var o;if(typeof i=="object"){var l=Object.keys(i)[0];o=i[l],i=l,o.forEach(function(f){r.push(f),e.all[f]=!0})}r.push(i);var u=e.all[i]={keyword:i,code:Eo[i],implements:o};return u}),e.all.$comment={keyword:"$comment",code:Eo.$comment},n.type&&(e.types[n.type]=n)}),e.keywords=ka(r.concat(a)),e.custom={},e}});var To=H((Wm,Ro)=>{"use strict";var xo=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];Ro.exports=function(s,e){for(var r=0;r<e.length;r++){s=JSON.parse(JSON.stringify(s));var a=e[r].split("/"),t=s,n;for(n=1;n<a.length;n++)t=t[a[n]];for(n=0;n<xo.length;n++){var i=xo[n],o=t[i];o&&(t[i]={anyOf:[o,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return s}});var Oo=H((Qm,wo)=>{"use strict";var Vf=ds().MissingRef;wo.exports=Po;function Po(s,e,r){var a=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(r=e,e=void 0);var t=n(s).then(function(){var o=a._addSchema(s,void 0,e);return o.validate||i(o)});return r&&t.then(function(o){r(null,o)},r),t;function n(o){var l=o.$schema;return l&&!a.getSchema(l)?Po.call(a,{$ref:l},!0):Promise.resolve()}function i(o){try{return a._compile(o)}catch(u){if(u instanceof Vf)return l(u);throw u}function l(u){var f=u.missingSchema;if(d(f))throw new Error("Schema "+f+" is loaded but "+u.missingRef+" cannot be resolved");var h=a._loadingSchemas[f];return h||(h=a._loadingSchemas[f]=a._opts.loadSchema(f),h.then(g,g)),h.then(function(m){if(!d(f))return n(m).then(function(){d(f)||a.addSchema(m,f,void 0,e)})}).then(function(){return i(o)});function g(){delete a._loadingSchemas[f]}function d(m){return a._refs[m]||a._schemas[m]}}}}});var No=H((Km,Io)=>{"use strict";Io.exports=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,h,g="data"+(i||""),d="valid"+n,m="errs__"+n,_=e.opts.$data&&o&&o.$data,v;_?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",v="schema"+n):v=o;var b=this,T="definition"+n,R=b.definition,P="",N,A,z,q,C;if(_&&R.$data){C="keywordValidate"+n;var U=R.validateSchema;t+=" var "+T+" = RULES.custom['"+r+"'].definition; var "+C+" = "+T+".validate;"}else{if(q=e.useCustomRule(b,o,e.schema,e),!q)return;v="validate.schema"+l,C=q.code,N=R.compile,A=R.inline,z=R.macro}var M=C+".errors",j="i"+n,I="ruleErr"+n,D=R.async;if(D&&!e.async)throw new Error("async keyword in sync schema");if(A||z||(t+=""+M+" = null;"),t+="var "+m+" = errors;var "+d+";",_&&R.$data&&(P+="}",t+=" if ("+v+" === undefined) { "+d+" = true; } else { ",U&&(P+="}",t+=" "+d+" = "+T+".validateSchema("+v+"); if ("+d+") { ")),A)R.statements?t+=" "+q.validate+" ":t+=" "+d+" = "+q.validate+"; ";else if(z){var F=e.util.copy(e),P="";F.level++;var ce="valid"+F.level;F.schema=q.validate,F.schemaPath="";var J=e.compositeRule;e.compositeRule=F.compositeRule=!0;var te=e.validate(F).replace(/validate\.schema/g,C);e.compositeRule=F.compositeRule=J,t+=" "+te}else{var K=K||[];K.push(t),t="",t+="  "+C+".call( ",e.opts.passContext?t+="this":t+="self",N||R.schema===!1?t+=" , "+g+" ":t+=" , "+v+" , "+g+" , validate.schema"+e.schemaPath+" ",t+=" , (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var B=i?"data"+(i-1||""):"parentData",me=i?e.dataPathArr[i]:"parentDataProperty";t+=" , "+B+" , "+me+" , rootData )  ";var Te=t;t=K.pop(),R.errors===!1?(t+=" "+d+" = ",D&&(t+="await "),t+=""+Te+"; "):D?(M="customErrors"+n,t+=" var "+M+" = null; try { "+d+" = await "+Te+"; } catch (e) { "+d+" = false; if (e instanceof ValidationError) "+M+" = e.errors; else throw e; } "):t+=" "+M+" = null; "+d+" = "+Te+"; "}if(R.modifying&&(t+=" if ("+B+") "+g+" = "+B+"["+me+"];"),t+=""+P,R.valid)f&&(t+=" if (true) { ");else{t+=" if ( ",R.valid===void 0?(t+=" !",z?t+=""+ce:t+=""+d):t+=" "+!R.valid+" ",t+=") { ",h=b.keyword;var K=K||[];K.push(t),t="";var K=K||[];K.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(h||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+b.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+b.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),t+=" } "):t+=" {} ";var Ie=t;t=K.pop(),!e.compositeRule&&f?e.async?t+=" throw new ValidationError(["+Ie+"]); ":t+=" validate.errors = ["+Ie+"]; return false; ":t+=" var err = "+Ie+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var ae=t;t=K.pop(),A?R.errors?R.errors!="full"&&(t+="  for (var "+j+"="+m+"; "+j+"<errors; "+j+"++) { var "+I+" = vErrors["+j+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(t+=" "+I+".schema = "+v+"; "+I+".data = "+g+"; "),t+=" } "):R.errors===!1?t+=" "+ae+" ":(t+=" if ("+m+" == errors) { "+ae+" } else {  for (var "+j+"="+m+"; "+j+"<errors; "+j+"++) { var "+I+" = vErrors["+j+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(t+=" "+I+".schema = "+v+"; "+I+".data = "+g+"; "),t+=" } } "):z?(t+="   var err =   ",e.createErrors!==!1?(t+=" { keyword: '"+(h||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+b.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+b.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; ")):R.errors===!1?t+=" "+ae+" ":(t+=" if (Array.isArray("+M+")) { if (vErrors === null) vErrors = "+M+"; else vErrors = vErrors.concat("+M+"); errors = vErrors.length;  for (var "+j+"="+m+"; "+j+"<errors; "+j+"++) { var "+I+" = vErrors["+j+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+";  "+I+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(t+=" "+I+".schema = "+v+"; "+I+".data = "+g+"; "),t+=" } } else { "+ae+" } "),t+=" } ",f&&(t+=" else { ")}return t}});var La=H((Jm,Hf)=>{Hf.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Do=H((Ym,Co)=>{"use strict";var Ao=La();Co.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:Ao.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:Ao.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var ko=H((ev,$o)=>{"use strict";var zf=/^[a-z_$][a-z0-9_$-]*$/i,Bf=No(),Zf=Do();$o.exports={add:Gf,get:Xf,remove:Wf,validate:ja};function Gf(s,e){var r=this.RULES;if(r.keywords[s])throw new Error("Keyword "+s+" is already defined");if(!zf.test(s))throw new Error("Keyword "+s+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var a=e.type;if(Array.isArray(a))for(var t=0;t<a.length;t++)i(s,a[t],e);else i(s,a,e);var n=e.metaSchema;n&&(e.$data&&this._opts.$data&&(n={anyOf:[n,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(n,!0))}r.keywords[s]=r.all[s]=!0;function i(o,l,u){for(var f,h=0;h<r.length;h++){var g=r[h];if(g.type==l){f=g;break}}f||(f={type:l,rules:[]},r.push(f));var d={keyword:o,definition:u,custom:!0,code:Bf,implements:u.implements};f.rules.push(d),r.custom[o]=d}return this}function Xf(s){var e=this.RULES.custom[s];return e?e.definition:this.RULES.keywords[s]||!1}function Wf(s){var e=this.RULES;delete e.keywords[s],delete e.all[s],delete e.custom[s];for(var r=0;r<e.length;r++)for(var a=e[r].rules,t=0;t<a.length;t++)if(a[t].keyword==s){a.splice(t,1);break}return this}function ja(s,e){ja.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(Zf,!0);if(r(s))return!0;if(ja.errors=r.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}});var Lo=H((tv,Qf)=>{Qf.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Ma=H((rv,Bo)=>{"use strict";var Fo=hi(),Yt=us(),Kf=vi(),Mo=Sa(),Jf=Oa(),Yf=Oi(),ep=So(),qo=To(),Uo=Jt();Bo.exports=ge;ge.prototype.validate=rp;ge.prototype.compile=sp;ge.prototype.addSchema=ap;ge.prototype.addMetaSchema=np;ge.prototype.validateSchema=ip;ge.prototype.getSchema=cp;ge.prototype.removeSchema=up;ge.prototype.addFormat=_p;ge.prototype.errorsText=gp;ge.prototype._addSchema=dp;ge.prototype._compile=fp;ge.prototype.compileAsync=Oo();var ys=ko();ge.prototype.addKeyword=ys.add;ge.prototype.getKeyword=ys.get;ge.prototype.removeKeyword=ys.remove;ge.prototype.validateKeyword=ys.validate;var Vo=ds();ge.ValidationError=Vo.Validation;ge.MissingRefError=Vo.MissingRef;ge.$dataMetaSchema=qo;var _s="http://json-schema.org/draft-07/schema",jo=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],tp=["/properties"];function ge(s){if(!(this instanceof ge))return new ge(s);s=this._opts=Uo.copy(s)||{},Rp(this),this._schemas={},this._refs={},this._fragments={},this._formats=Yf(s.format),this._cache=s.cache||new Kf,this._loadingSchemas={},this._compilations=[],this.RULES=ep(),this._getId=pp(s),s.loopRequired=s.loopRequired||1/0,s.errorDataPath=="property"&&(s._errorDataPathProperty=!0),s.serialize===void 0&&(s.serialize=Jf),this._metaOpts=xp(this),s.formats&&bp(this),s.keywords&&Sp(this),yp(this),typeof s.meta=="object"&&this.addMetaSchema(s.meta),s.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),Ep(this)}function rp(s,e){var r;if(typeof s=="string"){if(r=this.getSchema(s),!r)throw new Error('no schema with key or ref "'+s+'"')}else{var a=this._addSchema(s);r=a.validate||this._compile(a)}var t=r(e);return r.$async!==!0&&(this.errors=r.errors),t}function sp(s,e){var r=this._addSchema(s,void 0,e);return r.validate||this._compile(r)}function ap(s,e,r,a){if(Array.isArray(s)){for(var t=0;t<s.length;t++)this.addSchema(s[t],void 0,r,a);return this}var n=this._getId(s);if(n!==void 0&&typeof n!="string")throw new Error("schema id must be string");return e=Yt.normalizeId(e||n),zo(this,e),this._schemas[e]=this._addSchema(s,r,a,!0),this}function np(s,e,r){return this.addSchema(s,e,r,!0),this}function ip(s,e){var r=s.$schema;if(r!==void 0&&typeof r!="string")throw new Error("$schema must be a string");if(r=r||this._opts.defaultMeta||op(this),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var a=this.validate(r,s);if(!a&&e){var t="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(t);else throw new Error(t)}return a}function op(s){var e=s._opts.meta;return s._opts.defaultMeta=typeof e=="object"?s._getId(e)||e:s.getSchema(_s)?_s:void 0,s._opts.defaultMeta}function cp(s){var e=Ho(this,s);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return lp(this,s)}}function lp(s,e){var r=Yt.schema.call(s,{schema:{}},e);if(r){var a=r.schema,t=r.root,n=r.baseId,i=Fo.call(s,a,t,void 0,n);return s._fragments[e]=new Mo({ref:e,fragment:!0,schema:a,root:t,baseId:n,validate:i}),i}}function Ho(s,e){return e=Yt.normalizeId(e),s._schemas[e]||s._refs[e]||s._fragments[e]}function up(s){if(s instanceof RegExp)return gs(this,this._schemas,s),gs(this,this._refs,s),this;switch(typeof s){case"undefined":return gs(this,this._schemas),gs(this,this._refs),this._cache.clear(),this;case"string":var e=Ho(this,s);return e&&this._cache.del(e.cacheKey),delete this._schemas[s],delete this._refs[s],this;case"object":var r=this._opts.serialize,a=r?r(s):s;this._cache.del(a);var t=this._getId(s);t&&(t=Yt.normalizeId(t),delete this._schemas[t],delete this._refs[t])}return this}function gs(s,e,r){for(var a in e){var t=e[a];!t.meta&&(!r||r.test(a))&&(s._cache.del(t.cacheKey),delete e[a])}}function dp(s,e,r,a){if(typeof s!="object"&&typeof s!="boolean")throw new Error("schema should be object or boolean");var t=this._opts.serialize,n=t?t(s):s,i=this._cache.get(n);if(i)return i;a=a||this._opts.addUsedSchema!==!1;var o=Yt.normalizeId(this._getId(s));o&&a&&zo(this,o);var l=this._opts.validateSchema!==!1&&!e,u;l&&!(u=o&&o==Yt.normalizeId(s.$schema))&&this.validateSchema(s,!0);var f=Yt.ids.call(this,s),h=new Mo({id:o,schema:s,localRefs:f,cacheKey:n,meta:r});return o[0]!="#"&&a&&(this._refs[o]=h),this._cache.put(n,h),l&&u&&this.validateSchema(s,!0),h}function fp(s,e){if(s.compiling)return s.validate=t,t.schema=s.schema,t.errors=null,t.root=e||t,s.schema.$async===!0&&(t.$async=!0),t;s.compiling=!0;var r;s.meta&&(r=this._opts,this._opts=this._metaOpts);var a;try{a=Fo.call(this,s.schema,e,s.localRefs)}catch(n){throw delete s.validate,n}finally{s.compiling=!1,s.meta&&(this._opts=r)}return s.validate=a,s.refs=a.refs,s.refVal=a.refVal,s.root=a.root,a;function t(){var n=s.validate,i=n.apply(this,arguments);return t.errors=n.errors,i}}function pp(s){switch(s.schemaId){case"auto":return vp;case"id":return hp;default:return mp}}function hp(s){return s.$id&&this.logger.warn("schema $id ignored",s.$id),s.id}function mp(s){return s.id&&this.logger.warn("schema id ignored",s.id),s.$id}function vp(s){if(s.$id&&s.id&&s.$id!=s.id)throw new Error("schema $id is different from id");return s.$id||s.id}function gp(s,e){if(s=s||this.errors,!s)return"No errors";e=e||{};for(var r=e.separator===void 0?", ":e.separator,a=e.dataVar===void 0?"data":e.dataVar,t="",n=0;n<s.length;n++){var i=s[n];i&&(t+=a+i.dataPath+" "+i.message+r)}return t.slice(0,-r.length)}function _p(s,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[s]=e,this}function yp(s){var e;if(s._opts.$data&&(e=Lo(),s.addMetaSchema(e,e.$id,!0)),s._opts.meta!==!1){var r=La();s._opts.$data&&(r=qo(r,tp)),s.addMetaSchema(r,_s,!0),s._refs["http://json-schema.org/schema"]=_s}}function Ep(s){var e=s._opts.schemas;if(e)if(Array.isArray(e))s.addSchema(e);else for(var r in e)s.addSchema(e[r],r)}function bp(s){for(var e in s._opts.formats){var r=s._opts.formats[e];s.addFormat(e,r)}}function Sp(s){for(var e in s._opts.keywords){var r=s._opts.keywords[e];s.addKeyword(e,r)}}function zo(s,e){if(s._schemas[e]||s._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function xp(s){for(var e=Uo.copy(s._opts),r=0;r<jo.length;r++)delete e[jo[r]];return e}function Rp(s){var e=s._opts.logger;if(e===!1)s.logger={log:Fa,warn:Fa,error:Fa};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");s.logger=e}}function Fa(){}});var $c=H((Ny,Dc)=>{Dc.exports=Cc;Cc.sync=Up;var Nc=St("fs");function qp(s,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var a=0;a<r.length;a++){var t=r[a].toLowerCase();if(t&&s.substr(-t.length).toLowerCase()===t)return!0}return!1}function Ac(s,e,r){return!s.isSymbolicLink()&&!s.isFile()?!1:qp(e,r)}function Cc(s,e,r){Nc.stat(s,function(a,t){r(a,a?!1:Ac(t,s,e))})}function Up(s,e){return Ac(Nc.statSync(s),s,e)}});var Mc=H((Ay,Fc)=>{Fc.exports=Lc;Lc.sync=Vp;var kc=St("fs");function Lc(s,e,r){kc.stat(s,function(a,t){r(a,a?!1:jc(t,e))})}function Vp(s,e){return jc(kc.statSync(s),e)}function jc(s,e){return s.isFile()&&Hp(s,e)}function Hp(s,e){var r=s.mode,a=s.uid,t=s.gid,n=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),o=parseInt("100",8),l=parseInt("010",8),u=parseInt("001",8),f=o|l,h=r&u||r&l&&t===i||r&o&&a===n||r&f&&n===0;return h}});var Uc=H((Dy,qc)=>{var Cy=St("fs"),Cs;process.platform==="win32"||global.TESTING_WINDOWS?Cs=$c():Cs=Mc();qc.exports=Xa;Xa.sync=zp;function Xa(s,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(a,t){Xa(s,e||{},function(n,i){n?t(n):a(i)})})}Cs(s,e||{},function(a,t){a&&(a.code==="EACCES"||e&&e.ignoreErrors)&&(a=null,t=!1),r(a,t)})}function zp(s,e){try{return Cs.sync(s,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var Xc=H(($y,Gc)=>{var gr=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Vc=St("path"),Bp=gr?";":":",Hc=Uc(),zc=s=>Object.assign(new Error(`not found: ${s}`),{code:"ENOENT"}),Bc=(s,e)=>{let r=e.colon||Bp,a=s.match(/\//)||gr&&s.match(/\\/)?[""]:[...gr?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],t=gr?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",n=gr?t.split(r):[""];return gr&&s.indexOf(".")!==-1&&n[0]!==""&&n.unshift(""),{pathEnv:a,pathExt:n,pathExtExe:t}},Zc=(s,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:a,pathExt:t,pathExtExe:n}=Bc(s,e),i=[],o=u=>new Promise((f,h)=>{if(u===a.length)return e.all&&i.length?f(i):h(zc(s));let g=a[u],d=/^".*"$/.test(g)?g.slice(1,-1):g,m=Vc.join(d,s),_=!d&&/^\.[\\\/]/.test(s)?s.slice(0,2)+m:m;f(l(_,u,0))}),l=(u,f,h)=>new Promise((g,d)=>{if(h===t.length)return g(o(f+1));let m=t[h];Hc(u+m,{pathExt:n},(_,v)=>{if(!_&&v)if(e.all)i.push(u+m);else return g(u+m);return g(l(u,f,h+1))})});return r?o(0).then(u=>r(null,u),r):o(0)},Zp=(s,e)=>{e=e||{};let{pathEnv:r,pathExt:a,pathExtExe:t}=Bc(s,e),n=[];for(let i=0;i<r.length;i++){let o=r[i],l=/^".*"$/.test(o)?o.slice(1,-1):o,u=Vc.join(l,s),f=!l&&/^\.[\\\/]/.test(s)?s.slice(0,2)+u:u;for(let h=0;h<a.length;h++){let g=f+a[h];try{if(Hc.sync(g,{pathExt:t}))if(e.all)n.push(g);else return g}catch{}}}if(e.all&&n.length)return n;if(e.nothrow)return null;throw zc(s)};Gc.exports=Zc;Zc.sync=Zp});var Qc=H((ky,Wa)=>{"use strict";var Wc=(s={})=>{let e=s.env||process.env;return(s.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(a=>a.toUpperCase()==="PATH")||"Path"};Wa.exports=Wc;Wa.exports.default=Wc});var el=H((Ly,Yc)=>{"use strict";var Kc=St("path"),Gp=Xc(),Xp=Qc();function Jc(s,e){let r=s.options.env||process.env,a=process.cwd(),t=s.options.cwd!=null,n=t&&process.chdir!==void 0&&!process.chdir.disabled;if(n)try{process.chdir(s.options.cwd)}catch{}let i;try{i=Gp.sync(s.command,{path:r[Xp({env:r})],pathExt:e?Kc.delimiter:void 0})}catch{}finally{n&&process.chdir(a)}return i&&(i=Kc.resolve(t?s.options.cwd:"",i)),i}function Wp(s){return Jc(s)||Jc(s,!0)}Yc.exports=Wp});var tl=H((jy,Ka)=>{"use strict";var Qa=/([()\][%!^"`<>&|;, *?])/g;function Qp(s){return s=s.replace(Qa,"^$1"),s}function Kp(s,e){return s=`${s}`,s=s.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),s=s.replace(/(?=(\\+?)?)\1$/,"$1$1"),s=`"${s}"`,s=s.replace(Qa,"^$1"),e&&(s=s.replace(Qa,"^$1")),s}Ka.exports.command=Qp;Ka.exports.argument=Kp});var sl=H((Fy,rl)=>{"use strict";rl.exports=/^#!(.*)/});var nl=H((My,al)=>{"use strict";var Jp=sl();al.exports=(s="")=>{let e=s.match(Jp);if(!e)return null;let[r,a]=e[0].replace(/#! ?/,"").split(" "),t=r.split("/").pop();return t==="env"?a:a?`${t} ${a}`:t}});var ol=H((qy,il)=>{"use strict";var Ja=St("fs"),Yp=nl();function eh(s){let r=Buffer.alloc(150),a;try{a=Ja.openSync(s,"r"),Ja.readSync(a,r,0,150,0),Ja.closeSync(a)}catch{}return Yp(r.toString())}il.exports=eh});var dl=H((Uy,ul)=>{"use strict";var th=St("path"),cl=el(),ll=tl(),rh=ol(),sh=process.platform==="win32",ah=/\.(?:com|exe)$/i,nh=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function ih(s){s.file=cl(s);let e=s.file&&rh(s.file);return e?(s.args.unshift(s.file),s.command=e,cl(s)):s.file}function oh(s){if(!sh)return s;let e=ih(s),r=!ah.test(e);if(s.options.forceShell||r){let a=nh.test(e);s.command=th.normalize(s.command),s.command=ll.command(s.command),s.args=s.args.map(n=>ll.argument(n,a));let t=[s.command].concat(s.args).join(" ");s.args=["/d","/s","/c",`"${t}"`],s.command=process.env.comspec||"cmd.exe",s.options.windowsVerbatimArguments=!0}return s}function ch(s,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let a={command:s,args:e,options:r,file:void 0,original:{command:s,args:e}};return r.shell?a:oh(a)}ul.exports=ch});var hl=H((Vy,pl)=>{"use strict";var Ya=process.platform==="win32";function en(s,e){return Object.assign(new Error(`${e} ${s.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${s.command}`,path:s.command,spawnargs:s.args})}function lh(s,e){if(!Ya)return;let r=s.emit;s.emit=function(a,t){if(a==="exit"){let n=fl(t,e);if(n)return r.call(s,"error",n)}return r.apply(s,arguments)}}function fl(s,e){return Ya&&s===1&&!e.file?en(e.original,"spawn"):null}function uh(s,e){return Ya&&s===1&&!e.file?en(e.original,"spawnSync"):null}pl.exports={hookChildProcess:lh,verifyENOENT:fl,verifyENOENTSync:uh,notFoundError:en}});var gl=H((Hy,_r)=>{"use strict";var ml=St("child_process"),tn=dl(),rn=hl();function vl(s,e,r){let a=tn(s,e,r),t=ml.spawn(a.command,a.args,a.options);return rn.hookChildProcess(t,a),t}function dh(s,e,r){let a=tn(s,e,r),t=ml.spawnSync(a.command,a.args,a.options);return t.error=t.error||rn.verifyENOENTSync(t.status,a),t}_r.exports=vl;_r.exports.spawn=vl;_r.exports.sync=dh;_r.exports._parse=tn;_r.exports._enoent=rn});var c={};Zl(c,{BRAND:()=>yu,DIRTY:()=>Lt,EMPTY_PATH:()=>Kl,INVALID:()=>Z,NEVER:()=>sd,OK:()=>we,ParseStatus:()=>Re,Schema:()=>Q,ZodAny:()=>Tt,ZodArray:()=>_t,ZodBigInt:()=>Ft,ZodBoolean:()=>Mt,ZodBranded:()=>Or,ZodCatch:()=>Qt,ZodDate:()=>qt,ZodDefault:()=>Wt,ZodDiscriminatedUnion:()=>Hr,ZodEffects:()=>Ze,ZodEnum:()=>Gt,ZodError:()=>ke,ZodFirstPartyTypeKind:()=>O,ZodFunction:()=>Br,ZodIntersection:()=>zt,ZodIssueCode:()=>w,ZodLazy:()=>Bt,ZodLiteral:()=>Zt,ZodMap:()=>fr,ZodNaN:()=>hr,ZodNativeEnum:()=>Xt,ZodNever:()=>Je,ZodNull:()=>Vt,ZodNullable:()=>ot,ZodNumber:()=>jt,ZodObject:()=>Le,ZodOptional:()=>ze,ZodParsedType:()=>k,ZodPipeline:()=>Ir,ZodPromise:()=>Pt,ZodReadonly:()=>Kt,ZodRecord:()=>zr,ZodSchema:()=>Q,ZodSet:()=>pr,ZodString:()=>Rt,ZodSymbol:()=>ur,ZodTransformer:()=>Ze,ZodTuple:()=>it,ZodType:()=>Q,ZodUndefined:()=>Ut,ZodUnion:()=>Ht,ZodUnknown:()=>gt,ZodVoid:()=>dr,addIssueToContext:()=>$,any:()=>Ou,array:()=>Cu,bigint:()=>xu,boolean:()=>On,coerce:()=>rd,custom:()=>Tn,date:()=>Ru,datetimeRegex:()=>xn,defaultErrorMap:()=>mt,discriminatedUnion:()=>Lu,effect:()=>Xu,enum:()=>Bu,function:()=>Vu,getErrorMap:()=>or,getParsedType:()=>nt,instanceof:()=>bu,intersection:()=>ju,isAborted:()=>Ur,isAsync:()=>cr,isDirty:()=>Vr,isValid:()=>xt,late:()=>Eu,lazy:()=>Hu,literal:()=>zu,makeIssue:()=>wr,map:()=>qu,nan:()=>Su,nativeEnum:()=>Zu,never:()=>Nu,null:()=>wu,nullable:()=>Qu,number:()=>wn,object:()=>Du,objectUtil:()=>Bs,oboolean:()=>td,onumber:()=>ed,optional:()=>Wu,ostring:()=>Yu,pipeline:()=>Ju,preprocess:()=>Ku,promise:()=>Gu,quotelessJson:()=>Xl,record:()=>Mu,set:()=>Uu,setErrorMap:()=>Ql,strictObject:()=>$u,string:()=>Pn,symbol:()=>Tu,transformer:()=>Xu,tuple:()=>Fu,undefined:()=>Pu,union:()=>ku,unknown:()=>Iu,util:()=>Y,void:()=>Au});var Y;(function(s){s.assertEqual=t=>{};function e(t){}s.assertIs=e;function r(t){throw new Error}s.assertNever=r,s.arrayToEnum=t=>{let n={};for(let i of t)n[i]=i;return n},s.getValidEnumValues=t=>{let n=s.objectKeys(t).filter(o=>typeof t[t[o]]!="number"),i={};for(let o of n)i[o]=t[o];return s.objectValues(i)},s.objectValues=t=>s.objectKeys(t).map(function(n){return t[n]}),s.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{let n=[];for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.push(i);return n},s.find=(t,n)=>{for(let i of t)if(n(i))return i},s.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&Number.isFinite(t)&&Math.floor(t)===t;function a(t,n=" | "){return t.map(i=>typeof i=="string"?`'${i}'`:i).join(n)}s.joinValues=a,s.jsonStringifyReplacer=(t,n)=>typeof n=="bigint"?n.toString():n})(Y||(Y={}));var Bs;(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(Bs||(Bs={}));var k=Y.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nt=s=>{switch(typeof s){case"undefined":return k.undefined;case"string":return k.string;case"number":return Number.isNaN(s)?k.nan:k.number;case"boolean":return k.boolean;case"function":return k.function;case"bigint":return k.bigint;case"symbol":return k.symbol;case"object":return Array.isArray(s)?k.array:s===null?k.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?k.promise:typeof Map<"u"&&s instanceof Map?k.map:typeof Set<"u"&&s instanceof Set?k.set:typeof Date<"u"&&s instanceof Date?k.date:k.object;default:return k.unknown}};var w=Y.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Xl=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:"),ke=class s extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(let i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(t);else if(i.code==="invalid_return_type")t(i.returnTypeError);else if(i.code==="invalid_arguments")t(i.argumentsError);else if(i.path.length===0)a._errors.push(r(i));else{let o=a,l=0;for(;l<i.path.length;){let u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(r(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return t(this),a}static assert(e){if(!(e instanceof s))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Y.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},a=[];for(let t of this.issues)if(t.path.length>0){let n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}};ke.create=s=>new ke(s);var Wl=(s,e)=>{let r;switch(s.code){case w.invalid_type:s.received===k.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case w.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,Y.jsonStringifyReplacer)}`;break;case w.unrecognized_keys:r=`Unrecognized key(s) in object: ${Y.joinValues(s.keys,", ")}`;break;case w.invalid_union:r="Invalid input";break;case w.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Y.joinValues(s.options)}`;break;case w.invalid_enum_value:r=`Invalid enum value. Expected ${Y.joinValues(s.options)}, received '${s.received}'`;break;case w.invalid_arguments:r="Invalid function arguments";break;case w.invalid_return_type:r="Invalid function return type";break;case w.invalid_date:r="Invalid date";break;case w.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:Y.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case w.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case w.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case w.custom:r="Invalid input";break;case w.invalid_intersection_types:r="Intersection results could not be merged";break;case w.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case w.not_finite:r="Number must be finite";break;default:r=e.defaultError,Y.assertNever(s)}return{message:r}},mt=Wl;var _n=mt;function Ql(s){_n=s}function or(){return _n}var wr=s=>{let{data:e,path:r,errorMaps:a,issueData:t}=s,n=[...r,...t.path||[]],i={...t,path:n};if(t.message!==void 0)return{...t,path:n,message:t.message};let o="",l=a.filter(u=>!!u).slice().reverse();for(let u of l)o=u(i,{data:e,defaultError:o}).message;return{...t,path:n,message:o}},Kl=[];function $(s,e){let r=or(),a=wr({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===mt?void 0:mt].filter(t=>!!t)});s.common.issues.push(a)}var Re=class s{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let a=[];for(let t of r){if(t.status==="aborted")return Z;t.status==="dirty"&&e.dirty(),a.push(t.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,r){let a=[];for(let t of r){let n=await t.key,i=await t.value;a.push({key:n,value:i})}return s.mergeObjectSync(e,a)}static mergeObjectSync(e,r){let a={};for(let t of r){let{key:n,value:i}=t;if(n.status==="aborted"||i.status==="aborted")return Z;n.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof i.value<"u"||t.alwaysSet)&&(a[n.value]=i.value)}return{status:e.value,value:a}}},Z=Object.freeze({status:"aborted"}),Lt=s=>({status:"dirty",value:s}),we=s=>({status:"valid",value:s}),Ur=s=>s.status==="aborted",Vr=s=>s.status==="dirty",xt=s=>s.status==="valid",cr=s=>typeof Promise<"u"&&s instanceof Promise;var V;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(V||(V={}));var Be=class{constructor(e,r,a,t){this._cachedPath=[],this.parent=e,this.data=r,this._path=a,this._key=t}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yn=(s,e)=>{if(xt(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new ke(s.common.issues);return this._error=r,this._error}}};function X(s){if(!s)return{};let{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(i,o)=>{let{message:l}=s;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??a??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??r??o.defaultError}},description:t}}var Q=class{get description(){return this._def.description}_getType(e){return nt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:nt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:nt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(cr(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let a=this.safeParse(e,r);if(a.success)return a.data;throw a.error}safeParse(e,r){let a={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nt(e)},t=this._parseSync({data:e,path:a.path,parent:a});return yn(a,t)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nt(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:r});return xt(a)?{value:a.value}:{issues:r.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>xt(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,r){let a=await this.safeParseAsync(e,r);if(a.success)return a.data;throw a.error}async safeParseAsync(e,r){let a={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nt(e)},t=this._parse({data:e,path:a.path,parent:a}),n=await(cr(t)?t:Promise.resolve(t));return yn(a,n)}refine(e,r){let a=t=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(t):r;return this._refinement((t,n)=>{let i=e(t),o=()=>n.addIssue({code:w.custom,...a(t)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,r){return this._refinement((a,t)=>e(a)?!0:(t.addIssue(typeof r=="function"?r(a,t):r),!1))}_refinement(e){return new Ze({schema:this,typeName:O.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return ze.create(this,this._def)}nullable(){return ot.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _t.create(this)}promise(){return Pt.create(this,this._def)}or(e){return Ht.create([this,e],this._def)}and(e){return zt.create(this,e,this._def)}transform(e){return new Ze({...X(this._def),schema:this,typeName:O.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new Wt({...X(this._def),innerType:this,defaultValue:r,typeName:O.ZodDefault})}brand(){return new Or({typeName:O.ZodBranded,type:this,...X(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new Qt({...X(this._def),innerType:this,catchValue:r,typeName:O.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Ir.create(this,e)}readonly(){return Kt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Jl=/^c[^\s-]{8,}$/i,Yl=/^[0-9a-z]+$/,eu=/^[0-9A-HJKMNP-TV-Z]{26}$/i,tu=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ru=/^[a-z0-9_-]{21}$/i,su=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,au=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,nu=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,iu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Zs,ou=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,cu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,lu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,uu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,du=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,fu=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,bn="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",pu=new RegExp(`^${bn}$`);function Sn(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);let r=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function hu(s){return new RegExp(`^${Sn(s)}$`)}function xn(s){let e=`${bn}T${Sn(s)}`,r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function mu(s,e){return!!((e==="v4"||!e)&&ou.test(s)||(e==="v6"||!e)&&lu.test(s))}function vu(s,e){if(!su.test(s))return!1;try{let[r]=s.split(".");if(!r)return!1;let a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),t=JSON.parse(atob(a));return!(typeof t!="object"||t===null||"typ"in t&&t?.typ!=="JWT"||!t.alg||e&&t.alg!==e)}catch{return!1}}function gu(s,e){return!!((e==="v4"||!e)&&cu.test(s)||(e==="v6"||!e)&&uu.test(s))}var Rt=class s extends Q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==k.string){let n=this._getOrReturnCtx(e);return $(n,{code:w.invalid_type,expected:k.string,received:n.parsedType}),Z}let a=new Re,t;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(t=this._getOrReturnCtx(e,t),$(t,{code:w.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(t=this._getOrReturnCtx(e,t),$(t,{code:w.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,o=e.data.length<n.value;(i||o)&&(t=this._getOrReturnCtx(e,t),i?$(t,{code:w.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&$(t,{code:w.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")nu.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"email",code:w.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")Zs||(Zs=new RegExp(iu,"u")),Zs.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"emoji",code:w.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")tu.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"uuid",code:w.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")ru.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"nanoid",code:w.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")Jl.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"cuid",code:w.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")Yl.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"cuid2",code:w.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")eu.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"ulid",code:w.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{t=this._getOrReturnCtx(e,t),$(t,{validation:"url",code:w.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"regex",code:w.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(t=this._getOrReturnCtx(e,t),$(t,{code:w.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(t=this._getOrReturnCtx(e,t),$(t,{code:w.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(t=this._getOrReturnCtx(e,t),$(t,{code:w.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?xn(n).test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{code:w.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?pu.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{code:w.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?hu(n).test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{code:w.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?au.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"duration",code:w.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?mu(e.data,n.version)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"ip",code:w.invalid_string,message:n.message}),a.dirty()):n.kind==="jwt"?vu(e.data,n.alg)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"jwt",code:w.invalid_string,message:n.message}),a.dirty()):n.kind==="cidr"?gu(e.data,n.version)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"cidr",code:w.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?du.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"base64",code:w.invalid_string,message:n.message}),a.dirty()):n.kind==="base64url"?fu.test(e.data)||(t=this._getOrReturnCtx(e,t),$(t,{validation:"base64url",code:w.invalid_string,message:n.message}),a.dirty()):Y.assertNever(n);return{status:a.value,value:e.data}}_regex(e,r,a){return this.refinement(t=>e.test(t),{validation:r,code:w.invalid_string,...V.errToObj(a)})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...V.errToObj(e)})}url(e){return this._addCheck({kind:"url",...V.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...V.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...V.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...V.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...V.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...V.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...V.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...V.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...V.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...V.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...V.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...V.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...V.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...V.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...V.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...V.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...V.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...V.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...V.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...V.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...V.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...V.errToObj(r)})}nonempty(e){return this.min(1,V.errToObj(e))}trim(){return new s({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Rt.create=s=>new Rt({checks:[],typeName:O.ZodString,coerce:s?.coerce??!1,...X(s)});function _u(s,e){let r=(s.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,t=r>a?r:a,n=Number.parseInt(s.toFixed(t).replace(".","")),i=Number.parseInt(e.toFixed(t).replace(".",""));return n%i/10**t}var jt=class s extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==k.number){let n=this._getOrReturnCtx(e);return $(n,{code:w.invalid_type,expected:k.number,received:n.parsedType}),Z}let a,t=new Re;for(let n of this._def.checks)n.kind==="int"?Y.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),$(a,{code:w.invalid_type,expected:"integer",received:"float",message:n.message}),t.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),$(a,{code:w.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),$(a,{code:w.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="multipleOf"?_u(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),$(a,{code:w.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),$(a,{code:w.not_finite,message:n.message}),t.dirty()):Y.assertNever(n);return{status:t.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,V.toString(r))}gt(e,r){return this.setLimit("min",e,!1,V.toString(r))}lte(e,r){return this.setLimit("max",e,!0,V.toString(r))}lt(e,r){return this.setLimit("max",e,!1,V.toString(r))}setLimit(e,r,a,t){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:V.toString(t)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:V.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:V.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:V.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:V.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:V.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:V.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:V.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:V.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:V.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Y.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value)}return Number.isFinite(r)&&Number.isFinite(e)}};jt.create=s=>new jt({checks:[],typeName:O.ZodNumber,coerce:s?.coerce||!1,...X(s)});var Ft=class s extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==k.bigint)return this._getInvalidInput(e);let a,t=new Re;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),$(a,{code:w.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),$(a,{code:w.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),$(a,{code:w.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):Y.assertNever(n);return{status:t.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return $(r,{code:w.invalid_type,expected:k.bigint,received:r.parsedType}),Z}gte(e,r){return this.setLimit("min",e,!0,V.toString(r))}gt(e,r){return this.setLimit("min",e,!1,V.toString(r))}lte(e,r){return this.setLimit("max",e,!0,V.toString(r))}lt(e,r){return this.setLimit("max",e,!1,V.toString(r))}setLimit(e,r,a,t){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:V.toString(t)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:V.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:V.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:V.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:V.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:V.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Ft.create=s=>new Ft({checks:[],typeName:O.ZodBigInt,coerce:s?.coerce??!1,...X(s)});var Mt=class extends Q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==k.boolean){let a=this._getOrReturnCtx(e);return $(a,{code:w.invalid_type,expected:k.boolean,received:a.parsedType}),Z}return we(e.data)}};Mt.create=s=>new Mt({typeName:O.ZodBoolean,coerce:s?.coerce||!1,...X(s)});var qt=class s extends Q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==k.date){let n=this._getOrReturnCtx(e);return $(n,{code:w.invalid_type,expected:k.date,received:n.parsedType}),Z}if(Number.isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return $(n,{code:w.invalid_date}),Z}let a=new Re,t;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(t=this._getOrReturnCtx(e,t),$(t,{code:w.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(t=this._getOrReturnCtx(e,t),$(t,{code:w.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Y.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:V.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:V.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};qt.create=s=>new qt({checks:[],coerce:s?.coerce||!1,typeName:O.ZodDate,...X(s)});var ur=class extends Q{_parse(e){if(this._getType(e)!==k.symbol){let a=this._getOrReturnCtx(e);return $(a,{code:w.invalid_type,expected:k.symbol,received:a.parsedType}),Z}return we(e.data)}};ur.create=s=>new ur({typeName:O.ZodSymbol,...X(s)});var Ut=class extends Q{_parse(e){if(this._getType(e)!==k.undefined){let a=this._getOrReturnCtx(e);return $(a,{code:w.invalid_type,expected:k.undefined,received:a.parsedType}),Z}return we(e.data)}};Ut.create=s=>new Ut({typeName:O.ZodUndefined,...X(s)});var Vt=class extends Q{_parse(e){if(this._getType(e)!==k.null){let a=this._getOrReturnCtx(e);return $(a,{code:w.invalid_type,expected:k.null,received:a.parsedType}),Z}return we(e.data)}};Vt.create=s=>new Vt({typeName:O.ZodNull,...X(s)});var Tt=class extends Q{constructor(){super(...arguments),this._any=!0}_parse(e){return we(e.data)}};Tt.create=s=>new Tt({typeName:O.ZodAny,...X(s)});var gt=class extends Q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return we(e.data)}};gt.create=s=>new gt({typeName:O.ZodUnknown,...X(s)});var Je=class extends Q{_parse(e){let r=this._getOrReturnCtx(e);return $(r,{code:w.invalid_type,expected:k.never,received:r.parsedType}),Z}};Je.create=s=>new Je({typeName:O.ZodNever,...X(s)});var dr=class extends Q{_parse(e){if(this._getType(e)!==k.undefined){let a=this._getOrReturnCtx(e);return $(a,{code:w.invalid_type,expected:k.void,received:a.parsedType}),Z}return we(e.data)}};dr.create=s=>new dr({typeName:O.ZodVoid,...X(s)});var _t=class s extends Q{_parse(e){let{ctx:r,status:a}=this._processInputParams(e),t=this._def;if(r.parsedType!==k.array)return $(r,{code:w.invalid_type,expected:k.array,received:r.parsedType}),Z;if(t.exactLength!==null){let i=r.data.length>t.exactLength.value,o=r.data.length<t.exactLength.value;(i||o)&&($(r,{code:i?w.too_big:w.too_small,minimum:o?t.exactLength.value:void 0,maximum:i?t.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:t.exactLength.message}),a.dirty())}if(t.minLength!==null&&r.data.length<t.minLength.value&&($(r,{code:w.too_small,minimum:t.minLength.value,type:"array",inclusive:!0,exact:!1,message:t.minLength.message}),a.dirty()),t.maxLength!==null&&r.data.length>t.maxLength.value&&($(r,{code:w.too_big,maximum:t.maxLength.value,type:"array",inclusive:!0,exact:!1,message:t.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((i,o)=>t.type._parseAsync(new Be(r,i,r.path,o)))).then(i=>Re.mergeArray(a,i));let n=[...r.data].map((i,o)=>t.type._parseSync(new Be(r,i,r.path,o)));return Re.mergeArray(a,n)}get element(){return this._def.type}min(e,r){return new s({...this._def,minLength:{value:e,message:V.toString(r)}})}max(e,r){return new s({...this._def,maxLength:{value:e,message:V.toString(r)}})}length(e,r){return new s({...this._def,exactLength:{value:e,message:V.toString(r)}})}nonempty(e){return this.min(1,e)}};_t.create=(s,e)=>new _t({type:s,minLength:null,maxLength:null,exactLength:null,typeName:O.ZodArray,...X(e)});function lr(s){if(s instanceof Le){let e={};for(let r in s.shape){let a=s.shape[r];e[r]=ze.create(lr(a))}return new Le({...s._def,shape:()=>e})}else return s instanceof _t?new _t({...s._def,type:lr(s.element)}):s instanceof ze?ze.create(lr(s.unwrap())):s instanceof ot?ot.create(lr(s.unwrap())):s instanceof it?it.create(s.items.map(e=>lr(e))):s}var Le=class s extends Q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=Y.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==k.object){let u=this._getOrReturnCtx(e);return $(u,{code:w.invalid_type,expected:k.object,received:u.parsedType}),Z}let{status:a,ctx:t}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Je&&this._def.unknownKeys==="strip"))for(let u in t.data)i.includes(u)||o.push(u);let l=[];for(let u of i){let f=n[u],h=t.data[u];l.push({key:{status:"valid",value:u},value:f._parse(new Be(t,h,t.path,u)),alwaysSet:u in t.data})}if(this._def.catchall instanceof Je){let u=this._def.unknownKeys;if(u==="passthrough")for(let f of o)l.push({key:{status:"valid",value:f},value:{status:"valid",value:t.data[f]}});else if(u==="strict")o.length>0&&($(t,{code:w.unrecognized_keys,keys:o}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let f of o){let h=t.data[f];l.push({key:{status:"valid",value:f},value:u._parse(new Be(t,h,t.path,f)),alwaysSet:f in t.data})}}return t.common.async?Promise.resolve().then(async()=>{let u=[];for(let f of l){let h=await f.key,g=await f.value;u.push({key:h,value:g,alwaysSet:f.alwaysSet})}return u}).then(u=>Re.mergeObjectSync(a,u)):Re.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return V.errToObj,new s({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,a)=>{let t=this._def.errorMap?.(r,a).message??a.defaultError;return r.code==="unrecognized_keys"?{message:V.errToObj(e).message??t}:{message:t}}}:{}})}strip(){return new s({...this._def,unknownKeys:"strip"})}passthrough(){return new s({...this._def,unknownKeys:"passthrough"})}extend(e){return new s({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new s({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:O.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new s({...this._def,catchall:e})}pick(e){let r={};for(let a of Y.objectKeys(e))e[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new s({...this._def,shape:()=>r})}omit(e){let r={};for(let a of Y.objectKeys(this.shape))e[a]||(r[a]=this.shape[a]);return new s({...this._def,shape:()=>r})}deepPartial(){return lr(this)}partial(e){let r={};for(let a of Y.objectKeys(this.shape)){let t=this.shape[a];e&&!e[a]?r[a]=t:r[a]=t.optional()}return new s({...this._def,shape:()=>r})}required(e){let r={};for(let a of Y.objectKeys(this.shape))if(e&&!e[a])r[a]=this.shape[a];else{let n=this.shape[a];for(;n instanceof ze;)n=n._def.innerType;r[a]=n}return new s({...this._def,shape:()=>r})}keyof(){return Rn(Y.objectKeys(this.shape))}};Le.create=(s,e)=>new Le({shape:()=>s,unknownKeys:"strip",catchall:Je.create(),typeName:O.ZodObject,...X(e)});Le.strictCreate=(s,e)=>new Le({shape:()=>s,unknownKeys:"strict",catchall:Je.create(),typeName:O.ZodObject,...X(e)});Le.lazycreate=(s,e)=>new Le({shape:s,unknownKeys:"strip",catchall:Je.create(),typeName:O.ZodObject,...X(e)});var Ht=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a=this._def.options;function t(n){for(let o of n)if(o.result.status==="valid")return o.result;for(let o of n)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;let i=n.map(o=>new ke(o.ctx.common.issues));return $(r,{code:w.invalid_union,unionErrors:i}),Z}if(r.common.async)return Promise.all(a.map(async n=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await n._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(t);{let n,i=[];for(let l of a){let u={...r,common:{...r.common,issues:[]},parent:null},f=l._parseSync({data:r.data,path:r.path,parent:u});if(f.status==="valid")return f;f.status==="dirty"&&!n&&(n={result:f,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(n)return r.common.issues.push(...n.ctx.common.issues),n.result;let o=i.map(l=>new ke(l));return $(r,{code:w.invalid_union,unionErrors:o}),Z}}get options(){return this._def.options}};Ht.create=(s,e)=>new Ht({options:s,typeName:O.ZodUnion,...X(e)});var vt=s=>s instanceof Bt?vt(s.schema):s instanceof Ze?vt(s.innerType()):s instanceof Zt?[s.value]:s instanceof Gt?s.options:s instanceof Xt?Y.objectValues(s.enum):s instanceof Wt?vt(s._def.innerType):s instanceof Ut?[void 0]:s instanceof Vt?[null]:s instanceof ze?[void 0,...vt(s.unwrap())]:s instanceof ot?[null,...vt(s.unwrap())]:s instanceof Or||s instanceof Kt?vt(s.unwrap()):s instanceof Qt?vt(s._def.innerType):[],Hr=class s extends Q{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==k.object)return $(r,{code:w.invalid_type,expected:k.object,received:r.parsedType}),Z;let a=this.discriminator,t=r.data[a],n=this.optionsMap.get(t);return n?r.common.async?n._parseAsync({data:r.data,path:r.path,parent:r}):n._parseSync({data:r.data,path:r.path,parent:r}):($(r,{code:w.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),Z)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,a){let t=new Map;for(let n of r){let i=vt(n.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let o of i){if(t.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);t.set(o,n)}}return new s({typeName:O.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:t,...X(a)})}};function Gs(s,e){let r=nt(s),a=nt(e);if(s===e)return{valid:!0,data:s};if(r===k.object&&a===k.object){let t=Y.objectKeys(e),n=Y.objectKeys(s).filter(o=>t.indexOf(o)!==-1),i={...s,...e};for(let o of n){let l=Gs(s[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(r===k.array&&a===k.array){if(s.length!==e.length)return{valid:!1};let t=[];for(let n=0;n<s.length;n++){let i=s[n],o=e[n],l=Gs(i,o);if(!l.valid)return{valid:!1};t.push(l.data)}return{valid:!0,data:t}}else return r===k.date&&a===k.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}var zt=class extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e),t=(n,i)=>{if(Ur(n)||Ur(i))return Z;let o=Gs(n.value,i.value);return o.valid?((Vr(n)||Vr(i))&&r.dirty(),{status:r.value,value:o.data}):($(a,{code:w.invalid_intersection_types}),Z)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,i])=>t(n,i)):t(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}};zt.create=(s,e,r)=>new zt({left:s,right:e,typeName:O.ZodIntersection,...X(r)});var it=class s extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==k.array)return $(a,{code:w.invalid_type,expected:k.array,received:a.parsedType}),Z;if(a.data.length<this._def.items.length)return $(a,{code:w.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Z;!this._def.rest&&a.data.length>this._def.items.length&&($(a,{code:w.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let n=[...a.data].map((i,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new Be(a,i,a.path,o)):null}).filter(i=>!!i);return a.common.async?Promise.all(n).then(i=>Re.mergeArray(r,i)):Re.mergeArray(r,n)}get items(){return this._def.items}rest(e){return new s({...this._def,rest:e})}};it.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new it({items:s,typeName:O.ZodTuple,rest:null,...X(e)})};var zr=class s extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==k.object)return $(a,{code:w.invalid_type,expected:k.object,received:a.parsedType}),Z;let t=[],n=this._def.keyType,i=this._def.valueType;for(let o in a.data)t.push({key:n._parse(new Be(a,o,a.path,o)),value:i._parse(new Be(a,a.data[o],a.path,o)),alwaysSet:o in a.data});return a.common.async?Re.mergeObjectAsync(r,t):Re.mergeObjectSync(r,t)}get element(){return this._def.valueType}static create(e,r,a){return r instanceof Q?new s({keyType:e,valueType:r,typeName:O.ZodRecord,...X(a)}):new s({keyType:Rt.create(),valueType:e,typeName:O.ZodRecord,...X(r)})}},fr=class extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==k.map)return $(a,{code:w.invalid_type,expected:k.map,received:a.parsedType}),Z;let t=this._def.keyType,n=this._def.valueType,i=[...a.data.entries()].map(([o,l],u)=>({key:t._parse(new Be(a,o,a.path,[u,"key"])),value:n._parse(new Be(a,l,a.path,[u,"value"]))}));if(a.common.async){let o=new Map;return Promise.resolve().then(async()=>{for(let l of i){let u=await l.key,f=await l.value;if(u.status==="aborted"||f.status==="aborted")return Z;(u.status==="dirty"||f.status==="dirty")&&r.dirty(),o.set(u.value,f.value)}return{status:r.value,value:o}})}else{let o=new Map;for(let l of i){let u=l.key,f=l.value;if(u.status==="aborted"||f.status==="aborted")return Z;(u.status==="dirty"||f.status==="dirty")&&r.dirty(),o.set(u.value,f.value)}return{status:r.value,value:o}}}};fr.create=(s,e,r)=>new fr({valueType:e,keyType:s,typeName:O.ZodMap,...X(r)});var pr=class s extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==k.set)return $(a,{code:w.invalid_type,expected:k.set,received:a.parsedType}),Z;let t=this._def;t.minSize!==null&&a.data.size<t.minSize.value&&($(a,{code:w.too_small,minimum:t.minSize.value,type:"set",inclusive:!0,exact:!1,message:t.minSize.message}),r.dirty()),t.maxSize!==null&&a.data.size>t.maxSize.value&&($(a,{code:w.too_big,maximum:t.maxSize.value,type:"set",inclusive:!0,exact:!1,message:t.maxSize.message}),r.dirty());let n=this._def.valueType;function i(l){let u=new Set;for(let f of l){if(f.status==="aborted")return Z;f.status==="dirty"&&r.dirty(),u.add(f.value)}return{status:r.value,value:u}}let o=[...a.data.values()].map((l,u)=>n._parse(new Be(a,l,a.path,u)));return a.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,r){return new s({...this._def,minSize:{value:e,message:V.toString(r)}})}max(e,r){return new s({...this._def,maxSize:{value:e,message:V.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};pr.create=(s,e)=>new pr({valueType:s,minSize:null,maxSize:null,typeName:O.ZodSet,...X(e)});var Br=class s extends Q{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==k.function)return $(r,{code:w.invalid_type,expected:k.function,received:r.parsedType}),Z;function a(o,l){return wr({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,or(),mt].filter(u=>!!u),issueData:{code:w.invalid_arguments,argumentsError:l}})}function t(o,l){return wr({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,or(),mt].filter(u=>!!u),issueData:{code:w.invalid_return_type,returnTypeError:l}})}let n={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof Pt){let o=this;return we(async function(...l){let u=new ke([]),f=await o._def.args.parseAsync(l,n).catch(d=>{throw u.addIssue(a(l,d)),u}),h=await Reflect.apply(i,this,f);return await o._def.returns._def.type.parseAsync(h,n).catch(d=>{throw u.addIssue(t(h,d)),u})})}else{let o=this;return we(function(...l){let u=o._def.args.safeParse(l,n);if(!u.success)throw new ke([a(l,u.error)]);let f=Reflect.apply(i,this,u.data),h=o._def.returns.safeParse(f,n);if(!h.success)throw new ke([t(f,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new s({...this._def,args:it.create(e).rest(gt.create())})}returns(e){return new s({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,a){return new s({args:e||it.create([]).rest(gt.create()),returns:r||gt.create(),typeName:O.ZodFunction,...X(a)})}},Bt=class extends Q{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};Bt.create=(s,e)=>new Bt({getter:s,typeName:O.ZodLazy,...X(e)});var Zt=class extends Q{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return $(r,{received:r.data,code:w.invalid_literal,expected:this._def.value}),Z}return{status:"valid",value:e.data}}get value(){return this._def.value}};Zt.create=(s,e)=>new Zt({value:s,typeName:O.ZodLiteral,...X(e)});function Rn(s,e){return new Gt({values:s,typeName:O.ZodEnum,...X(e)})}var Gt=class s extends Q{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),a=this._def.values;return $(r,{expected:Y.joinValues(a),received:r.parsedType,code:w.invalid_type}),Z}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),a=this._def.values;return $(r,{received:r.data,code:w.invalid_enum_value,options:a}),Z}return we(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return s.create(e,{...this._def,...r})}exclude(e,r=this._def){return s.create(this.options.filter(a=>!e.includes(a)),{...this._def,...r})}};Gt.create=Rn;var Xt=class extends Q{_parse(e){let r=Y.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==k.string&&a.parsedType!==k.number){let t=Y.objectValues(r);return $(a,{expected:Y.joinValues(t),received:a.parsedType,code:w.invalid_type}),Z}if(this._cache||(this._cache=new Set(Y.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let t=Y.objectValues(r);return $(a,{received:a.data,code:w.invalid_enum_value,options:t}),Z}return we(e.data)}get enum(){return this._def.values}};Xt.create=(s,e)=>new Xt({values:s,typeName:O.ZodNativeEnum,...X(e)});var Pt=class extends Q{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==k.promise&&r.common.async===!1)return $(r,{code:w.invalid_type,expected:k.promise,received:r.parsedType}),Z;let a=r.parsedType===k.promise?r.data:Promise.resolve(r.data);return we(a.then(t=>this._def.type.parseAsync(t,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Pt.create=(s,e)=>new Pt({type:s,typeName:O.ZodPromise,...X(e)});var Ze=class extends Q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===O.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:a}=this._processInputParams(e),t=this._def.effect||null,n={addIssue:i=>{$(a,i),i.fatal?r.abort():r.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),t.type==="preprocess"){let i=t.transform(a.data,n);if(a.common.async)return Promise.resolve(i).then(async o=>{if(r.value==="aborted")return Z;let l=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return l.status==="aborted"?Z:l.status==="dirty"?Lt(l.value):r.value==="dirty"?Lt(l.value):l});{if(r.value==="aborted")return Z;let o=this._def.schema._parseSync({data:i,path:a.path,parent:a});return o.status==="aborted"?Z:o.status==="dirty"?Lt(o.value):r.value==="dirty"?Lt(o.value):o}}if(t.type==="refinement"){let i=o=>{let l=t.refinement(o,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){let o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?Z:(o.status==="dirty"&&r.dirty(),i(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?Z:(o.status==="dirty"&&r.dirty(),i(o.value).then(()=>({status:r.value,value:o.value}))))}if(t.type==="transform")if(a.common.async===!1){let i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!xt(i))return Z;let o=t.transform(i.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>xt(i)?Promise.resolve(t.transform(i.value,n)).then(o=>({status:r.value,value:o})):Z);Y.assertNever(t)}};Ze.create=(s,e,r)=>new Ze({schema:s,typeName:O.ZodEffects,effect:e,...X(r)});Ze.createWithPreprocess=(s,e,r)=>new Ze({schema:e,effect:{type:"preprocess",transform:s},typeName:O.ZodEffects,...X(r)});var ze=class extends Q{_parse(e){return this._getType(e)===k.undefined?we(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ze.create=(s,e)=>new ze({innerType:s,typeName:O.ZodOptional,...X(e)});var ot=class extends Q{_parse(e){return this._getType(e)===k.null?we(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ot.create=(s,e)=>new ot({innerType:s,typeName:O.ZodNullable,...X(e)});var Wt=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a=r.data;return r.parsedType===k.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};Wt.create=(s,e)=>new Wt({innerType:s,typeName:O.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...X(e)});var Qt=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a={...r,common:{...r.common,issues:[]}},t=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return cr(t)?t.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ke(a.common.issues)},input:a.data})})):{status:"valid",value:t.status==="valid"?t.value:this._def.catchValue({get error(){return new ke(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}};Qt.create=(s,e)=>new Qt({innerType:s,typeName:O.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...X(e)});var hr=class extends Q{_parse(e){if(this._getType(e)!==k.nan){let a=this._getOrReturnCtx(e);return $(a,{code:w.invalid_type,expected:k.nan,received:a.parsedType}),Z}return{status:"valid",value:e.data}}};hr.create=s=>new hr({typeName:O.ZodNaN,...X(s)});var yu=Symbol("zod_brand"),Or=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}},Ir=class s extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?Z:n.status==="dirty"?(r.dirty(),Lt(n.value)):this._def.out._parseAsync({data:n.value,path:a.path,parent:a})})();{let t=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?Z:t.status==="dirty"?(r.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:a.path,parent:a})}}static create(e,r){return new s({in:e,out:r,typeName:O.ZodPipeline})}},Kt=class extends Q{_parse(e){let r=this._def.innerType._parse(e),a=t=>(xt(t)&&(t.value=Object.freeze(t.value)),t);return cr(r)?r.then(t=>a(t)):a(r)}unwrap(){return this._def.innerType}};Kt.create=(s,e)=>new Kt({innerType:s,typeName:O.ZodReadonly,...X(e)});function En(s,e){let r=typeof s=="function"?s(e):typeof s=="string"?{message:s}:s;return typeof r=="string"?{message:r}:r}function Tn(s,e={},r){return s?Tt.create().superRefine((a,t)=>{let n=s(a);if(n instanceof Promise)return n.then(i=>{if(!i){let o=En(e,a),l=o.fatal??r??!0;t.addIssue({code:"custom",...o,fatal:l})}});if(!n){let i=En(e,a),o=i.fatal??r??!0;t.addIssue({code:"custom",...i,fatal:o})}}):Tt.create()}var Eu={object:Le.lazycreate},O;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(O||(O={}));var bu=(s,e={message:`Input not instance of ${s.name}`})=>Tn(r=>r instanceof s,e),Pn=Rt.create,wn=jt.create,Su=hr.create,xu=Ft.create,On=Mt.create,Ru=qt.create,Tu=ur.create,Pu=Ut.create,wu=Vt.create,Ou=Tt.create,Iu=gt.create,Nu=Je.create,Au=dr.create,Cu=_t.create,Du=Le.create,$u=Le.strictCreate,ku=Ht.create,Lu=Hr.create,ju=zt.create,Fu=it.create,Mu=zr.create,qu=fr.create,Uu=pr.create,Vu=Br.create,Hu=Bt.create,zu=Zt.create,Bu=Gt.create,Zu=Xt.create,Gu=Pt.create,Xu=Ze.create,Wu=ze.create,Qu=ot.create,Ku=Ze.createWithPreprocess,Ju=Ir.create,Yu=()=>Pn().optional(),ed=()=>wn().optional(),td=()=>On().optional(),rd={string:s=>Rt.create({...s,coerce:!0}),number:s=>jt.create({...s,coerce:!0}),boolean:s=>Mt.create({...s,coerce:!0}),bigint:s=>Ft.create({...s,coerce:!0}),date:s=>qt.create({...s,coerce:!0})};var sd=Z;var Nr="2025-06-18";var Zr=[Nr,"2025-03-26","2024-11-05","2024-10-07"],Gr="2.0",In=c.union([c.string(),c.number().int()]),Nn=c.string(),ad=c.object({progressToken:c.optional(In)}).passthrough(),Ge=c.object({_meta:c.optional(ad)}).passthrough(),je=c.object({method:c.string(),params:c.optional(Ge)}),Ar=c.object({_meta:c.optional(c.object({}).passthrough())}).passthrough(),ct=c.object({method:c.string(),params:c.optional(Ar)}),Xe=c.object({_meta:c.optional(c.object({}).passthrough())}).passthrough(),Xr=c.union([c.string(),c.number().int()]),An=c.object({jsonrpc:c.literal(Gr),id:Xr}).merge(je).strict(),Cn=s=>An.safeParse(s).success,Dn=c.object({jsonrpc:c.literal(Gr)}).merge(ct).strict(),$n=s=>Dn.safeParse(s).success,kn=c.object({jsonrpc:c.literal(Gr),id:Xr,result:Xe}).strict(),Xs=s=>kn.safeParse(s).success,Ce;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError"})(Ce||(Ce={}));var Ln=c.object({jsonrpc:c.literal(Gr),id:Xr,error:c.object({code:c.number().int(),message:c.string(),data:c.optional(c.unknown())})}).strict(),jn=s=>Ln.safeParse(s).success,Fn=c.union([An,Dn,kn,Ln]),yt=Xe.strict(),Wr=ct.extend({method:c.literal("notifications/cancelled"),params:Ar.extend({requestId:Xr,reason:c.string().optional()})}),nd=c.object({src:c.string(),mimeType:c.optional(c.string()),sizes:c.optional(c.array(c.string()))}).passthrough(),Cr=c.object({icons:c.array(nd).optional()}).passthrough(),Dr=c.object({name:c.string(),title:c.optional(c.string())}).passthrough(),Mn=Dr.extend({version:c.string(),websiteUrl:c.optional(c.string())}).merge(Cr),id=c.object({experimental:c.optional(c.object({}).passthrough()),sampling:c.optional(c.object({}).passthrough()),elicitation:c.optional(c.object({}).passthrough()),roots:c.optional(c.object({listChanged:c.optional(c.boolean())}).passthrough())}).passthrough(),Ws=je.extend({method:c.literal("initialize"),params:Ge.extend({protocolVersion:c.string(),capabilities:id,clientInfo:Mn})});var od=c.object({experimental:c.optional(c.object({}).passthrough()),logging:c.optional(c.object({}).passthrough()),completions:c.optional(c.object({}).passthrough()),prompts:c.optional(c.object({listChanged:c.optional(c.boolean())}).passthrough()),resources:c.optional(c.object({subscribe:c.optional(c.boolean()),listChanged:c.optional(c.boolean())}).passthrough()),tools:c.optional(c.object({listChanged:c.optional(c.boolean())}).passthrough())}).passthrough(),Qs=Xe.extend({protocolVersion:c.string(),capabilities:od,serverInfo:Mn,instructions:c.optional(c.string())}),Ks=ct.extend({method:c.literal("notifications/initialized")});var Qr=je.extend({method:c.literal("ping")}),cd=c.object({progress:c.number(),total:c.optional(c.number()),message:c.optional(c.string())}).passthrough(),Kr=ct.extend({method:c.literal("notifications/progress"),params:Ar.merge(cd).extend({progressToken:In})}),Jr=je.extend({params:Ge.extend({cursor:c.optional(Nn)}).optional()}),Yr=Xe.extend({nextCursor:c.optional(Nn)}),qn=c.object({uri:c.string(),mimeType:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}).passthrough(),Un=qn.extend({text:c.string()}),Js=c.string().refine(s=>{try{return atob(s),!0}catch{return!1}},{message:"Invalid Base64 string"}),Vn=qn.extend({blob:Js}),Hn=Dr.extend({uri:c.string(),description:c.optional(c.string()),mimeType:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}).merge(Cr),ld=Dr.extend({uriTemplate:c.string(),description:c.optional(c.string()),mimeType:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}).merge(Cr),ud=Jr.extend({method:c.literal("resources/list")}),Ys=Yr.extend({resources:c.array(Hn)}),dd=Jr.extend({method:c.literal("resources/templates/list")}),ea=Yr.extend({resourceTemplates:c.array(ld)}),fd=je.extend({method:c.literal("resources/read"),params:Ge.extend({uri:c.string()})}),ta=Xe.extend({contents:c.array(c.union([Un,Vn]))}),pd=ct.extend({method:c.literal("notifications/resources/list_changed")}),hd=je.extend({method:c.literal("resources/subscribe"),params:Ge.extend({uri:c.string()})}),md=je.extend({method:c.literal("resources/unsubscribe"),params:Ge.extend({uri:c.string()})}),vd=ct.extend({method:c.literal("notifications/resources/updated"),params:Ar.extend({uri:c.string()})}),gd=c.object({name:c.string(),description:c.optional(c.string()),required:c.optional(c.boolean())}).passthrough(),_d=Dr.extend({description:c.optional(c.string()),arguments:c.optional(c.array(gd)),_meta:c.optional(c.object({}).passthrough())}).merge(Cr),yd=Jr.extend({method:c.literal("prompts/list")}),ra=Yr.extend({prompts:c.array(_d)}),Ed=je.extend({method:c.literal("prompts/get"),params:Ge.extend({name:c.string(),arguments:c.optional(c.record(c.string()))})}),sa=c.object({type:c.literal("text"),text:c.string(),_meta:c.optional(c.object({}).passthrough())}).passthrough(),aa=c.object({type:c.literal("image"),data:Js,mimeType:c.string(),_meta:c.optional(c.object({}).passthrough())}).passthrough(),na=c.object({type:c.literal("audio"),data:Js,mimeType:c.string(),_meta:c.optional(c.object({}).passthrough())}).passthrough(),bd=c.object({type:c.literal("resource"),resource:c.union([Un,Vn]),_meta:c.optional(c.object({}).passthrough())}).passthrough(),Sd=Hn.extend({type:c.literal("resource_link")}),zn=c.union([sa,aa,na,Sd,bd]),xd=c.object({role:c.enum(["user","assistant"]),content:zn}).passthrough(),ia=Xe.extend({description:c.optional(c.string()),messages:c.array(xd)}),Rd=ct.extend({method:c.literal("notifications/prompts/list_changed")}),Td=c.object({title:c.optional(c.string()),readOnlyHint:c.optional(c.boolean()),destructiveHint:c.optional(c.boolean()),idempotentHint:c.optional(c.boolean()),openWorldHint:c.optional(c.boolean())}).passthrough(),Pd=Dr.extend({description:c.optional(c.string()),inputSchema:c.object({type:c.literal("object"),properties:c.optional(c.object({}).passthrough()),required:c.optional(c.array(c.string()))}).passthrough(),outputSchema:c.optional(c.object({type:c.literal("object"),properties:c.optional(c.object({}).passthrough()),required:c.optional(c.array(c.string()))}).passthrough()),annotations:c.optional(Td),_meta:c.optional(c.object({}).passthrough())}).merge(Cr),oa=Jr.extend({method:c.literal("tools/list")}),ca=Yr.extend({tools:c.array(Pd)}),es=Xe.extend({content:c.array(zn).default([]),structuredContent:c.object({}).passthrough().optional(),isError:c.optional(c.boolean())}),rm=es.or(Xe.extend({toolResult:c.unknown()})),la=je.extend({method:c.literal("tools/call"),params:Ge.extend({name:c.string(),arguments:c.optional(c.record(c.unknown()))})}),wd=ct.extend({method:c.literal("notifications/tools/list_changed")}),$r=c.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),ua=je.extend({method:c.literal("logging/setLevel"),params:Ge.extend({level:$r})}),Od=ct.extend({method:c.literal("notifications/message"),params:Ar.extend({level:$r,logger:c.optional(c.string()),data:c.unknown()})}),Id=c.object({name:c.string().optional()}).passthrough(),Nd=c.object({hints:c.optional(c.array(Id)),costPriority:c.optional(c.number().min(0).max(1)),speedPriority:c.optional(c.number().min(0).max(1)),intelligencePriority:c.optional(c.number().min(0).max(1))}).passthrough(),Ad=c.object({role:c.enum(["user","assistant"]),content:c.union([sa,aa,na])}).passthrough(),Cd=je.extend({method:c.literal("sampling/createMessage"),params:Ge.extend({messages:c.array(Ad),systemPrompt:c.optional(c.string()),includeContext:c.optional(c.enum(["none","thisServer","allServers"])),temperature:c.optional(c.number()),maxTokens:c.number().int(),stopSequences:c.optional(c.array(c.string())),metadata:c.optional(c.object({}).passthrough()),modelPreferences:c.optional(Nd)})}),da=Xe.extend({model:c.string(),stopReason:c.optional(c.enum(["endTurn","stopSequence","maxTokens"]).or(c.string())),role:c.enum(["user","assistant"]),content:c.discriminatedUnion("type",[sa,aa,na])}),Dd=c.object({type:c.literal("boolean"),title:c.optional(c.string()),description:c.optional(c.string()),default:c.optional(c.boolean())}).passthrough(),$d=c.object({type:c.literal("string"),title:c.optional(c.string()),description:c.optional(c.string()),minLength:c.optional(c.number()),maxLength:c.optional(c.number()),format:c.optional(c.enum(["email","uri","date","date-time"]))}).passthrough(),kd=c.object({type:c.enum(["number","integer"]),title:c.optional(c.string()),description:c.optional(c.string()),minimum:c.optional(c.number()),maximum:c.optional(c.number())}).passthrough(),Ld=c.object({type:c.literal("string"),title:c.optional(c.string()),description:c.optional(c.string()),enum:c.array(c.string()),enumNames:c.optional(c.array(c.string()))}).passthrough(),jd=c.union([Dd,$d,kd,Ld]),Fd=je.extend({method:c.literal("elicitation/create"),params:Ge.extend({message:c.string(),requestedSchema:c.object({type:c.literal("object"),properties:c.record(c.string(),jd),required:c.optional(c.array(c.string()))}).passthrough()})}),fa=Xe.extend({action:c.enum(["accept","decline","cancel"]),content:c.optional(c.record(c.string(),c.unknown()))}),Md=c.object({type:c.literal("ref/resource"),uri:c.string()}).passthrough();var qd=c.object({type:c.literal("ref/prompt"),name:c.string()}).passthrough(),Ud=je.extend({method:c.literal("completion/complete"),params:Ge.extend({ref:c.union([qd,Md]),argument:c.object({name:c.string(),value:c.string()}).passthrough(),context:c.optional(c.object({arguments:c.optional(c.record(c.string(),c.string()))}))})}),pa=Xe.extend({completion:c.object({values:c.array(c.string()).max(100),total:c.optional(c.number().int()),hasMore:c.optional(c.boolean())}).passthrough()}),Vd=c.object({uri:c.string().startsWith("file://"),name:c.optional(c.string()),_meta:c.optional(c.object({}).passthrough())}).passthrough(),Hd=je.extend({method:c.literal("roots/list")}),ha=Xe.extend({roots:c.array(Vd)}),zd=ct.extend({method:c.literal("notifications/roots/list_changed")}),sm=c.union([Qr,Ws,Ud,ua,Ed,yd,ud,dd,fd,hd,md,la,oa]),am=c.union([Wr,Kr,Ks,zd]),nm=c.union([yt,da,fa,ha]),im=c.union([Qr,Cd,Fd,Hd]),om=c.union([Wr,Kr,Od,vd,pd,wd,Rd]),cm=c.union([yt,Qs,pa,ia,ra,Ys,ea,ta,es,ca]),Oe=class extends Error{constructor(e,r,a){super(`MCP error ${e}: ${r}`),this.code=e,this.data=a,this.name="McpError"}};var Bd=6e4,mr=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(Wr,r=>{let a=this._requestHandlerAbortControllers.get(r.params.requestId);a?.abort(r.params.reason)}),this.setNotificationHandler(Kr,r=>{this._onprogress(r)}),this.setRequestHandler(Qr,r=>({}))}_setupTimeout(e,r,a,t,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(t,r),startTime:Date.now(),timeout:r,maxTotalTimeout:a,resetTimeoutOnProgress:n,onTimeout:t})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let a=Date.now()-r.startTime;if(r.maxTotalTimeout&&a>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),new Oe(Ce.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:a});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,a,t;this._transport=e;let n=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{n?.(),this._onclose()};let i=(a=this.transport)===null||a===void 0?void 0:a.onerror;this._transport.onerror=l=>{i?.(l),this._onerror(l)};let o=(t=this._transport)===null||t===void 0?void 0:t.onmessage;this._transport.onmessage=(l,u)=>{o?.(l,u),Xs(l)||jn(l)?this._onresponse(l):Cn(l)?this._onrequest(l,u):$n(l)?this._onnotification(l):this._onerror(new Error(`Unknown message type: ${JSON.stringify(l)}`))},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let a=new Oe(Ce.ConnectionClosed,"Connection closed");for(let t of r.values())t(a)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let a=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;a!==void 0&&Promise.resolve().then(()=>a(e)).catch(t=>this._onerror(new Error(`Uncaught error in notification handler: ${t}`)))}_onrequest(e,r){var a,t;let n=(a=this._requestHandlers.get(e.method))!==null&&a!==void 0?a:this.fallbackRequestHandler,i=this._transport;if(n===void 0){i?.send({jsonrpc:"2.0",id:e.id,error:{code:Ce.MethodNotFound,message:"Method not found"}}).catch(u=>this._onerror(new Error(`Failed to send an error response: ${u}`)));return}let o=new AbortController;this._requestHandlerAbortControllers.set(e.id,o);let l={signal:o.signal,sessionId:i?.sessionId,_meta:(t=e.params)===null||t===void 0?void 0:t._meta,sendNotification:u=>this.notification(u,{relatedRequestId:e.id}),sendRequest:(u,f,h)=>this.request(u,f,{...h,relatedRequestId:e.id}),authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo};Promise.resolve().then(()=>n(e,l)).then(u=>{if(!o.signal.aborted)return i?.send({result:u,jsonrpc:"2.0",id:e.id})},u=>{var f;if(!o.signal.aborted)return i?.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(u.code)?u.code:Ce.InternalError,message:(f=u.message)!==null&&f!==void 0?f:"Internal error"}})}).catch(u=>this._onerror(new Error(`Failed to send response: ${u}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...a}=e.params,t=Number(r),n=this._progressHandlers.get(t);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(t),o=this._timeoutInfo.get(t);if(o&&i&&o.resetTimeoutOnProgress)try{this._resetTimeout(t)}catch(l){i(l);return}n(a)}_onresponse(e){let r=Number(e.id),a=this._responseHandlers.get(r);if(a===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(r),this._progressHandlers.delete(r),this._cleanupTimeout(r),Xs(e))a(e);else{let t=new Oe(e.error.code,e.error.message,e.error.data);a(t)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,r,a){let{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}=a??{};return new Promise((o,l)=>{var u,f,h,g,d,m;if(!this._transport){l(new Error("Not connected"));return}((u=this._options)===null||u===void 0?void 0:u.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(f=a?.signal)===null||f===void 0||f.throwIfAborted();let _=this._requestMessageId++,v={...e,jsonrpc:"2.0",id:_};a?.onprogress&&(this._progressHandlers.set(_,a.onprogress),v.params={...e.params,_meta:{...((h=e.params)===null||h===void 0?void 0:h._meta)||{},progressToken:_}});let b=P=>{var N;this._responseHandlers.delete(_),this._progressHandlers.delete(_),this._cleanupTimeout(_),(N=this._transport)===null||N===void 0||N.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:_,reason:String(P)}},{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}).catch(A=>this._onerror(new Error(`Failed to send cancellation: ${A}`))),l(P)};this._responseHandlers.set(_,P=>{var N;if(!(!((N=a?.signal)===null||N===void 0)&&N.aborted)){if(P instanceof Error)return l(P);try{let A=r.parse(P.result);o(A)}catch(A){l(A)}}}),(g=a?.signal)===null||g===void 0||g.addEventListener("abort",()=>{var P;b((P=a?.signal)===null||P===void 0?void 0:P.reason)});let T=(d=a?.timeout)!==null&&d!==void 0?d:Bd,R=()=>b(new Oe(Ce.RequestTimeout,"Request timed out",{timeout:T}));this._setupTimeout(_,T,a?.maxTotalTimeout,R,(m=a?.resetTimeoutOnProgress)!==null&&m!==void 0?m:!1),this._transport.send(v,{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}).catch(P=>{this._cleanupTimeout(_),l(P)})})}async notification(e,r){var a,t;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((t=(a=this._options)===null||a===void 0?void 0:a.debouncedNotificationMethods)!==null&&t!==void 0?t:[]).includes(e.method)&&!e.params&&!r?.relatedRequestId){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var l;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let u={...e,jsonrpc:"2.0"};(l=this._transport)===null||l===void 0||l.send(u,r).catch(f=>this._onerror(f))});return}let o={...e,jsonrpc:"2.0"};await this._transport.send(o,r)}setRequestHandler(e,r){let a=e.shape.method.value;this.assertRequestHandlerCapability(a),this._requestHandlers.set(a,(t,n)=>Promise.resolve(r(e.parse(t),n)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,a=>Promise.resolve(r(e.parse(a))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function ts(s,e){return Object.entries(e).reduce((r,[a,t])=>(t&&typeof t=="object"?r[a]=r[a]?{...r[a],...t}:t:r[a]=t,r),{...s})}var Zo=zs(Ma(),1),Es=class extends mr{constructor(e,r){var a;super(r),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map($r.options.map((t,n)=>[t,n])),this.isMessageIgnored=(t,n)=>{let i=this._loggingLevels.get(n);return i?this.LOG_LEVEL_SEVERITY.get(t)<this.LOG_LEVEL_SEVERITY.get(i):!1},this._capabilities=(a=r?.capabilities)!==null&&a!==void 0?a:{},this._instructions=r?.instructions,this.setRequestHandler(Ws,t=>this._oninitialize(t)),this.setNotificationHandler(Ks,()=>{var t;return(t=this.oninitialized)===null||t===void 0?void 0:t.call(this)}),this._capabilities.logging&&this.setRequestHandler(ua,async(t,n)=>{var i;let o=n.sessionId||((i=n.requestInfo)===null||i===void 0?void 0:i.headers["mcp-session-id"])||void 0,{level:l}=t.params,u=$r.safeParse(l);return u.success&&this._loggingLevels.set(o,u.data),{}})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=ts(this._capabilities,e)}assertCapabilityForMethod(e){var r,a,t;switch(e){case"sampling/createMessage":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((a=this._clientCapabilities)===null||a===void 0)&&a.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"ping":case"initialize":break}}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Zr.includes(r)?r:Nr,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},yt)}async createMessage(e,r){return this.request({method:"sampling/createMessage",params:e},da,r)}async elicitInput(e,r){let a=await this.request({method:"elicitation/create",params:e},fa,r);if(a.action==="accept"&&a.content)try{let t=new Zo.default,n=t.compile(e.requestedSchema);if(!n(a.content))throw new Oe(Ce.InvalidParams,`Elicitation response content does not match requested schema: ${t.errorsText(n.errors)}`)}catch(t){throw t instanceof Oe?t:new Oe(Ce.InternalError,`Error validating elicitation response: ${t}`)}return a}async listRoots(e,r){return this.request({method:"roots/list",params:e},ha,r)}async sendLoggingMessage(e,r){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,r))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};import Go from"node:process";var vr=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),Tp(r)}clear(){this._buffer=void 0}};function Tp(s){return Fn.parse(JSON.parse(s))}function bs(s){return JSON.stringify(s)+`
`}var Ss=class{constructor(e=Go.stdin,r=Go.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new vr,this._started=!1,this._ondata=a=>{this._readBuffer.append(a),this.processReadBuffer()},this._onerror=a=>{var t;(t=this.onerror)===null||t===void 0||t.call(this,a)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(var e,r;;)try{let a=this._readBuffer.readMessage();if(a===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,a)}catch(a){(r=this.onerror)===null||r===void 0||r.call(this,a)}}async close(){var e;this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),(e=this.onclose)===null||e===void 0||e.call(this)}send(e){return new Promise(r=>{let a=bs(e);this._stdout.write(a)?r():this._stdout.once("drain",r)})}};var Wo=Symbol("Let zodToJsonSchema decide on which parser to use");var Xo={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Qo=s=>typeof s=="string"?{...Xo,name:s}:{...Xo,...s};var Ko=s=>{let e=Qo(s),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([a,t])=>[t._def,{def:t._def,path:[...e.basePath,e.definitionPath,a],jsonSchema:void 0}]))}};function qa(s,e,r,a){a?.errorMessages&&r&&(s.errorMessage={...s.errorMessage,[e]:r})}function ee(s,e,r,a,t){s[e]=r,qa(s,e,a,t)}var xs=(s,e)=>{let r=0;for(;r<s.length&&r<e.length&&s[r]===e[r];r++);return[(s.length-r).toString(),...e.slice(r)].join("/")};function fe(s){if(s.target!=="openAi")return{};let e=[...s.basePath,s.definitionPath,s.openAiAnyTypeName];return s.flags.hasReferencedOpenAiAnyType=!0,{$ref:s.$refStrategy==="relative"?xs(e,s.currentPath):e.join("/")}}function Jo(s,e){let r={type:"array"};return s.type?._def&&s.type?._def?.typeName!==O.ZodAny&&(r.items=G(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&ee(r,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&ee(r,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(ee(r,"minItems",s.exactLength.value,s.exactLength.message,e),ee(r,"maxItems",s.exactLength.value,s.exactLength.message,e)),r}function Yo(s,e){let r={type:"integer",format:"int64"};if(!s.checks)return r;for(let a of s.checks)switch(a.kind){case"min":e.target==="jsonSchema7"?a.inclusive?ee(r,"minimum",a.value,a.message,e):ee(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),ee(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?ee(r,"maximum",a.value,a.message,e):ee(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),ee(r,"maximum",a.value,a.message,e));break;case"multipleOf":ee(r,"multipleOf",a.value,a.message,e);break}return r}function ec(){return{type:"boolean"}}function Rs(s,e){return G(s.type._def,e)}var tc=(s,e)=>G(s.innerType._def,e);function Ua(s,e,r){let a=r??e.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((t,n)=>Ua(s,e,t))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Pp(s,e)}}var Pp=(s,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let a of s.checks)switch(a.kind){case"min":ee(r,"minimum",a.value,a.message,e);break;case"max":ee(r,"maximum",a.value,a.message,e);break}return r};function rc(s,e){return{...G(s.innerType._def,e),default:s.defaultValue()}}function sc(s,e){return e.effectStrategy==="input"?G(s.schema._def,e):fe(e)}function ac(s){return{type:"string",enum:Array.from(s.values)}}var wp=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function nc(s,e){let r=[G(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),G(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n),a=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,t=[];return r.forEach(n=>{if(wp(n))t.push(...n.allOf),n.unevaluatedProperties===void 0&&(a=void 0);else{let i=n;if("additionalProperties"in n&&n.additionalProperties===!1){let{additionalProperties:o,...l}=n;i=l}else a=void 0;t.push(i)}}),t.length?{allOf:t,...a}:void 0}function ic(s,e){let r=typeof s.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[s.value]}:{type:r==="bigint"?"integer":r,const:s.value}}var Va,Ye={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Va===void 0&&(Va=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Va),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Ts(s,e){let r={type:"string"};if(s.checks)for(let a of s.checks)switch(a.kind){case"min":ee(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e);break;case"max":ee(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":et(r,"email",a.message,e);break;case"format:idn-email":et(r,"idn-email",a.message,e);break;case"pattern:zod":De(r,Ye.email,a.message,e);break}break;case"url":et(r,"uri",a.message,e);break;case"uuid":et(r,"uuid",a.message,e);break;case"regex":De(r,a.regex,a.message,e);break;case"cuid":De(r,Ye.cuid,a.message,e);break;case"cuid2":De(r,Ye.cuid2,a.message,e);break;case"startsWith":De(r,RegExp(`^${Ha(a.value,e)}`),a.message,e);break;case"endsWith":De(r,RegExp(`${Ha(a.value,e)}$`),a.message,e);break;case"datetime":et(r,"date-time",a.message,e);break;case"date":et(r,"date",a.message,e);break;case"time":et(r,"time",a.message,e);break;case"duration":et(r,"duration",a.message,e);break;case"length":ee(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e),ee(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"includes":{De(r,RegExp(Ha(a.value,e)),a.message,e);break}case"ip":{a.version!=="v6"&&et(r,"ipv4",a.message,e),a.version!=="v4"&&et(r,"ipv6",a.message,e);break}case"base64url":De(r,Ye.base64url,a.message,e);break;case"jwt":De(r,Ye.jwt,a.message,e);break;case"cidr":{a.version!=="v6"&&De(r,Ye.ipv4Cidr,a.message,e),a.version!=="v4"&&De(r,Ye.ipv6Cidr,a.message,e);break}case"emoji":De(r,Ye.emoji(),a.message,e);break;case"ulid":{De(r,Ye.ulid,a.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{et(r,"binary",a.message,e);break}case"contentEncoding:base64":{ee(r,"contentEncoding","base64",a.message,e);break}case"pattern:zod":{De(r,Ye.base64,a.message,e);break}}break}case"nanoid":De(r,Ye.nanoid,a.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function Ha(s,e){return e.patternStrategy==="escape"?Ip(s):s}var Op=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Ip(s){let e="";for(let r=0;r<s.length;r++)Op.has(s[r])||(e+="\\"),e+=s[r];return e}function et(s,e,r,a){s.format||s.anyOf?.some(t=>t.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&a.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...r&&a.errorMessages&&{errorMessage:{format:r}}})):ee(s,"format",e,r,a)}function De(s,e,r,a){s.pattern||s.allOf?.some(t=>t.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&a.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:oc(e,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):ee(s,"pattern",oc(e,a),r,a)}function oc(s,e){if(!e.applyRegexFlags||!s.flags)return s.source;let r={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},a=r.i?s.source.toLowerCase():s.source,t="",n=!1,i=!1,o=!1;for(let l=0;l<a.length;l++){if(n){t+=a[l],n=!1;continue}if(r.i){if(i){if(a[l].match(/[a-z]/)){o?(t+=a[l],t+=`${a[l-2]}-${a[l]}`.toUpperCase(),o=!1):a[l+1]==="-"&&a[l+2]?.match(/[a-z]/)?(t+=a[l],o=!0):t+=`${a[l]}${a[l].toUpperCase()}`;continue}}else if(a[l].match(/[a-z]/)){t+=`[${a[l]}${a[l].toUpperCase()}]`;continue}}if(r.m){if(a[l]==="^"){t+=`(^|(?<=[\r
]))`;continue}else if(a[l]==="$"){t+=`($|(?=[\r
]))`;continue}}if(r.s&&a[l]==="."){t+=i?`${a[l]}\r
`:`[${a[l]}\r
]`;continue}t+=a[l],a[l]==="\\"?n=!0:i&&a[l]==="]"?i=!1:!i&&a[l]==="["&&(i=!0)}try{new RegExp(t)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return t}function Ps(s,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&s.keyType?._def.typeName===O.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((a,t)=>({...a,[t]:G(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",t]})??fe(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:G(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(s.keyType?._def.typeName===O.ZodString&&s.keyType._def.checks?.length){let{type:a,...t}=Ts(s.keyType._def,e);return{...r,propertyNames:t}}else{if(s.keyType?._def.typeName===O.ZodEnum)return{...r,propertyNames:{enum:s.keyType._def.values}};if(s.keyType?._def.typeName===O.ZodBranded&&s.keyType._def.type._def.typeName===O.ZodString&&s.keyType._def.type._def.checks?.length){let{type:a,...t}=Rs(s.keyType._def,e);return{...r,propertyNames:t}}}return r}function cc(s,e){if(e.mapStrategy==="record")return Ps(s,e);let r=G(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||fe(e),a=G(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||fe(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,a],minItems:2,maxItems:2}}}function lc(s){let e=s.values,a=Object.keys(s.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),t=Array.from(new Set(a.map(n=>typeof n)));return{type:t.length===1?t[0]==="string"?"string":"number":["string","number"],enum:a}}function uc(s){return s.target==="openAi"?void 0:{not:fe({...s,currentPath:[...s.currentPath,"not"]})}}function dc(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Lr={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function pc(s,e){if(e.target==="openApi3")return fc(s,e);let r=s.options instanceof Map?Array.from(s.options.values()):s.options;if(r.every(a=>a._def.typeName in Lr&&(!a._def.checks||!a._def.checks.length))){let a=r.reduce((t,n)=>{let i=Lr[n._def.typeName];return i&&!t.includes(i)?[...t,i]:t},[]);return{type:a.length>1?a:a[0]}}else if(r.every(a=>a._def.typeName==="ZodLiteral"&&!a.description)){let a=r.reduce((t,n)=>{let i=typeof n._def.value;switch(i){case"string":case"number":case"boolean":return[...t,i];case"bigint":return[...t,"integer"];case"object":if(n._def.value===null)return[...t,"null"];case"symbol":case"undefined":case"function":default:return t}},[]);if(a.length===r.length){let t=a.filter((n,i,o)=>o.indexOf(n)===i);return{type:t.length>1?t:t[0],enum:r.reduce((n,i)=>n.includes(i._def.value)?n:[...n,i._def.value],[])}}}else if(r.every(a=>a._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((a,t)=>[...a,...t._def.values.filter(n=>!a.includes(n))],[])};return fc(s,e)}var fc=(s,e)=>{let r=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((a,t)=>G(a._def,{...e,currentPath:[...e.currentPath,"anyOf",`${t}`]})).filter(a=>!!a&&(!e.strictUnions||typeof a=="object"&&Object.keys(a).length>0));return r.length?{anyOf:r}:void 0};function hc(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:Lr[s.innerType._def.typeName],nullable:!0}:{type:[Lr[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let a=G(s.innerType._def,{...e,currentPath:[...e.currentPath]});return a&&"$ref"in a?{allOf:[a],nullable:!0}:a&&{...a,nullable:!0}}let r=G(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function mc(s,e){let r={type:"number"};if(!s.checks)return r;for(let a of s.checks)switch(a.kind){case"int":r.type="integer",qa(r,"type",a.message,e);break;case"min":e.target==="jsonSchema7"?a.inclusive?ee(r,"minimum",a.value,a.message,e):ee(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),ee(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?ee(r,"maximum",a.value,a.message,e):ee(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),ee(r,"maximum",a.value,a.message,e));break;case"multipleOf":ee(r,"multipleOf",a.value,a.message,e);break}return r}function vc(s,e){let r=e.target==="openAi",a={type:"object",properties:{}},t=[],n=s.shape();for(let o in n){let l=n[o];if(l===void 0||l._def===void 0)continue;let u=Ap(l);u&&r&&(l._def.typeName==="ZodOptional"&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),u=!1);let f=G(l._def,{...e,currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});f!==void 0&&(a.properties[o]=f,u||t.push(o))}t.length&&(a.required=t);let i=Np(s,e);return i!==void 0&&(a.additionalProperties=i),a}function Np(s,e){if(s.catchall._def.typeName!=="ZodNever")return G(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(s.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Ap(s){try{return s.isOptional()}catch{return!0}}var gc=(s,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return G(s.innerType._def,e);let r=G(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:fe(e)},r]}:fe(e)};var _c=(s,e)=>{if(e.pipeStrategy==="input")return G(s.in._def,e);if(e.pipeStrategy==="output")return G(s.out._def,e);let r=G(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),a=G(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(t=>t!==void 0)}};function yc(s,e){return G(s.type._def,e)}function Ec(s,e){let a={type:"array",uniqueItems:!0,items:G(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&ee(a,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&ee(a,"maxItems",s.maxSize.value,s.maxSize.message,e),a}function bc(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((r,a)=>G(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[]),additionalItems:G(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((r,a)=>G(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[])}}function Sc(s){return{not:fe(s)}}function xc(s){return fe(s)}var Rc=(s,e)=>G(s.innerType._def,e);var Tc=(s,e,r)=>{switch(e){case O.ZodString:return Ts(s,r);case O.ZodNumber:return mc(s,r);case O.ZodObject:return vc(s,r);case O.ZodBigInt:return Yo(s,r);case O.ZodBoolean:return ec();case O.ZodDate:return Ua(s,r);case O.ZodUndefined:return Sc(r);case O.ZodNull:return dc(r);case O.ZodArray:return Jo(s,r);case O.ZodUnion:case O.ZodDiscriminatedUnion:return pc(s,r);case O.ZodIntersection:return nc(s,r);case O.ZodTuple:return bc(s,r);case O.ZodRecord:return Ps(s,r);case O.ZodLiteral:return ic(s,r);case O.ZodEnum:return ac(s);case O.ZodNativeEnum:return lc(s);case O.ZodNullable:return hc(s,r);case O.ZodOptional:return gc(s,r);case O.ZodMap:return cc(s,r);case O.ZodSet:return Ec(s,r);case O.ZodLazy:return()=>s.getter()._def;case O.ZodPromise:return yc(s,r);case O.ZodNaN:case O.ZodNever:return uc(r);case O.ZodEffects:return sc(s,r);case O.ZodAny:return fe(r);case O.ZodUnknown:return xc(r);case O.ZodDefault:return rc(s,r);case O.ZodBranded:return Rs(s,r);case O.ZodReadonly:return Rc(s,r);case O.ZodCatch:return tc(s,r);case O.ZodPipeline:return _c(s,r);case O.ZodFunction:case O.ZodVoid:case O.ZodSymbol:return;default:return(a=>{})(e)}};function G(s,e,r=!1){let a=e.seen.get(s);if(e.override){let o=e.override?.(s,e,a,r);if(o!==Wo)return o}if(a&&!r){let o=Cp(a,e);if(o!==void 0)return o}let t={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,t);let n=Tc(s,s.typeName,e),i=typeof n=="function"?G(n(),e):n;if(i&&Dp(s,e,i),e.postProcess){let o=e.postProcess(i,s,e);return t.jsonSchema=i,o}return t.jsonSchema=i,i}var Cp=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:xs(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((r,a)=>e.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),fe(e)):e.$refStrategy==="seen"?fe(e):void 0}},Dp=(s,e,r)=>(s.description&&(r.description=s.description,e.markdownDescription&&(r.markdownDescription=s.description)),r);var za=(s,e)=>{let r=Ko(e),a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[u,f])=>({...l,[u]:G(f._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??fe(r)}),{}):void 0,t=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,n=G(s._def,t===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,t]},!1)??fe(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(n.title=i),r.flags.hasReferencedOpenAiAnyType&&(a||(a={}),a[r.openAiAnyTypeName]||(a[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let o=t===void 0?a?{...n,[r.definitionPath]:a}:n:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,t].join("/"),[r.definitionPath]:{...a,[t]:n}};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};import{basename as Ls}from"path";import Fp from"better-sqlite3";import{join as We,dirname as $p,basename as sy}from"path";import{homedir as Pc}from"os";import{existsSync as oy,mkdirSync as kp}from"fs";import{fileURLToPath as Lp}from"url";function jp(){return typeof __dirname<"u"?__dirname:$p(Lp(import.meta.url))}var ly=jp(),tt=process.env.CLAUDE_MEM_DATA_DIR||We(Pc(),".claude-mem"),Ba=process.env.CLAUDE_CONFIG_DIR||We(Pc(),".claude"),uy=We(tt,"archives"),dy=We(tt,"logs"),fy=We(tt,"trash"),py=We(tt,"backups"),wc=We(tt,"vector-db"),hy=We(tt,"settings.json"),ws=We(tt,"claude-mem.db"),my=We(Ba,"settings.json"),vy=We(Ba,"commands"),gy=We(Ba,"CLAUDE.md");function Os(s){kp(s,{recursive:!0})}var Is=class{db;constructor(e){e||(Os(tt),e=ws),this.db=new Fp(e),this.db.pragma("journal_mode = WAL"),this.ensureFTSTables()}ensureFTSTables(){try{if(this.db.prepare("SELECT name FROM sqlite_master WHERE type='table' AND name LIKE '%_fts'").all().some(a=>a.name==="observations_fts"||a.name==="session_summaries_fts"))return;console.error("[SessionSearch] Creating FTS5 tables..."),this.db.exec(`
        CREATE VIRTUAL TABLE IF NOT EXISTS observations_fts USING fts5(
          title,
          subtitle,
          narrative,
          text,
          facts,
          concepts,
          content='observations',
          content_rowid='id'
        );
      `),this.db.exec(`
        INSERT INTO observations_fts(rowid, title, subtitle, narrative, text, facts, concepts)
        SELECT id, title, subtitle, narrative, text, facts, concepts
        FROM observations;
      `),this.db.exec(`
        CREATE TRIGGER IF NOT EXISTS observations_ai AFTER INSERT ON observations BEGIN
          INSERT INTO observations_fts(rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES (new.id, new.title, new.subtitle, new.narrative, new.text, new.facts, new.concepts);
        END;

        CREATE TRIGGER IF NOT EXISTS observations_ad AFTER DELETE ON observations BEGIN
          INSERT INTO observations_fts(observations_fts, rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES('delete', old.id, old.title, old.subtitle, old.narrative, old.text, old.facts, old.concepts);
        END;

        CREATE TRIGGER IF NOT EXISTS observations_au AFTER UPDATE ON observations BEGIN
          INSERT INTO observations_fts(observations_fts, rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES('delete', old.id, old.title, old.subtitle, old.narrative, old.text, old.facts, old.concepts);
          INSERT INTO observations_fts(rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES (new.id, new.title, new.subtitle, new.narrative, new.text, new.facts, new.concepts);
        END;
      `),this.db.exec(`
        CREATE VIRTUAL TABLE IF NOT EXISTS session_summaries_fts USING fts5(
          request,
          investigated,
          learned,
          completed,
          next_steps,
          notes,
          content='session_summaries',
          content_rowid='id'
        );
      `),this.db.exec(`
        INSERT INTO session_summaries_fts(rowid, request, investigated, learned, completed, next_steps, notes)
        SELECT id, request, investigated, learned, completed, next_steps, notes
        FROM session_summaries;
      `),this.db.exec(`
        CREATE TRIGGER IF NOT EXISTS session_summaries_ai AFTER INSERT ON session_summaries BEGIN
          INSERT INTO session_summaries_fts(rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES (new.id, new.request, new.investigated, new.learned, new.completed, new.next_steps, new.notes);
        END;

        CREATE TRIGGER IF NOT EXISTS session_summaries_ad AFTER DELETE ON session_summaries BEGIN
          INSERT INTO session_summaries_fts(session_summaries_fts, rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES('delete', old.id, old.request, old.investigated, old.learned, old.completed, old.next_steps, old.notes);
        END;

        CREATE TRIGGER IF NOT EXISTS session_summaries_au AFTER UPDATE ON session_summaries BEGIN
          INSERT INTO session_summaries_fts(session_summaries_fts, rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES('delete', old.id, old.request, old.investigated, old.learned, old.completed, old.next_steps, old.notes);
          INSERT INTO session_summaries_fts(rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES (new.id, new.request, new.investigated, new.learned, new.completed, new.next_steps, new.notes);
        END;
      `),console.error("[SessionSearch] FTS5 tables created successfully")}catch(e){console.error("[SessionSearch] FTS migration error:",e.message)}}escapeFTS5(e){return`"${e.replace(/"/g,'""')}"`}buildFilterClause(e,r,a="o"){let t=[];if(e.project&&(t.push(`${a}.project = ?`),r.push(e.project)),e.type)if(Array.isArray(e.type)){let n=e.type.map(()=>"?").join(",");t.push(`${a}.type IN (${n})`),r.push(...e.type)}else t.push(`${a}.type = ?`),r.push(e.type);if(e.dateRange){let{start:n,end:i}=e.dateRange;if(n){let o=typeof n=="number"?n:new Date(n).getTime();t.push(`${a}.created_at_epoch >= ?`),r.push(o)}if(i){let o=typeof i=="number"?i:new Date(i).getTime();t.push(`${a}.created_at_epoch <= ?`),r.push(o)}}if(e.concepts){let n=Array.isArray(e.concepts)?e.concepts:[e.concepts],i=n.map(()=>`EXISTS (SELECT 1 FROM json_each(${a}.concepts) WHERE value = ?)`);i.length>0&&(t.push(`(${i.join(" OR ")})`),r.push(...n))}if(e.files){let n=Array.isArray(e.files)?e.files:[e.files],i=n.map(()=>`(
          EXISTS (SELECT 1 FROM json_each(${a}.files_read) WHERE value LIKE ?)
          OR EXISTS (SELECT 1 FROM json_each(${a}.files_modified) WHERE value LIKE ?)
        )`);i.length>0&&(t.push(`(${i.join(" OR ")})`),n.forEach(o=>{r.push(`%${o}%`,`%${o}%`)}))}return t.length>0?t.join(" AND "):""}buildOrderClause(e="relevance",r=!0,a="observations_fts"){switch(e){case"relevance":return r?`ORDER BY ${a}.rank ASC`:"ORDER BY o.created_at_epoch DESC";case"date_desc":return"ORDER BY o.created_at_epoch DESC";case"date_asc":return"ORDER BY o.created_at_epoch ASC";default:return"ORDER BY o.created_at_epoch DESC"}}searchObservations(e,r={}){let a=[],{limit:t=50,offset:n=0,orderBy:i="relevance",...o}=r,l=this.escapeFTS5(e);a.push(l);let u=this.buildFilterClause(o,a,"o"),f=u?`AND ${u}`:"",h=this.buildOrderClause(i,!0),g=`
      SELECT
        o.*,
        observations_fts.rank as rank
      FROM observations o
      JOIN observations_fts ON o.id = observations_fts.rowid
      WHERE observations_fts MATCH ?
      ${f}
      ${h}
      LIMIT ? OFFSET ?
    `;a.push(t,n);let d=this.db.prepare(g).all(...a);if(d.length>0){let m=Math.min(...d.map(b=>b.rank||0)),v=Math.max(...d.map(b=>b.rank||0))-m||1;d.forEach(b=>{b.rank!==void 0&&(b.score=1-(b.rank-m)/v)})}return d}searchSessions(e,r={}){let a=[],{limit:t=50,offset:n=0,orderBy:i="relevance",...o}=r,l=this.escapeFTS5(e);a.push(l);let u={...o};delete u.type;let f=this.buildFilterClause(u,a,"s"),m=`
      SELECT
        s.*,
        session_summaries_fts.rank as rank
      FROM session_summaries s
      JOIN session_summaries_fts ON s.id = session_summaries_fts.rowid
      WHERE session_summaries_fts MATCH ?
      ${(f?`AND ${f}`:"").replace(/files_read/g,"files_read").replace(/files_modified/g,"files_edited")}
      ${i==="relevance"?"ORDER BY session_summaries_fts.rank ASC":i==="date_asc"?"ORDER BY s.created_at_epoch ASC":"ORDER BY s.created_at_epoch DESC"}
      LIMIT ? OFFSET ?
    `;a.push(t,n);let _=this.db.prepare(m).all(...a);if(_.length>0){let v=Math.min(..._.map(R=>R.rank||0)),T=Math.max(..._.map(R=>R.rank||0))-v||1;_.forEach(R=>{R.rank!==void 0&&(R.score=1-(R.rank-v)/T)})}return _}findByConcept(e,r={}){let a=[],{limit:t=50,offset:n=0,orderBy:i="date_desc",...o}=r,l={...o,concepts:e},u=this.buildFilterClause(l,a,"o"),f=this.buildOrderClause(i,!1),h=`
      SELECT o.*
      FROM observations o
      WHERE ${u}
      ${f}
      LIMIT ? OFFSET ?
    `;return a.push(t,n),this.db.prepare(h).all(...a)}findByFile(e,r={}){let a=[],{limit:t=50,offset:n=0,orderBy:i="date_desc",...o}=r,l={...o,files:e},u=this.buildFilterClause(l,a,"o"),f=this.buildOrderClause(i,!1),h=`
      SELECT o.*
      FROM observations o
      WHERE ${u}
      ${f}
      LIMIT ? OFFSET ?
    `;a.push(t,n);let g=this.db.prepare(h).all(...a),d=[],m={...o};delete m.type;let _=[];if(m.project&&(_.push("s.project = ?"),d.push(m.project)),m.dateRange){let{start:T,end:R}=m.dateRange;if(T){let P=typeof T=="number"?T:new Date(T).getTime();_.push("s.created_at_epoch >= ?"),d.push(P)}if(R){let P=typeof R=="number"?R:new Date(R).getTime();_.push("s.created_at_epoch <= ?"),d.push(P)}}_.push(`(
      EXISTS (SELECT 1 FROM json_each(s.files_read) WHERE value LIKE ?)
      OR EXISTS (SELECT 1 FROM json_each(s.files_edited) WHERE value LIKE ?)
    )`),d.push(`%${e}%`,`%${e}%`);let v=`
      SELECT s.*
      FROM session_summaries s
      WHERE ${_.join(" AND ")}
      ORDER BY s.created_at_epoch DESC
      LIMIT ? OFFSET ?
    `;d.push(t,n);let b=this.db.prepare(v).all(...d);return{observations:g,sessions:b}}findByType(e,r={}){let a=[],{limit:t=50,offset:n=0,orderBy:i="date_desc",...o}=r,l={...o,type:e},u=this.buildFilterClause(l,a,"o"),f=this.buildOrderClause(i,!1),h=`
      SELECT o.*
      FROM observations o
      WHERE ${u}
      ${f}
      LIMIT ? OFFSET ?
    `;return a.push(t,n),this.db.prepare(h).all(...a)}searchUserPrompts(e,r={}){let a=[],{limit:t=20,offset:n=0,orderBy:i="relevance",...o}=r,l=this.escapeFTS5(e);a.push(l);let u=[];if(o.project&&(u.push("s.project = ?"),a.push(o.project)),o.dateRange){let{start:m,end:_}=o.dateRange;if(m){let v=typeof m=="number"?m:new Date(m).getTime();u.push("up.created_at_epoch >= ?"),a.push(v)}if(_){let v=typeof _=="number"?_:new Date(_).getTime();u.push("up.created_at_epoch <= ?"),a.push(v)}}let g=`
      SELECT
        up.*,
        user_prompts_fts.rank as rank
      FROM user_prompts up
      JOIN user_prompts_fts ON up.id = user_prompts_fts.rowid
      JOIN sdk_sessions s ON up.claude_session_id = s.claude_session_id
      WHERE user_prompts_fts MATCH ?
      ${u.length>0?`AND ${u.join(" AND ")}`:""}
      ${i==="relevance"?"ORDER BY user_prompts_fts.rank ASC":i==="date_asc"?"ORDER BY up.created_at_epoch ASC":"ORDER BY up.created_at_epoch DESC"}
      LIMIT ? OFFSET ?
    `;a.push(t,n);let d=this.db.prepare(g).all(...a);if(d.length>0){let m=Math.min(...d.map(b=>b.rank||0)),v=Math.max(...d.map(b=>b.rank||0))-m||1;d.forEach(b=>{b.rank!==void 0&&(b.score=1-(b.rank-m)/v)})}return d}getUserPromptsBySession(e){return this.db.prepare(`
      SELECT
        id,
        claude_session_id,
        prompt_number,
        prompt_text,
        created_at,
        created_at_epoch
      FROM user_prompts
      WHERE claude_session_id = ?
      ORDER BY prompt_number ASC
    `).all(e)}close(){this.db.close()}};import Mp from"better-sqlite3";var Za=(n=>(n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.WARN=2]="WARN",n[n.ERROR=3]="ERROR",n[n.SILENT=4]="SILENT",n))(Za||{}),Ga=class{level;useColor;constructor(){let e=process.env.CLAUDE_MEM_LOG_LEVEL?.toUpperCase()||"INFO";this.level=Za[e]??1,this.useColor=process.stdout.isTTY??!1}correlationId(e,r){return`obs-${e}-${r}`}sessionId(e){return`session-${e}`}formatData(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="object"){if(e instanceof Error)return this.level===0?`${e.message}
${e.stack}`:e.message;if(Array.isArray(e))return`[${e.length} items]`;let r=Object.keys(e);return r.length===0?"{}":r.length<=3?JSON.stringify(e):`{${r.length} keys: ${r.slice(0,3).join(", ")}...}`}return String(e)}formatTool(e,r){if(!r)return e;try{let a=typeof r=="string"?JSON.parse(r):r;if(e==="Bash"&&a.command){let t=a.command.length>50?a.command.substring(0,50)+"...":a.command;return`${e}(${t})`}if(e==="Read"&&a.file_path){let t=a.file_path.split("/").pop()||a.file_path;return`${e}(${t})`}if(e==="Edit"&&a.file_path){let t=a.file_path.split("/").pop()||a.file_path;return`${e}(${t})`}if(e==="Write"&&a.file_path){let t=a.file_path.split("/").pop()||a.file_path;return`${e}(${t})`}return e}catch{return e}}log(e,r,a,t,n){if(e<this.level)return;let i=new Date().toISOString().replace("T"," ").substring(0,23),o=Za[e].padEnd(5),l=r.padEnd(6),u="";t?.correlationId?u=`[${t.correlationId}] `:t?.sessionId&&(u=`[session-${t.sessionId}] `);let f="";n!=null&&(this.level===0&&typeof n=="object"?f=`
`+JSON.stringify(n,null,2):f=" "+this.formatData(n));let h="";if(t){let{sessionId:d,sdkSessionId:m,correlationId:_,...v}=t;Object.keys(v).length>0&&(h=` {${Object.entries(v).map(([T,R])=>`${T}=${R}`).join(", ")}}`)}let g=`[${i}] [${o}] [${l}] ${u}${a}${h}${f}`;e===3?console.error(g):console.log(g)}debug(e,r,a,t){this.log(0,e,r,a,t)}info(e,r,a,t){this.log(1,e,r,a,t)}warn(e,r,a,t){this.log(2,e,r,a,t)}error(e,r,a,t){this.log(3,e,r,a,t)}dataIn(e,r,a,t){this.info(e,`\u2192 ${r}`,a,t)}dataOut(e,r,a,t){this.info(e,`\u2190 ${r}`,a,t)}success(e,r,a,t){this.info(e,`\u2713 ${r}`,a,t)}failure(e,r,a,t){this.error(e,`\u2717 ${r}`,a,t)}timing(e,r,a,t){this.info(e,`\u23F1 ${r}`,t,{duration:`${a}ms`})}},Oc=new Ga;var Ns=class{db;constructor(){Os(tt),this.db=new Mp(ws),this.db.pragma("journal_mode = WAL"),this.db.pragma("synchronous = NORMAL"),this.db.pragma("foreign_keys = ON"),this.initializeSchema(),this.ensureWorkerPortColumn(),this.ensurePromptTrackingColumns(),this.removeSessionSummariesUniqueConstraint(),this.addObservationHierarchicalFields(),this.makeObservationsTextNullable(),this.createUserPromptsTable()}initializeSchema(){try{this.db.exec(`
        CREATE TABLE IF NOT EXISTS schema_versions (
          id INTEGER PRIMARY KEY,
          version INTEGER UNIQUE NOT NULL,
          applied_at TEXT NOT NULL
        )
      `);let e=this.db.prepare("SELECT version FROM schema_versions ORDER BY version").all();(e.length>0?Math.max(...e.map(a=>a.version)):0)===0&&(console.error("[SessionStore] Initializing fresh database with migration004..."),this.db.exec(`
          CREATE TABLE IF NOT EXISTS sdk_sessions (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            claude_session_id TEXT UNIQUE NOT NULL,
            sdk_session_id TEXT UNIQUE,
            project TEXT NOT NULL,
            user_prompt TEXT,
            started_at TEXT NOT NULL,
            started_at_epoch INTEGER NOT NULL,
            completed_at TEXT,
            completed_at_epoch INTEGER,
            status TEXT CHECK(status IN ('active', 'completed', 'failed')) NOT NULL DEFAULT 'active'
          );

          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_claude_id ON sdk_sessions(claude_session_id);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_sdk_id ON sdk_sessions(sdk_session_id);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_project ON sdk_sessions(project);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_status ON sdk_sessions(status);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_started ON sdk_sessions(started_at_epoch DESC);

          CREATE TABLE IF NOT EXISTS observations (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT NOT NULL,
            project TEXT NOT NULL,
            text TEXT NOT NULL,
            type TEXT NOT NULL CHECK(type IN ('decision', 'bugfix', 'feature', 'refactor', 'discovery')),
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          );

          CREATE INDEX IF NOT EXISTS idx_observations_sdk_session ON observations(sdk_session_id);
          CREATE INDEX IF NOT EXISTS idx_observations_project ON observations(project);
          CREATE INDEX IF NOT EXISTS idx_observations_type ON observations(type);
          CREATE INDEX IF NOT EXISTS idx_observations_created ON observations(created_at_epoch DESC);

          CREATE TABLE IF NOT EXISTS session_summaries (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT UNIQUE NOT NULL,
            project TEXT NOT NULL,
            request TEXT,
            investigated TEXT,
            learned TEXT,
            completed TEXT,
            next_steps TEXT,
            files_read TEXT,
            files_edited TEXT,
            notes TEXT,
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          );

          CREATE INDEX IF NOT EXISTS idx_session_summaries_sdk_session ON session_summaries(sdk_session_id);
          CREATE INDEX IF NOT EXISTS idx_session_summaries_project ON session_summaries(project);
          CREATE INDEX IF NOT EXISTS idx_session_summaries_created ON session_summaries(created_at_epoch DESC);
        `),this.db.prepare("INSERT INTO schema_versions (version, applied_at) VALUES (?, ?)").run(4,new Date().toISOString()),console.error("[SessionStore] Migration004 applied successfully"))}catch(e){throw console.error("[SessionStore] Schema initialization error:",e.message),e}}ensureWorkerPortColumn(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(5))return;this.db.pragma("table_info(sdk_sessions)").some(t=>t.name==="worker_port")||(this.db.exec("ALTER TABLE sdk_sessions ADD COLUMN worker_port INTEGER"),console.error("[SessionStore] Added worker_port column to sdk_sessions table")),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(5,new Date().toISOString())}catch(e){console.error("[SessionStore] Migration error:",e.message)}}ensurePromptTrackingColumns(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(6))return;this.db.pragma("table_info(sdk_sessions)").some(l=>l.name==="prompt_counter")||(this.db.exec("ALTER TABLE sdk_sessions ADD COLUMN prompt_counter INTEGER DEFAULT 0"),console.error("[SessionStore] Added prompt_counter column to sdk_sessions table")),this.db.pragma("table_info(observations)").some(l=>l.name==="prompt_number")||(this.db.exec("ALTER TABLE observations ADD COLUMN prompt_number INTEGER"),console.error("[SessionStore] Added prompt_number column to observations table")),this.db.pragma("table_info(session_summaries)").some(l=>l.name==="prompt_number")||(this.db.exec("ALTER TABLE session_summaries ADD COLUMN prompt_number INTEGER"),console.error("[SessionStore] Added prompt_number column to session_summaries table")),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(6,new Date().toISOString())}catch(e){console.error("[SessionStore] Prompt tracking migration error:",e.message)}}removeSessionSummariesUniqueConstraint(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(7))return;if(!this.db.pragma("index_list(session_summaries)").some(t=>t.unique===1)){this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(7,new Date().toISOString());return}console.error("[SessionStore] Removing UNIQUE constraint from session_summaries.sdk_session_id..."),this.db.exec("BEGIN TRANSACTION");try{this.db.exec(`
          CREATE TABLE session_summaries_new (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT NOT NULL,
            project TEXT NOT NULL,
            request TEXT,
            investigated TEXT,
            learned TEXT,
            completed TEXT,
            next_steps TEXT,
            files_read TEXT,
            files_edited TEXT,
            notes TEXT,
            prompt_number INTEGER,
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          )
        `),this.db.exec(`
          INSERT INTO session_summaries_new
          SELECT id, sdk_session_id, project, request, investigated, learned,
                 completed, next_steps, files_read, files_edited, notes,
                 prompt_number, created_at, created_at_epoch
          FROM session_summaries
        `),this.db.exec("DROP TABLE session_summaries"),this.db.exec("ALTER TABLE session_summaries_new RENAME TO session_summaries"),this.db.exec(`
          CREATE INDEX idx_session_summaries_sdk_session ON session_summaries(sdk_session_id);
          CREATE INDEX idx_session_summaries_project ON session_summaries(project);
          CREATE INDEX idx_session_summaries_created ON session_summaries(created_at_epoch DESC);
        `),this.db.exec("COMMIT"),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(7,new Date().toISOString()),console.error("[SessionStore] Successfully removed UNIQUE constraint from session_summaries.sdk_session_id")}catch(t){throw this.db.exec("ROLLBACK"),t}}catch(e){console.error("[SessionStore] Migration error (remove UNIQUE constraint):",e.message)}}addObservationHierarchicalFields(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(8))return;if(this.db.pragma("table_info(observations)").some(t=>t.name==="title")){this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(8,new Date().toISOString());return}console.error("[SessionStore] Adding hierarchical fields to observations table..."),this.db.exec(`
        ALTER TABLE observations ADD COLUMN title TEXT;
        ALTER TABLE observations ADD COLUMN subtitle TEXT;
        ALTER TABLE observations ADD COLUMN facts TEXT;
        ALTER TABLE observations ADD COLUMN narrative TEXT;
        ALTER TABLE observations ADD COLUMN concepts TEXT;
        ALTER TABLE observations ADD COLUMN files_read TEXT;
        ALTER TABLE observations ADD COLUMN files_modified TEXT;
      `),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(8,new Date().toISOString()),console.error("[SessionStore] Successfully added hierarchical fields to observations table")}catch(e){console.error("[SessionStore] Migration error (add hierarchical fields):",e.message)}}makeObservationsTextNullable(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(9))return;let a=this.db.pragma("table_info(observations)").find(t=>t.name==="text");if(!a||a.notnull===0){this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(9,new Date().toISOString());return}console.error("[SessionStore] Making observations.text nullable..."),this.db.exec("BEGIN TRANSACTION");try{this.db.exec(`
          CREATE TABLE observations_new (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT NOT NULL,
            project TEXT NOT NULL,
            text TEXT,
            type TEXT NOT NULL CHECK(type IN ('decision', 'bugfix', 'feature', 'refactor', 'discovery', 'change')),
            title TEXT,
            subtitle TEXT,
            facts TEXT,
            narrative TEXT,
            concepts TEXT,
            files_read TEXT,
            files_modified TEXT,
            prompt_number INTEGER,
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          )
        `),this.db.exec(`
          INSERT INTO observations_new
          SELECT id, sdk_session_id, project, text, type, title, subtitle, facts,
                 narrative, concepts, files_read, files_modified, prompt_number,
                 created_at, created_at_epoch
          FROM observations
        `),this.db.exec("DROP TABLE observations"),this.db.exec("ALTER TABLE observations_new RENAME TO observations"),this.db.exec(`
          CREATE INDEX idx_observations_sdk_session ON observations(sdk_session_id);
          CREATE INDEX idx_observations_project ON observations(project);
          CREATE INDEX idx_observations_type ON observations(type);
          CREATE INDEX idx_observations_created ON observations(created_at_epoch DESC);
        `),this.db.exec("COMMIT"),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(9,new Date().toISOString()),console.error("[SessionStore] Successfully made observations.text nullable")}catch(t){throw this.db.exec("ROLLBACK"),t}}catch(e){console.error("[SessionStore] Migration error (make text nullable):",e.message)}}createUserPromptsTable(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(10))return;if(this.db.pragma("table_info(user_prompts)").length>0){this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(10,new Date().toISOString());return}console.error("[SessionStore] Creating user_prompts table with FTS5 support..."),this.db.exec("BEGIN TRANSACTION");try{this.db.exec(`
          CREATE TABLE user_prompts (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            claude_session_id TEXT NOT NULL,
            prompt_number INTEGER NOT NULL,
            prompt_text TEXT NOT NULL,
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(claude_session_id) REFERENCES sdk_sessions(claude_session_id) ON DELETE CASCADE
          );

          CREATE INDEX idx_user_prompts_claude_session ON user_prompts(claude_session_id);
          CREATE INDEX idx_user_prompts_created ON user_prompts(created_at_epoch DESC);
          CREATE INDEX idx_user_prompts_prompt_number ON user_prompts(prompt_number);
        `),this.db.exec(`
          CREATE VIRTUAL TABLE user_prompts_fts USING fts5(
            prompt_text,
            content='user_prompts',
            content_rowid='id'
          );
        `),this.db.exec(`
          CREATE TRIGGER user_prompts_ai AFTER INSERT ON user_prompts BEGIN
            INSERT INTO user_prompts_fts(rowid, prompt_text)
            VALUES (new.id, new.prompt_text);
          END;

          CREATE TRIGGER user_prompts_ad AFTER DELETE ON user_prompts BEGIN
            INSERT INTO user_prompts_fts(user_prompts_fts, rowid, prompt_text)
            VALUES('delete', old.id, old.prompt_text);
          END;

          CREATE TRIGGER user_prompts_au AFTER UPDATE ON user_prompts BEGIN
            INSERT INTO user_prompts_fts(user_prompts_fts, rowid, prompt_text)
            VALUES('delete', old.id, old.prompt_text);
            INSERT INTO user_prompts_fts(rowid, prompt_text)
            VALUES (new.id, new.prompt_text);
          END;
        `),this.db.exec("COMMIT"),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(10,new Date().toISOString()),console.error("[SessionStore] Successfully created user_prompts table with FTS5 support")}catch(a){throw this.db.exec("ROLLBACK"),a}}catch(e){console.error("[SessionStore] Migration error (create user_prompts table):",e.message)}}getRecentSummaries(e,r=10){return this.db.prepare(`
      SELECT
        request, investigated, learned, completed, next_steps,
        files_read, files_edited, notes, prompt_number, created_at
      FROM session_summaries
      WHERE project = ?
      ORDER BY created_at_epoch DESC
      LIMIT ?
    `).all(e,r)}getRecentSummariesWithSessionInfo(e,r=3){return this.db.prepare(`
      SELECT
        sdk_session_id, request, learned, completed, next_steps,
        prompt_number, created_at
      FROM session_summaries
      WHERE project = ?
      ORDER BY created_at_epoch DESC
      LIMIT ?
    `).all(e,r)}getRecentObservations(e,r=20){return this.db.prepare(`
      SELECT type, text, prompt_number, created_at
      FROM observations
      WHERE project = ?
      ORDER BY created_at_epoch DESC
      LIMIT ?
    `).all(e,r)}getRecentSessionsWithStatus(e,r=3){return this.db.prepare(`
      SELECT * FROM (
        SELECT
          s.sdk_session_id,
          s.status,
          s.started_at,
          s.started_at_epoch,
          s.user_prompt,
          CASE WHEN sum.sdk_session_id IS NOT NULL THEN 1 ELSE 0 END as has_summary
        FROM sdk_sessions s
        LEFT JOIN session_summaries sum ON s.sdk_session_id = sum.sdk_session_id
        WHERE s.project = ? AND s.sdk_session_id IS NOT NULL
        GROUP BY s.sdk_session_id
        ORDER BY s.started_at_epoch DESC
        LIMIT ?
      )
      ORDER BY started_at_epoch ASC
    `).all(e,r)}getObservationsForSession(e){return this.db.prepare(`
      SELECT title, subtitle, type, prompt_number
      FROM observations
      WHERE sdk_session_id = ?
      ORDER BY created_at_epoch ASC
    `).all(e)}getSummaryForSession(e){return this.db.prepare(`
      SELECT
        request, investigated, learned, completed, next_steps,
        files_read, files_edited, notes, prompt_number, created_at
      FROM session_summaries
      WHERE sdk_session_id = ?
      ORDER BY created_at_epoch DESC
      LIMIT 1
    `).get(e)||null}getFilesForSession(e){let a=this.db.prepare(`
      SELECT files_read, files_modified
      FROM observations
      WHERE sdk_session_id = ?
    `).all(e),t=new Set,n=new Set;for(let i of a){if(i.files_read)try{let o=JSON.parse(i.files_read);Array.isArray(o)&&o.forEach(l=>t.add(l))}catch{}if(i.files_modified)try{let o=JSON.parse(i.files_modified);Array.isArray(o)&&o.forEach(l=>n.add(l))}catch{}}return{filesRead:Array.from(t),filesModified:Array.from(n)}}getSessionById(e){return this.db.prepare(`
      SELECT id, claude_session_id, sdk_session_id, project, user_prompt
      FROM sdk_sessions
      WHERE id = ?
      LIMIT 1
    `).get(e)||null}findActiveSDKSession(e){return this.db.prepare(`
      SELECT id, sdk_session_id, project, worker_port
      FROM sdk_sessions
      WHERE claude_session_id = ? AND status = 'active'
      LIMIT 1
    `).get(e)||null}findAnySDKSession(e){return this.db.prepare(`
      SELECT id
      FROM sdk_sessions
      WHERE claude_session_id = ?
      LIMIT 1
    `).get(e)||null}reactivateSession(e,r){this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'active', user_prompt = ?, worker_port = NULL
      WHERE id = ?
    `).run(r,e)}incrementPromptCounter(e){return this.db.prepare(`
      UPDATE sdk_sessions
      SET prompt_counter = COALESCE(prompt_counter, 0) + 1
      WHERE id = ?
    `).run(e),this.db.prepare(`
      SELECT prompt_counter FROM sdk_sessions WHERE id = ?
    `).get(e)?.prompt_counter||1}getPromptCounter(e){return this.db.prepare(`
      SELECT prompt_counter FROM sdk_sessions WHERE id = ?
    `).get(e)?.prompt_counter||0}createSDKSession(e,r,a){let t=new Date,n=t.getTime(),o=this.db.prepare(`
      INSERT OR IGNORE INTO sdk_sessions
      (claude_session_id, sdk_session_id, project, user_prompt, started_at, started_at_epoch, status)
      VALUES (?, ?, ?, ?, ?, ?, 'active')
    `).run(e,e,r,a,t.toISOString(),n);return o.lastInsertRowid===0||o.changes===0?this.db.prepare(`
        SELECT id FROM sdk_sessions WHERE claude_session_id = ? LIMIT 1
      `).get(e).id:o.lastInsertRowid}updateSDKSessionId(e,r){return this.db.prepare(`
      UPDATE sdk_sessions
      SET sdk_session_id = ?
      WHERE id = ? AND sdk_session_id IS NULL
    `).run(r,e).changes===0?(Oc.debug("DB","sdk_session_id already set, skipping update",{sessionId:e,sdkSessionId:r}),!1):!0}setWorkerPort(e,r){this.db.prepare(`
      UPDATE sdk_sessions
      SET worker_port = ?
      WHERE id = ?
    `).run(r,e)}getWorkerPort(e){return this.db.prepare(`
      SELECT worker_port
      FROM sdk_sessions
      WHERE id = ?
      LIMIT 1
    `).get(e)?.worker_port||null}saveUserPrompt(e,r,a){let t=new Date,n=t.getTime();return this.db.prepare(`
      INSERT INTO user_prompts
      (claude_session_id, prompt_number, prompt_text, created_at, created_at_epoch)
      VALUES (?, ?, ?, ?, ?)
    `).run(e,r,a,t.toISOString(),n).lastInsertRowid}storeObservation(e,r,a,t){let n=new Date,i=n.getTime();this.db.prepare(`
      SELECT id FROM sdk_sessions WHERE sdk_session_id = ?
    `).get(e)||(this.db.prepare(`
        INSERT INTO sdk_sessions
        (claude_session_id, sdk_session_id, project, started_at, started_at_epoch, status)
        VALUES (?, ?, ?, ?, ?, 'active')
      `).run(e,e,r,n.toISOString(),i),console.error(`[SessionStore] Auto-created session record for session_id: ${e}`)),this.db.prepare(`
      INSERT INTO observations
      (sdk_session_id, project, type, title, subtitle, facts, narrative, concepts,
       files_read, files_modified, prompt_number, created_at, created_at_epoch)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `).run(e,r,a.type,a.title,a.subtitle,JSON.stringify(a.facts),a.narrative,JSON.stringify(a.concepts),JSON.stringify(a.files_read),JSON.stringify(a.files_modified),t||null,n.toISOString(),i)}storeSummary(e,r,a,t){let n=new Date,i=n.getTime();this.db.prepare(`
      SELECT id FROM sdk_sessions WHERE sdk_session_id = ?
    `).get(e)||(this.db.prepare(`
        INSERT INTO sdk_sessions
        (claude_session_id, sdk_session_id, project, started_at, started_at_epoch, status)
        VALUES (?, ?, ?, ?, ?, 'active')
      `).run(e,e,r,n.toISOString(),i),console.error(`[SessionStore] Auto-created session record for session_id: ${e}`)),this.db.prepare(`
      INSERT INTO session_summaries
      (sdk_session_id, project, request, investigated, learned, completed,
       next_steps, notes, prompt_number, created_at, created_at_epoch)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `).run(e,r,a.request,a.investigated,a.learned,a.completed,a.next_steps,a.notes,t||null,n.toISOString(),i)}markSessionCompleted(e){let r=new Date,a=r.getTime();this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'completed', completed_at = ?, completed_at_epoch = ?
      WHERE id = ?
    `).run(r.toISOString(),a,e)}markSessionFailed(e){let r=new Date,a=r.getTime();this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'failed', completed_at = ?, completed_at_epoch = ?
      WHERE id = ?
    `).run(r.toISOString(),a,e)}cleanupOrphanedSessions(){let e=new Date,r=e.getTime();return this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'failed', completed_at = ?, completed_at_epoch = ?
      WHERE status = 'active'
    `).run(e.toISOString(),r).changes}close(){this.db.close()}};var Ic=zs(Ma(),1),As=class extends mr{constructor(e,r){var a;super(r),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._capabilities=(a=r?.capabilities)!==null&&a!==void 0?a:{},this._ajv=new Ic.default}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=ts(this._capabilities,e)}assertCapability(e,r){var a;if(!(!((a=this._serverCapabilities)===null||a===void 0)&&a[e]))throw new Error(`Server does not support ${e} (required for ${r})`)}async connect(e,r){if(await super.connect(e),e.sessionId===void 0)try{let a=await this.request({method:"initialize",params:{protocolVersion:Nr,capabilities:this._capabilities,clientInfo:this._clientInfo}},Qs,r);if(a===void 0)throw new Error(`Server sent invalid initialize result: ${a}`);if(!Zr.includes(a.protocolVersion))throw new Error(`Server's protocol version is not supported: ${a.protocolVersion}`);this._serverCapabilities=a.capabilities,this._serverVersion=a.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(a.protocolVersion),this._instructions=a.instructions,await this.notification({method:"notifications/initialized"})}catch(a){throw this.close(),a}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var r,a,t,n,i;switch(e){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(!((a=this._serverCapabilities)===null||a===void 0)&&a.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((t=this._serverCapabilities)===null||t===void 0)&&t.resources))throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(!((i=this._serverCapabilities)===null||i===void 0)&&i.completions))throw new Error(`Server does not support completions (required for ${e})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(e){var r;switch(e){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"ping":break}}async ping(e){return this.request({method:"ping"},yt,e)}async complete(e,r){return this.request({method:"completion/complete",params:e},pa,r)}async setLoggingLevel(e,r){return this.request({method:"logging/setLevel",params:{level:e}},yt,r)}async getPrompt(e,r){return this.request({method:"prompts/get",params:e},ia,r)}async listPrompts(e,r){return this.request({method:"prompts/list",params:e},ra,r)}async listResources(e,r){return this.request({method:"resources/list",params:e},Ys,r)}async listResourceTemplates(e,r){return this.request({method:"resources/templates/list",params:e},ea,r)}async readResource(e,r){return this.request({method:"resources/read",params:e},ta,r)}async subscribeResource(e,r){return this.request({method:"resources/subscribe",params:e},yt,r)}async unsubscribeResource(e,r){return this.request({method:"resources/unsubscribe",params:e},yt,r)}async callTool(e,r=es,a){let t=await this.request({method:"tools/call",params:e},r,a),n=this.getToolOutputValidator(e.name);if(n){if(!t.structuredContent&&!t.isError)throw new Oe(Ce.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(t.structuredContent)try{if(!n(t.structuredContent))throw new Oe(Ce.InvalidParams,`Structured content does not match the tool's output schema: ${this._ajv.errorsText(n.errors)}`)}catch(i){throw i instanceof Oe?i:new Oe(Ce.InvalidParams,`Failed to validate structured content: ${i instanceof Error?i.message:String(i)}`)}}return t}cacheToolOutputSchemas(e){this._cachedToolOutputValidators.clear();for(let r of e)if(r.outputSchema)try{let a=this._ajv.compile(r.outputSchema);this._cachedToolOutputValidators.set(r.name,a)}catch{}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,r){let a=await this.request({method:"tools/list",params:e},ca,r);return this.cacheToolOutputSchemas(a.tools),a}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}};var _l=zs(gl(),1);import $s from"node:process";import{PassThrough as fh}from"node:stream";var ph=$s.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE","PROGRAMFILES"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function hh(){let s={};for(let e of ph){let r=$s.env[e];r!==void 0&&(r.startsWith("()")||(s[e]=r))}return s}var Ds=class{constructor(e){this._abortController=new AbortController,this._readBuffer=new vr,this._stderrStream=null,this._serverParams=e,(e.stderr==="pipe"||e.stderr==="overlapped")&&(this._stderrStream=new fh)}async start(){if(this._process)throw new Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,r)=>{var a,t,n,i,o;this._process=(0,_l.default)(this._serverParams.command,(a=this._serverParams.args)!==null&&a!==void 0?a:[],{env:{...hh(),...this._serverParams.env},stdio:["pipe","pipe",(t=this._serverParams.stderr)!==null&&t!==void 0?t:"inherit"],shell:!1,signal:this._abortController.signal,windowsHide:$s.platform==="win32"&&mh(),cwd:this._serverParams.cwd}),this._process.on("error",l=>{var u,f;if(l.name==="AbortError"){(u=this.onclose)===null||u===void 0||u.call(this);return}r(l),(f=this.onerror)===null||f===void 0||f.call(this,l)}),this._process.on("spawn",()=>{e()}),this._process.on("close",l=>{var u;this._process=void 0,(u=this.onclose)===null||u===void 0||u.call(this)}),(n=this._process.stdin)===null||n===void 0||n.on("error",l=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,l)}),(i=this._process.stdout)===null||i===void 0||i.on("data",l=>{this._readBuffer.append(l),this.processReadBuffer()}),(o=this._process.stdout)===null||o===void 0||o.on("error",l=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,l)}),this._stderrStream&&this._process.stderr&&this._process.stderr.pipe(this._stderrStream)})}get stderr(){var e,r;return this._stderrStream?this._stderrStream:(r=(e=this._process)===null||e===void 0?void 0:e.stderr)!==null&&r!==void 0?r:null}get pid(){var e,r;return(r=(e=this._process)===null||e===void 0?void 0:e.pid)!==null&&r!==void 0?r:null}processReadBuffer(){for(var e,r;;)try{let a=this._readBuffer.readMessage();if(a===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,a)}catch(a){(r=this.onerror)===null||r===void 0||r.call(this,a)}}async close(){this._abortController.abort(),this._process=void 0,this._readBuffer.clear()}send(e){return new Promise(r=>{var a;if(!(!((a=this._process)===null||a===void 0)&&a.stdin))throw new Error("Not connected");let t=bs(e);this._process.stdin.write(t)?r():this._process.stdin.once("drain",r)})}};function mh(){return"type"in $s}var ks=class{client=null;collectionName="cm__claude-mem";async connect(){let e=new Ds({command:"uvx",args:["chroma-mcp","--client-type","persistent","--data-dir",wc]});this.client=new As({name:"claude-mem-search-orchestrator",version:"1.0.0"},{capabilities:{}}),await this.client.connect(e)}async queryDocuments(e,r=100,a){if(!this.client)throw new Error("Chroma client not connected");let t=await this.client.callTool({name:"chroma_query_documents",arguments:{collection_name:this.collectionName,query_texts:[e],n_results:r,...a&&{where:a},include:["documents","metadatas","distances"]}});return JSON.parse(t.content[0].text)}extractSqliteIds(e){let r=new Set;return e.metadatas[0]?.forEach(a=>{a.sqlite_id&&r.add(a.sqlite_id)}),Array.from(r)}async close(){this.client&&await this.client.close()}};var sn,Qe,lt;function yr(){return`
---
\u{1F4A1} Search Strategy:
ALWAYS search with index format FIRST to get an overview and identify relevant results.
This is critical for token efficiency - index format uses ~10x fewer tokens than full format.

Search workflow:
1. Initial search: Use default (index) format to see titles, dates, and sources
2. Review results: Identify which items are most relevant to your needs
3. Deep dive: Only then use format: "full" on specific items of interest
4. Narrow down: Use filters (type, dateRange, concepts, files) to refine results

Other tips:
\u2022 To search by concept: Use find_by_concept tool
\u2022 To browse by type: Use find_by_type with ["decision", "feature", etc.]
\u2022 To sort by date: Use orderBy: "date_desc" or "date_asc"`}function js(s,e){let r=s.title||`Observation #${s.id}`,a=new Date(s.created_at_epoch).toLocaleString(),t=s.type?`[${s.type}]`:"";return`${e+1}. ${t} ${r}
   Date: ${a}
   Source: claude-mem://observation/${s.id}`}function yl(s,e){let r=s.request||`Session ${s.sdk_session_id.substring(0,8)}`,a=new Date(s.created_at_epoch).toLocaleString();return`${e+1}. ${r}
   Date: ${a}
   Source: claude-mem://session/${s.sdk_session_id}`}function Fs(s,e){let r=s.title||`Observation #${s.id}`,a=[];a.push(`## ${r}`),a.push(`*Source: claude-mem://observation/${s.id}*`),a.push(""),s.subtitle&&(a.push(`**${s.subtitle}**`),a.push("")),s.narrative&&(a.push(s.narrative),a.push("")),s.text&&(a.push(s.text),a.push(""));let t=[];if(t.push(`Type: ${s.type}`),s.facts)try{let i=JSON.parse(s.facts);i.length>0&&t.push(`Facts: ${i.join("; ")}`)}catch{}if(s.concepts)try{let i=JSON.parse(s.concepts);i.length>0&&t.push(`Concepts: ${i.join(", ")}`)}catch{}if(s.files_read||s.files_modified){let i=[];if(s.files_read)try{i.push(...JSON.parse(s.files_read))}catch{}if(s.files_modified)try{i.push(...JSON.parse(s.files_modified))}catch{}i.length>0&&t.push(`Files: ${[...new Set(i)].join(", ")}`)}t.length>0&&(a.push("---"),a.push(t.join(" | ")));let n=new Date(s.created_at_epoch).toLocaleString();return a.push(""),a.push("---"),a.push(`Date: ${n}`),a.join(`
`)}function El(s,e){let r=s.request||`Session ${s.sdk_session_id.substring(0,8)}`,a=[];a.push(`## ${r}`),a.push(`*Source: claude-mem://session/${s.sdk_session_id}*`),a.push(""),s.completed&&(a.push(`**Completed:** ${s.completed}`),a.push("")),s.learned&&(a.push(`**Learned:** ${s.learned}`),a.push("")),s.investigated&&(a.push(`**Investigated:** ${s.investigated}`),a.push("")),s.next_steps&&(a.push(`**Next Steps:** ${s.next_steps}`),a.push("")),s.notes&&(a.push(`**Notes:** ${s.notes}`),a.push(""));let t=[];if(s.files_read||s.files_edited){let i=[];if(s.files_read)try{i.push(...JSON.parse(s.files_read))}catch{}if(s.files_edited)try{i.push(...JSON.parse(s.files_edited))}catch{}i.length>0&&t.push(`Files: ${[...new Set(i)].join(", ")}`)}let n=new Date(s.created_at_epoch).toLocaleDateString();return t.push(`Date: ${n}`),t.length>0&&(a.push("---"),a.push(t.join(" | "))),a.join(`
`)}function vh(s,e){let r=s.prompt_text.length>100?s.prompt_text.substring(0,100)+"...":s.prompt_text,a=new Date(s.created_at_epoch).toLocaleString();return`${e+1}. "${r}"
   Date: ${a} | Prompt #${s.prompt_number}
   Source: claude-mem://user-prompt/${s.id}`}function gh(s,e){let r=[];r.push(`## User Prompt #${s.prompt_number}`),r.push(`*Source: claude-mem://user-prompt/${s.id}*`),r.push(""),r.push(s.prompt_text),r.push(""),r.push("---");let a=new Date(s.created_at_epoch).toLocaleString();return r.push(`Date: ${a}`),r.join(`
`)}var _h=c.object({project:c.string().optional().describe("Filter by project name"),type:c.union([c.enum(["decision","bugfix","feature","refactor","discovery","change"]),c.array(c.enum(["decision","bugfix","feature","refactor","discovery","change"]))]).optional().describe("Filter by observation type"),concepts:c.union([c.string(),c.array(c.string())]).optional().describe("Filter by concept tags"),files:c.union([c.string(),c.array(c.string())]).optional().describe("Filter by file paths (partial match)"),dateRange:c.object({start:c.union([c.string(),c.number()]).optional().describe("Start date (ISO string or epoch)"),end:c.union([c.string(),c.number()]).optional().describe("End date (ISO string or epoch)")}).optional().describe("Filter by date range"),limit:c.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:c.number().min(0).default(0).describe("Number of results to skip"),orderBy:c.enum(["relevance","date_desc","date_asc"]).default("relevance").describe("Sort order")}),bl=[{name:"search_observations",description:'Search observations using full-text search across titles, narratives, facts, and concepts. IMPORTANT: Always use index format first (default) to get an overview with minimal token usage, then use format: "full" only for specific items of interest.',inputSchema:c.object({query:c.string().describe("Search query for FTS5 full-text search"),format:c.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default, RECOMMENDED for initial search), "full" for complete details (use only after reviewing index results)'),..._h.shape}),handler:async s=>{try{let{query:e,format:r="index",...a}=s,t=await lt.queryDocuments(e,100);if(t.ids[0].length===0)return{content:[{type:"text",text:`No observations found matching "${e}"`}]};let n=Date.now()-90*24*60*60*1e3,i=lt.extractSqliteIds(t).filter(h=>{let g=t.metadatas[0].find(d=>d.sqlite_id===h);return g&&g.created_at_epoch>n});if(i.length===0)return{content:[{type:"text",text:`No recent observations found matching "${e}" (searched last 90 days)`}]};let o=a.limit||20,l=i.map(()=>"?").join(","),u=Qe.db.prepare(`
          SELECT * FROM observations
          WHERE id IN (${l})
          ORDER BY created_at_epoch DESC
          LIMIT ?
        `).all(...i,o),f;if(r==="index"){let h=`Found ${u.length} observation(s) matching "${e}" (semantic search, last 90 days):

`,g=u.map((d,m)=>js(d,m));f=h+g.join(`

`)+yr()}else f=u.map((g,d)=>Fs(g,d)).join(`

---

`);return{content:[{type:"text",text:f}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"search_sessions",description:'Search session summaries using full-text search across requests, completions, learnings, and notes. IMPORTANT: Always use index format first (default) to get an overview with minimal token usage, then use format: "full" only for specific items of interest.',inputSchema:c.object({query:c.string().describe("Search query for FTS5 full-text search"),format:c.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default, RECOMMENDED for initial search), "full" for complete details (use only after reviewing index results)'),project:c.string().optional().describe("Filter by project name"),dateRange:c.object({start:c.union([c.string(),c.number()]).optional(),end:c.union([c.string(),c.number()]).optional()}).optional().describe("Filter by date range"),limit:c.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:c.number().min(0).default(0).describe("Number of results to skip"),orderBy:c.enum(["relevance","date_desc","date_asc"]).default("relevance").describe("Sort order")}),handler:async s=>{try{let{query:e,format:r="index",...a}=s,t=sn.searchSessions(e,a);if(t.length===0)return{content:[{type:"text",text:`No sessions found matching "${e}"`}]};let n;if(r==="index"){let i=`Found ${t.length} session(s) matching "${e}":

`,o=t.map((l,u)=>yl(l,u));n=i+o.join(`

`)+yr()}else n=t.map((o,l)=>El(o,l)).join(`

---

`);return{content:[{type:"text",text:n}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"find_by_concept",description:'Find observations tagged with a specific concept. IMPORTANT: Always use index format first (default) to get an overview with minimal token usage, then use format: "full" only for specific items of interest.',inputSchema:c.object({concept:c.string().describe("Concept tag to search for"),format:c.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default, RECOMMENDED for initial search), "full" for complete details (use only after reviewing index results)'),project:c.string().optional().describe("Filter by project name"),dateRange:c.object({start:c.union([c.string(),c.number()]).optional(),end:c.union([c.string(),c.number()]).optional()}).optional().describe("Filter by date range"),limit:c.number().min(1).max(100).default(20).describe("Maximum results. IMPORTANT: Start with 3-5 to avoid exceeding MCP token limits, even in index mode."),offset:c.number().min(0).default(0).describe("Number of results to skip"),orderBy:c.enum(["relevance","date_desc","date_asc"]).default("date_desc").describe("Sort order")}),handler:async s=>{try{let{concept:e,format:r="index",...a}=s,t=a.project||Ls(process.cwd()),n=Qe.db.prepare(`
          SELECT id FROM observations
          WHERE json_extract(concepts, '$') LIKE ?
          AND project = ?
        `).all(`%"${e}"%`,t);if(n.length===0)return{content:[{type:"text",text:`No observations found with concept "${e}"`}]};let i=n.map(m=>m.id),o=await lt.queryDocuments(e,i.length,{sqlite_id:{$in:i}}),l=a.limit||20,u=lt.extractSqliteIds(o).slice(0,l);if(u.length===0)return{content:[{type:"text",text:`No observations found with concept "${e}"`}]};let f=u.map(()=>"?").join(","),h=u.map((m,_)=>`WHEN ${m} THEN ${_}`).join(" "),g=Qe.db.prepare(`
          SELECT * FROM observations
          WHERE id IN (${f})
          ORDER BY CASE id ${h} END
        `).all(...u),d;if(r==="index"){let m=`Found ${g.length} observation(s) with concept "${e}" (semantic ranking):

`,_=g.map((v,b)=>js(v,b));d=m+_.join(`

`)+yr()}else d=g.map((_,v)=>Fs(_,v)).join(`

---

`);return{content:[{type:"text",text:d}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"find_by_file",description:'Find observations and sessions that reference a specific file path. IMPORTANT: Always use index format first (default) to get an overview with minimal token usage, then use format: "full" only for specific items of interest.',inputSchema:c.object({filePath:c.string().describe("File path to search for (supports partial matching)"),format:c.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default, RECOMMENDED for initial search), "full" for complete details (use only after reviewing index results)'),project:c.string().optional().describe("Filter by project name"),dateRange:c.object({start:c.union([c.string(),c.number()]).optional(),end:c.union([c.string(),c.number()]).optional()}).optional().describe("Filter by date range"),limit:c.number().min(1).max(100).default(20).describe("Maximum results. IMPORTANT: Start with 3-5 to avoid exceeding MCP token limits, even in index mode."),offset:c.number().min(0).default(0).describe("Number of results to skip"),orderBy:c.enum(["relevance","date_desc","date_asc"]).default("date_desc").describe("Sort order")}),handler:async s=>{try{let{filePath:e,format:r="index",...a}=s,t=a.project||Ls(process.cwd()),n=Qe.db.prepare(`
          SELECT id FROM observations
          WHERE (
            json_extract(files_read, '$') LIKE ?
            OR json_extract(files_modified, '$') LIKE ?
          )
          AND project = ?
        `).all(`%"${e}"%`,`%"${e}"%`,t),i=[];if(n.length>0){let f=n.map(m=>m.id),h=await lt.queryDocuments(e,f.length,{sqlite_id:{$in:f}}),g=a.limit||20,d=lt.extractSqliteIds(h).slice(0,g);if(d.length>0){let m=d.map(()=>"?").join(","),_=d.map((v,b)=>`WHEN ${v} THEN ${b}`).join(" ");i=Qe.db.prepare(`
              SELECT * FROM observations
              WHERE id IN (${m})
              ORDER BY CASE id ${_} END
            `).all(...d)}}let o=Qe.db.prepare(`
          SELECT * FROM session_summaries
          WHERE (
            json_extract(files_read, '$') LIKE ?
            OR json_extract(files_edited, '$') LIKE ?
          )
          AND project = ?
          ORDER BY created_at DESC
          LIMIT ?
        `).all(`%"${e}"%`,`%"${e}"%`,t,10),l=i.length+o.length;if(l===0)return{content:[{type:"text",text:`No results found for file "${e}"`}]};let u;if(r==="index"){let f=`Found ${l} result(s) for file "${e}" (semantic ranking):

`,h=[];i.forEach((g,d)=>{h.push(js(g,d))}),o.forEach((g,d)=>{h.push(yl(g,d+i.length))}),u=f+h.join(`

`)+yr()}else{let f=[];i.forEach((h,g)=>{f.push(Fs(h,g))}),o.forEach((h,g)=>{f.push(El(h,g+i.length))}),u=f.join(`

---

`)}return{content:[{type:"text",text:u}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"find_by_type",description:'Find observations of a specific type (decision, bugfix, feature, refactor, discovery, change). IMPORTANT: Always use index format first (default) to get an overview with minimal token usage, then use format: "full" only for specific items of interest.',inputSchema:c.object({type:c.union([c.enum(["decision","bugfix","feature","refactor","discovery","change"]),c.array(c.enum(["decision","bugfix","feature","refactor","discovery","change"]))]).describe("Observation type(s) to filter by"),format:c.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default, RECOMMENDED for initial search), "full" for complete details (use only after reviewing index results)'),project:c.string().optional().describe("Filter by project name"),dateRange:c.object({start:c.union([c.string(),c.number()]).optional(),end:c.union([c.string(),c.number()]).optional()}).optional().describe("Filter by date range"),limit:c.number().min(1).max(100).default(20).describe("Maximum results. IMPORTANT: Start with 3-5 to avoid exceeding MCP token limits, even in index mode."),offset:c.number().min(0).default(0).describe("Number of results to skip"),orderBy:c.enum(["relevance","date_desc","date_asc"]).default("date_desc").describe("Sort order")}),handler:async s=>{try{let{type:e,format:r="index",...a}=s,t=a.project||Ls(process.cwd()),n=Array.isArray(e)?e:[e],i=Qe.db.prepare(`
          SELECT id FROM observations
          WHERE type IN (${n.map(()=>"?").join(",")})
          AND project = ?
        `).all(...n,t);if(i.length===0)return{content:[{type:"text",text:`No observations found with type "${Array.isArray(e)?e.join(", "):e}"`}]};let o=i.map(v=>v.id),l=await lt.queryDocuments(t,o.length,{sqlite_id:{$in:o}}),u=a.limit||20,f=lt.extractSqliteIds(l).slice(0,u);if(f.length===0)return{content:[{type:"text",text:`No observations found with type "${Array.isArray(e)?e.join(", "):e}"`}]};let h=f.map(()=>"?").join(","),g=f.map((v,b)=>`WHEN ${v} THEN ${b}`).join(" "),d=Qe.db.prepare(`
          SELECT * FROM observations
          WHERE id IN (${h})
          ORDER BY CASE id ${g} END
        `).all(...f),m=Array.isArray(e)?e.join(", "):e,_;if(r==="index"){let v=`Found ${d.length} observation(s) with type "${m}" (semantic ranking):

`,b=d.map((T,R)=>js(T,R));_=v+b.join(`

`)+yr()}else _=d.map((b,T)=>Fs(b,T)).join(`

---

`);return{content:[{type:"text",text:_}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"get_recent_context",description:"Get recent session context including summaries and observations for a project",inputSchema:c.object({project:c.string().optional().describe("Project name (defaults to current working directory basename)"),limit:c.number().min(1).max(10).default(3).describe("Number of recent sessions to retrieve")}),handler:async s=>{try{let e=s.project||Ls(process.cwd()),r=s.limit||3,a=Qe.getRecentSessionsWithStatus(e,r);if(a.length===0)return{content:[{type:"text",text:`# Recent Session Context

No previous sessions found for project "${e}".`}]};let t=[];t.push("# Recent Session Context"),t.push(""),t.push(`Showing last ${a.length} session(s) for **${e}**:`),t.push("");for(let n of a)if(n.sdk_session_id){if(t.push("---"),t.push(""),n.has_summary){let i=Qe.getSummaryForSession(n.sdk_session_id);if(i){let o=i.prompt_number?` (Prompt #${i.prompt_number})`:"";if(t.push(`**Summary${o}**`),t.push(""),i.request&&t.push(`**Request:** ${i.request}`),i.completed&&t.push(`**Completed:** ${i.completed}`),i.learned&&t.push(`**Learned:** ${i.learned}`),i.next_steps&&t.push(`**Next Steps:** ${i.next_steps}`),i.files_read)try{let u=JSON.parse(i.files_read);Array.isArray(u)&&u.length>0&&t.push(`**Files Read:** ${u.join(", ")}`)}catch{i.files_read.trim()&&t.push(`**Files Read:** ${i.files_read}`)}if(i.files_edited)try{let u=JSON.parse(i.files_edited);Array.isArray(u)&&u.length>0&&t.push(`**Files Edited:** ${u.join(", ")}`)}catch{i.files_edited.trim()&&t.push(`**Files Edited:** ${i.files_edited}`)}let l=new Date(i.created_at).toLocaleString();t.push(`**Date:** ${l}`)}}else if(n.status==="active"){t.push("**In Progress**"),t.push(""),n.user_prompt&&t.push(`**Request:** ${n.user_prompt}`);let i=Qe.getObservationsForSession(n.sdk_session_id);if(i.length>0){t.push(""),t.push(`**Observations (${i.length}):**`);for(let l of i)t.push(`- ${l.title}`)}else t.push(""),t.push("*No observations yet*");t.push(""),t.push("**Status:** Active - summary pending");let o=new Date(n.started_at).toLocaleString();t.push(`**Date:** ${o}`)}else{t.push(`**${n.status.charAt(0).toUpperCase()+n.status.slice(1)}**`),t.push(""),n.user_prompt&&t.push(`**Request:** ${n.user_prompt}`),t.push(""),t.push(`**Status:** ${n.status} - no summary available`);let i=new Date(n.started_at).toLocaleString();t.push(`**Date:** ${i}`)}t.push("")}return{content:[{type:"text",text:t.join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Failed to get recent context: ${e.message}`}],isError:!0}}}},{name:"search_user_prompts",description:'Search raw user prompts with full-text search. Use this to find what the user actually said/requested across all sessions. IMPORTANT: Always use index format first (default) to get an overview with minimal token usage, then use format: "full" only for specific items of interest.',inputSchema:c.object({query:c.string().describe("Search query for FTS5 full-text search"),format:c.enum(["index","full"]).default("index").describe('Output format: "index" for truncated prompts/dates (default, RECOMMENDED for initial search), "full" for complete prompt text (use only after reviewing index results)'),project:c.string().optional().describe("Filter by project name"),dateRange:c.object({start:c.union([c.string(),c.number()]).optional(),end:c.union([c.string(),c.number()]).optional()}).optional().describe("Filter by date range"),limit:c.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:c.number().min(0).default(0).describe("Number of results to skip"),orderBy:c.enum(["relevance","date_desc","date_asc"]).default("relevance").describe("Sort order")}),handler:async s=>{try{let{query:e,format:r="index",...a}=s,t=sn.searchUserPrompts(e,a);if(t.length===0)return{content:[{type:"text",text:`No user prompts found matching "${e}"`}]};let n;if(r==="index"){let i=`Found ${t.length} user prompt(s) matching "${e}":

`,o=t.map((l,u)=>vh(l,u));n=i+o.join(`

`)+yr()}else n=t.map((o,l)=>gh(o,l)).join(`

---

`);return{content:[{type:"text",text:n}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}}],an=new Es({name:"claude-mem-search",version:"1.0.0"},{capabilities:{tools:{}}});an.setRequestHandler(oa,async()=>({tools:bl.map(s=>({name:s.name,description:s.description,inputSchema:za(s.inputSchema)}))}));an.setRequestHandler(la,async s=>{let e=bl.find(r=>r.name===s.params.name);if(!e)throw new Error(`Unknown tool: ${s.params.name}`);try{return await e.handler(s.params.arguments||{})}catch(r){return{content:[{type:"text",text:`Tool execution failed: ${r.message}`}],isError:!0}}});async function yh(){try{sn=new Is,Qe=new Ns,console.error("[search-server] SQLite services initialized"),lt=new ks,await lt.connect(),console.error("[search-server] Chroma MCP client connected");let s=new Ss;await an.connect(s),console.error("[search-server] Claude-mem search server started")}catch(s){console.error("[search-server] Failed to initialize:",s.message),process.exit(1)}}yh().catch(s=>{console.error("[search-server] Fatal error:",s),process.exit(1)});
/*! Bundled license information:

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)
*/
